{"version":3,"file":"gettext.js","names":["GettextBuilder","translations","debug","language","locale","setLanguage","replace","data","GettextWrapper","gt","GetText","sourceLocale","key","addTranslations","setLocale","translated","vars","a","b","r","toString","original","placeholders","subtitudePlaceholders","gettext","singular","plural","count","ngettext","getGettextBuilder"],"sources":["../lib/gettext.ts"],"sourcesContent":["import GetText from \"node-gettext\"\n\nimport { getLanguage } from \".\"\n\nclass GettextBuilder {\n\n    private locale?: string\n    private translations = {}\n    private debug = false\n\n    setLanguage(language: string): GettextBuilder {\n        this.locale = language\n        return this\n    }\n\n    detectLocale(): GettextBuilder {\n        return this.setLanguage(getLanguage().replace('-', '_'))\n    }\n\n    addTranslation(language: string, data: any): GettextBuilder {\n        this.translations[language] = data\n        return this\n    }\n\n    enableDebugMode(): GettextBuilder {\n        this.debug = true\n        return this\n    }\n\n    build(): GettextWrapper {\n        return new GettextWrapper(this.locale || 'en', this.translations, this.debug)\n    }\n\n}\n\nclass GettextWrapper {\n\n    private gt: GetText\n\n    constructor(locale: string, data: any, debug: boolean) {\n        this.gt = new GetText({\n            debug,\n            sourceLocale: 'en',\n        })\n\n        for (let key in data) {\n            this.gt.addTranslations(key, 'messages', data[key])\n        }\n\n        this.gt.setLocale(locale)\n    }\n\n    private subtitudePlaceholders(translated: string, vars: object): string {\n        return translated.replace(/{([^{}]*)}/g, (a, b) => {\n            const r = vars[b]\n            if (typeof r === 'string' || typeof r === 'number') {\n                return r.toString()\n            } else {\n                return a\n            }\n        })\n    }\n\n    gettext(original: string, placeholders: object = {}): string {\n        return this.subtitudePlaceholders(\n            this.gt.gettext(original),\n            placeholders\n        )\n    }\n\n    ngettext(singular: string, plural: string, count: number, placeholders: object = {}): string {\n        return this.subtitudePlaceholders(\n            this.gt.ngettext(singular, plural, count).replace(/%n/g, count.toString()),\n            placeholders\n        )\n    }\n\n}\n\nexport function getGettextBuilder() {\n    return new GettextBuilder()\n}\n"],"mappings":";;;;;;;;;;;;;;;;;AAAA;;AAEA;;;;;;;;;;IAEMA,c;;;;SAGMC,Y,GAAe,E;SACfC,K,GAAQ,K;;;;;WAEhB,qBAAYC,QAAZ,EAA8C;MAC1C,KAAKC,MAAL,GAAcD,QAAd;MACA,OAAO,IAAP;IACH;;;WAED,wBAA+B;MAC3B,OAAO,KAAKE,WAAL,CAAiB,qBAAcC,OAAd,CAAsB,GAAtB,EAA2B,GAA3B,CAAjB,CAAP;IACH;;;WAED,wBAAeH,QAAf,EAAiCI,IAAjC,EAA4D;MACxD,KAAKN,YAAL,CAAkBE,QAAlB,IAA8BI,IAA9B;MACA,OAAO,IAAP;IACH;;;WAED,2BAAkC;MAC9B,KAAKL,KAAL,GAAa,IAAb;MACA,OAAO,IAAP;IACH;;;WAED,iBAAwB;MACpB,OAAO,IAAIM,cAAJ,CAAmB,KAAKJ,MAAL,IAAe,IAAlC,EAAwC,KAAKH,YAA7C,EAA2D,KAAKC,KAAhE,CAAP;IACH;;;;;;IAICM,c;EAIF,wBAAYJ,MAAZ,EAA4BG,IAA5B,EAAuCL,KAAvC,EAAuD;IAAA;;IACnD,KAAKO,EAAL,GAAU,IAAIC,oBAAJ,CAAY;MAClBR,KAAK,EAALA,KADkB;MAElBS,YAAY,EAAE;IAFI,CAAZ,CAAV;;IAKA,KAAK,IAAIC,GAAT,IAAgBL,IAAhB,EAAsB;MAClB,KAAKE,EAAL,CAAQI,eAAR,CAAwBD,GAAxB,EAA6B,UAA7B,EAAyCL,IAAI,CAACK,GAAD,CAA7C;IACH;;IAED,KAAKH,EAAL,CAAQK,SAAR,CAAkBV,MAAlB;EACH;;;;WAED,+BAA8BW,UAA9B,EAAkDC,IAAlD,EAAwE;MACpE,OAAOD,UAAU,CAACT,OAAX,CAAmB,aAAnB,EAAkC,UAACW,CAAD,EAAIC,CAAJ,EAAU;QAC/C,IAAMC,CAAC,GAAGH,IAAI,CAACE,CAAD,CAAd;;QACA,IAAI,OAAOC,CAAP,KAAa,QAAb,IAAyB,OAAOA,CAAP,KAAa,QAA1C,EAAoD;UAChD,OAAOA,CAAC,CAACC,QAAF,EAAP;QACH,CAFD,MAEO;UACH,OAAOH,CAAP;QACH;MACJ,CAPM,CAAP;IAQH;;;WAED,iBAAQI,QAAR,EAA6D;MAAA,IAAnCC,YAAmC,uEAAZ,EAAY;MACzD,OAAO,KAAKC,qBAAL,CACH,KAAKd,EAAL,CAAQe,OAAR,CAAgBH,QAAhB,CADG,EAEHC,YAFG,CAAP;IAIH;;;WAED,kBAASG,QAAT,EAA2BC,MAA3B,EAA2CC,KAA3C,EAA6F;MAAA,IAAnCL,YAAmC,uEAAZ,EAAY;MACzF,OAAO,KAAKC,qBAAL,CACH,KAAKd,EAAL,CAAQmB,QAAR,CAAiBH,QAAjB,EAA2BC,MAA3B,EAAmCC,KAAnC,EAA0CrB,OAA1C,CAAkD,KAAlD,EAAyDqB,KAAK,CAACP,QAAN,EAAzD,CADG,EAEHE,YAFG,CAAP;IAIH;;;;;;AAIE,SAASO,iBAAT,GAA6B;EAChC,OAAO,IAAI7B,cAAJ,EAAP;AACH"}