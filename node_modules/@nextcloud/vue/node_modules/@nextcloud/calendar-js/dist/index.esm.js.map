{"version":3,"file":"index.esm.js","sources":["../src/parsers/abstractParser.js","../src/errors/modificationNotAllowedError.js","../src/traits/lockable.js","../src/errors/expectedICalJSError.js","../src/helpers/stringHelper.js","../src/config.js","../src/factories/icalFactory.js","../src/traits/observer.js","../src/parameters/parameter.js","../src/values/abstractValue.js","../src/values/binaryValue.js","../src/values/durationValue.js","../src/values/dateTimeValue.js","../src/values/periodValue.js","../src/values/recurValue.js","../src/values/utcOffsetValue.js","../src/errors/unknownICALTypeError.js","../src/values/index.js","../src/properties/property.js","../src/properties/attachmentProperty.js","../src/properties/attendeeProperty.js","../src/properties/conferenceProperty.js","../src/properties/freeBusyProperty.js","../src/properties/geoProperty.js","../src/properties/imageProperty.js","../src/properties/relationProperty.js","../src/properties/requestStatusProperty.js","../src/properties/textProperty.js","../src/properties/triggerProperty.js","../src/properties/index.js","../src/components/abstractComponent.js","../src/factories/dateFactory.js","../src/errors/recurringWithoutDtStartError.js","../src/recurrence/recurrenceManager.js","../src/components/root/timezoneComponent.js","../src/timezones/timezone.js","../src/components/nested/alarmComponent.js","../src/components/nested/index.js","../src/components/root/abstractRecurringComponent.js","../src/helpers/birthdayHelper.js","../src/components/root/eventComponent.js","../src/components/root/freeBusyComponent.js","../src/components/root/journalComponent.js","../src/components/root/toDoComponent.js","../src/components/root/index.js","../src/components/calendarComponent.js","../src/parsers/repairsteps/abstractRepairStep.js","../src/parsers/repairsteps/icalendar/icalendarAddMissingUIDRepairStep.js","../src/parsers/repairsteps/icalendar/icalendarAddMissingValueDateDoubleColonRepairStep.js","../src/parsers/repairsteps/icalendar/icalendarAddMissingValueDateRepairStep.js","../src/parsers/repairsteps/icalendar/icalendarEmptyTriggerRepairStep.js","../src/parsers/repairsteps/icalendar/icalendarIllegalCreatedRepairStep.js","../src/parsers/repairsteps/icalendar/icalendarMultipleVCalendarBlocksRepairStep.js","../src/parsers/repairsteps/icalendar/icalendarRemoveXNCGroupIdRepairStep.js","../src/parsers/repairsteps/icalendar/index.js","../src/timezones/timezoneManager.js","../src/parsers/icalendarParser.js","../src/parsers/parserManager.js","../src/timezones/timezoneAdapter.js","../src/errors/illegalValueError.js","../src/timezones/utils.js","../src/index.js"],"sourcesContent":["/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\n/**\n * @class AbstractParser\n * @classdesc\n */\nexport default class AbstractParser {\n\n\t/**\n\t * @constructor\n\t *\n\t * @param {Object=} options Object of options\n\t * @param {Boolean=} options.extractGlobalProperties Whether or not to preserve properties from the VCALENDAR component (defaults to false)\n\t * @param {Boolean=} options.removeRSVPForAttendees Whether or not to remove RSVP from attendees (defaults to false)\n\t * @param {Boolean=} options.includeTimezones Whether or not to include timezones (defaults to false)\n\t * @param {Boolean=} options.preserveMethod Whether or not to preserve the iCalendar method (defaults to false)\n\t * @param {Boolean=} options.processFreeBusy Whether or not to process VFreeBusy components (defaults to false)\n\t */\n\tconstructor(options = {}) {\n\t\tif (new.target === AbstractParser) {\n\t\t\tthrow new TypeError('Cannot instantiate abstract class AbstractParser')\n\t\t}\n\n\t\t/**\n\t\t * Options for the parser\n\t\t *\n\t\t * @type {{removeRSVPForAttendees: Boolean}}\n\t\t * @private\n\t\t */\n\t\tthis._options = Object.assign({}, options)\n\n\t\t/**\n\t\t * A name extracted from the calendar-data\n\t\t *\n\t\t * @type {String|null}\n\t\t * @protected\n\t\t */\n\t\tthis._name = null\n\n\t\t/**\n\t\t * A color extracted from the calendar-data\n\t\t *\n\t\t * @type {String|null}\n\t\t * @protected\n\t\t */\n\t\tthis._color = null\n\n\t\t/**\n\t\t * Gets the url that this icalendar file can be updated from\n\t\t *\n\t\t * @type {String}\n\t\t * @protected\n\t\t */\n\t\tthis._sourceURL = null\n\n\t\t/**\n\t\t * Gets the update interval if this icalendar file can be updated from a source\n\t\t *\n\t\t * @type {String}\n\t\t * @protected\n\t\t */\n\t\tthis._refreshInterval = null\n\n\t\t/**\n\t\t * Gets the default timezone of this calendar\n\t\t *\n\t\t * @type {String}\n\t\t * @protected\n\t\t */\n\t\tthis._calendarTimezone = null\n\n\t\t/**\n\t\t * Error count during parsing\n\t\t *\n\t\t * @type {Array}\n\t\t * @protected\n\t\t */\n\t\tthis._errors = []\n\t}\n\n\t/**\n\t * Gets the name extracted from the calendar-data\n\t *\n\t * @returns {String|null}\n\t */\n\tgetName() {\n\t\treturn this._name\n\t}\n\n\t/**\n\t * Gets the color extracted from the calendar-data\n\t *\n\t * @returns {String|null}\n\t */\n\tgetColor() {\n\t\treturn this._color\n\t}\n\n\t/**\n\t * Gets whether this import can be converted into a webcal subscription\n\t *\n\t * @returns {boolean}\n\t */\n\toffersWebcalFeed() {\n\t\treturn this._sourceURL !== null\n\t}\n\n\t/**\n\t * Gets the url pointing to the webcal source\n\t *\n\t * @returns {String|null}\n\t */\n\tgetSourceURL() {\n\t\treturn this._sourceURL\n\t}\n\n\t/**\n\t * Gets the recommended refresh rate to update this subscription\n\t *\n\t * @returns {String|null}\n\t */\n\tgetRefreshInterval() {\n\t\treturn this._refreshInterval\n\t}\n\n\t/**\n\t * Gets the default timezone of this calendar\n\t *\n\t * @returns {String}\n\t */\n\tgetCalendarTimezone() {\n\t\treturn this._calendarTimezone\n\t}\n\n\t/**\n\t * {String|Object} data\n\t *\n\t * @param {any} data The data to parse\n\t * @throws TypeError\n\t */\n\tparse(data) {\n\t\tthrow new TypeError('Abstract method not implemented by subclass')\n\t}\n\n\t/**\n\t * Returns one CalendarComponent at a time\n\t */\n\t* getItemIterator() { // eslint-disable-line require-yield\n\t\tthrow new TypeError('Abstract method not implemented by subclass')\n\t}\n\n\t/**\n\t * Get an array of all items\n\t *\n\t * @returns {CalendarComponent[]}\n\t */\n\tgetAllItems() {\n\t\treturn Array.from(this.getItemIterator())\n\t}\n\n\t/**\n\t * Returns a boolean whether or not the parsed data contains vevents\n\t *\n\t * @returns {boolean}\n\t */\n\tcontainsVEvents() {\n\t\treturn false\n\t}\n\n\t/**\n\t * Returns a boolean whether or not the parsed data contains vjournals\n\t *\n\t * @returns {boolean}\n\t */\n\tcontainsVJournals() {\n\t\treturn false\n\t}\n\n\t/**\n\t * Returns a boolean whether or not the parsed data contains vtodos\n\t *\n\t * @returns {boolean}\n\t */\n\tcontainsVTodos() {\n\t\treturn false\n\t}\n\n\t/**\n\t * Returns a boolean whether or not the parsed data contains vfreebusys\n\t *\n\t * @returns {boolean}\n\t */\n\tcontainsVFreeBusy() {\n\t\treturn false\n\t}\n\n\t/**\n\t * Returns a boolean whether\n\t *\n\t * @returns {boolean}\n\t */\n\thasErrors() {\n\t\treturn this._errors.length !== 0\n\t}\n\n\t/**\n\t * Get a list of all errors that occurred\n\t *\n\t * @returns {*[]}\n\t */\n\tgetErrorList() {\n\t\treturn this._errors.slice()\n\t}\n\n\t/**\n\t * Returns the number of calendar-objects in parser\n\t *\n\t * @returns {number}\n\t */\n\tgetItemCount() {\n\t\treturn 0\n\t}\n\n\t/**\n\t * Gets an option provided\n\t *\n\t * @param {String} name The name of the option to get\n\t * @param {*} defaultValue The default value to return if option not provided\n\t * @returns {any}\n\t * @protected\n\t */\n\t_getOption(name, defaultValue) {\n\t\treturn Object.prototype.hasOwnProperty.call(this._options, name)\n\t\t\t? this._options[name]\n\t\t\t: defaultValue\n\t}\n\n\t/**\n\t * Return list of supported mime types\n\t *\n\t * @static\n\t */\n\tstatic getMimeTypes() {\n\t\tthrow new TypeError('Abstract method not implemented by subclass')\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nexport default class ModificationNotAllowedError extends Error {}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport ModificationNotAllowedError from '../errors/modificationNotAllowedError.js'\n\nexport default function lockableTrait(baseClass) {\n\n\t/**\n\t * @class LockableTrait\n\t */\n\treturn class extends baseClass {\n\n\t\t/**\n\t\t * Constructor\n\t\t */\n\t\tconstructor(...args) {\n\t\t\tsuper(...args)\n\n\t\t\t/**\n\t\t\t * Indicator whether this value was locked for changes\n\t\t\t *\n\t\t\t * @type {boolean}\n\t\t\t * @private\n\t\t\t */\n\t\t\tthis._mutable = true\n\t\t}\n\n\t\t/**\n\t\t * Returns whether or not this object is locked\n\t\t *\n\t\t * @returns {boolean}\n\t\t */\n\t\tisLocked() {\n\t\t\treturn !this._mutable\n\t\t}\n\n\t\t/**\n\t\t * Marks this object is immutable\n\t\t * locks it against further modification\n\t\t */\n\t\tlock() {\n\t\t\tthis._mutable = false\n\t\t}\n\n\t\t/**\n\t\t * Marks this object as mutable\n\t\t * allowing further modification\n\t\t */\n\t\tunlock() {\n\t\t\tthis._mutable = true\n\t\t}\n\n\t\t/**\n\t\t * Check if modifications are allowed\n\t\t *\n\t\t * @throws {ModificationNotAllowedError} if this object is locked for modification\n\t\t * @protected\n\t\t */\n\t\t_modify() {\n\t\t\tif (!this._mutable) {\n\t\t\t\tthrow new ModificationNotAllowedError()\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Check if modification of content is allowed\n\t\t *\n\t\t * @throws {ModificationNotAllowedError} if this object is locked for modification\n\t\t * @protected\n\t\t */\n\t\t_modifyContent() {\n\t\t\tthis._modify()\n\t\t}\n\n\t}\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nexport default class ExpectedICalJSError extends Error {}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\n/**\n * Turns the entire string lowercase\n *\n * @param {String} str The string to turn lowercase\n * @returns {string}\n */\nexport function lc(str) {\n\treturn str.toLowerCase()\n}\n\n/**\n * Compares two strings, It is case-insensitive.\n *\n * @param {String} str1 String 1 to compare\n * @param {String} str2 String 2 to compare\n * @returns {Boolean}\n */\nexport function strcasecmp(str1, str2) {\n\treturn uc(str1) === uc(str2)\n}\n\n/**\n * Turns the entire string uppercase\n *\n * @param {String} str The string to turn uppercase\n * @returns {string}\n */\nexport function uc(str) {\n\treturn str.toUpperCase()\n}\n\n/**\n * Capitalizes the string\n *\n * @param {String} str The string of which the first character will be turned uppercase\n * @returns {string}\n */\nexport function ucFirst(str) {\n\treturn str.charAt(0).toUpperCase() + str.slice(1)\n}\n\n/**\n * Makes sure that a string starts with a certain other string\n * This is mostly used in the attendeeProperty to assure the uri starts with mailto:\n *\n * @param {String} str The string to check for the prefix and prepend if necessary\n * @param {String} startWith The prefix to be added if necessary\n * @returns {string}\n */\nexport function startStringWith(str, startWith) {\n\tif (!str.startsWith(startWith)) {\n\t\tstr = startWith + str\n\t}\n\n\treturn str\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\n/**\n * @type {Map<String, *>}\n */\nconst GLOBAL_CONFIG = new Map()\n\n/**\n * Sets a new config key\n *\n * @param {String} key The config-key to set\n * @param {*} value The value to set for given config-key\n */\nexport function setConfig(key, value) {\n\tGLOBAL_CONFIG.set(key, value)\n}\n\n/**\n * Checks if a config for a certain key is present\n *\n * @param {String} key The config-key to check\n * @returns {boolean}\n */\nexport function hasConfig(key) {\n\treturn GLOBAL_CONFIG.has(key)\n}\n\n/**\n * gets value of a config key\n *\n * @param {String} key The config-key to get\n * @param {*} defaultValue Default value of config does not exist\n * @returns {*}\n */\nexport function getConfig(key, defaultValue) {\n\treturn GLOBAL_CONFIG.get(key) || defaultValue\n}\n\n/**\n * deletes a config key\n *\n * @param {String} key The config-key to delete\n */\nexport function deleteConfig(key) {\n\tGLOBAL_CONFIG.delete(key)\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport { lc } from '../helpers/stringHelper.js'\nimport { getConfig } from '../config.js'\nimport ICAL from 'ical.js'\n\n/**\n * creates a new ICAL.Component object\n *\n * @param {string} componentName The name of the component to create\n * @returns {ICAL.Component}\n */\nexport function createComponent(componentName) {\n\treturn new ICAL.Component(lc(componentName))\n}\n\n/**\n * creates a new ICAL.Property object\n *\n * @param {string} propertyName The name of the property to create\n * @returns {ICAL.Property}\n */\nexport function createProperty(propertyName) {\n\treturn new ICAL.Property(lc(propertyName))\n}\n\n/**\n * creates a new calendar component\n *\n * @param {String=} method Name of the method to include in VCALENDAR component\n * @returns {ICAL.Component}\n */\nexport function createCalendarComponent(method = null) {\n\tconst calendarComp = createComponent('VCALENDAR')\n\n\tcalendarComp.addPropertyWithValue('prodid', getConfig('PRODID', '-//IDN georgehrke.com//calendar-js//EN'))\n\tcalendarComp.addPropertyWithValue('calscale', 'GREGORIAN')\n\tcalendarComp.addPropertyWithValue('version', '2.0')\n\n\tif (method) {\n\t\tcalendarComp.addPropertyWithValue('method', method)\n\t}\n\n\treturn calendarComp\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nexport default function observerTrait(baseClass) {\n\n\t/**\n\t * @class ObserverTrait\n\t */\n\treturn class extends baseClass {\n\n\t\t/**\n\t\t * Constructor\n\t\t */\n\t\tconstructor(...args) {\n\t\t\tsuper(...args)\n\n\t\t\t/**\n\t\t\t * List of subscribers\n\t\t\t *\n\t\t\t * @type {Function[]}\n\t\t\t * @private\n\t\t\t */\n\t\t\tthis._subscribers = []\n\t\t}\n\n\t\t/**\n\t\t * Adds a new subscriber\n\t\t *\n\t\t * @param {Function} handler - Handler to be called when modification happens\n\t\t */\n\t\tsubscribe(handler) {\n\t\t\tthis._subscribers.push(handler)\n\t\t}\n\n\t\t/**\n\t\t * Removes a subscriber\n\t\t *\n\t\t * @param {Function} handler - Handler to be no longer called when modification happens\n\t\t */\n\t\tunsubscribe(handler) {\n\t\t\tconst index = this._subscribers.indexOf(handler)\n\t\t\tif (index === -1) {\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tthis._subscribers.splice(index, 1)\n\t\t}\n\n\t\t/**\n\t\t * Notify all subscribed handlers\n\t\t *\n\t\t * @protected\n\t\t */\n\t\t_notifySubscribers(...args) {\n\t\t\tfor (const handler of this._subscribers) {\n\t\t\t\thandler(...args)\n\t\t\t}\n\t\t}\n\n\t}\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport { uc } from '../helpers/stringHelper.js'\nimport lockableTrait from '../traits/lockable.js'\nimport observerTrait from '../traits/observer.js'\n\n/**\n * @class Parameter\n * @classdesc This class represents a property parameters as defined in RFC 5545 Section 3.2\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.2\n * @url\n */\nexport default class Parameter extends observerTrait(lockableTrait(class {})) {\n\n\t/**\n\t * Constructor\n\t *\n\t * @param {string} name The name of the parameter\n\t * @param {string|Array|null} value The value of the parameter\n\t */\n\tconstructor(name, value = null) {\n\t\tsuper()\n\n\t\t/**\n\t\t * Name of the parameter\n\t\t *\n\t\t * @type {string}\n\t\t * @private\n\t\t */\n\t\tthis._name = uc(name)\n\n\t\t/**\n\t\t * Value of the parameter\n\t\t *\n\t\t * @type {string|Array|null}\n\t\t * @private\n\t\t */\n\t\tthis._value = value\n\t}\n\n\t/**\n\t * Get parameter name\n\t *\n\t * @readonly\n\t * @returns {String}\n\t */\n\tget name() {\n\t\treturn this._name\n\t}\n\n\t/**\n\t * Get parameter value\n\t *\n\t * @returns {String|Array}\n\t */\n\tget value() {\n\t\treturn this._value\n\t}\n\n\t/**\n\t * Set new parameter value\n\t *\n\t * @throws {ModificationNotAllowedError} if parameter is locked for modification\n\t * @param {String|Array} value The new value to set\n\t */\n\tset value(value) {\n\t\tthis._modifyContent()\n\t\tthis._value = value\n\t}\n\n\t/**\n\t * Gets the first value of this parameter\n\t *\n\t * @returns {String|null}\n\t */\n\tgetFirstValue() {\n\t\tif (!this.isMultiValue()) {\n\t\t\treturn this.value\n\t\t} else {\n\t\t\tif (this.value.length > 0) {\n\t\t\t\treturn this.value[0]\n\t\t\t}\n\t\t}\n\n\t\treturn null\n\t}\n\n\t/**\n\t * Gets an iterator for all values\n\t */\n\t* getValueIterator() {\n\t\tif (this.isMultiValue()) {\n\t\t\tyield * this.value.slice()[Symbol.iterator]()\n\t\t} else {\n\t\t\tyield this.value\n\t\t}\n\t}\n\n\t/**\n\t * Returns whether or not the value is a multivalue\n\t *\n\t * @returns {Boolean}\n\t */\n\tisMultiValue() {\n\t\treturn Array.isArray(this._value)\n\t}\n\n\t/**\n\t * Creates a copy of this parameter\n\t *\n\t * @returns {Parameter}\n\t */\n\tclone() {\n\t\tconst parameter = new this.constructor(this._name)\n\t\tif (this.isMultiValue()) {\n\t\t\t// only copy array values, don't copy array reference\n\t\t\tparameter.value = this._value.slice()\n\t\t} else {\n\t\t\tparameter.value = this._value\n\t\t}\n\n\t\t// cloned parameters are always mutable\n\t\treturn parameter\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\t_modifyContent() {\n\t\tsuper._modifyContent()\n\t\tthis._notifySubscribers()\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport lockableTrait from '../traits/lockable.js'\nimport observerTrait from '../traits/observer.js'\n\n/**\n * @class AbstractValue\n * @classdesc BaseClass for all values\n */\nexport default class AbstractValue extends observerTrait(lockableTrait(class {})) {\n\n\t/**\n\t * Constructor\n\t *\n\t * @param {ICAL.Binary|ICAL.Duration|ICAL.Period|ICAL.Recur|ICAL.Time|ICAL.UtcOffset} icalValue The ICAL.JS object to wrap\n\t */\n\tconstructor(icalValue) {\n\t\tif (new.target === AbstractValue) {\n\t\t\tthrow new TypeError('Cannot instantiate abstract class AbstractValue')\n\t\t}\n\t\tsuper()\n\n\t\t/**\n\t\t * Wrapped ICAL.js value\n\t\t *\n\t\t * @type {ICAL.Binary|ICAL.Duration|ICAL.Period|ICAL.Recur|ICAL.Time|ICAL.UtcOffset}\n\t\t */\n\t\tthis._innerValue = icalValue\n\t}\n\n\t/**\n\t * Gets wrapped ICAL.JS object\n\t *\n\t * @returns {*}\n\t */\n\ttoICALJs() {\n\t\treturn this._innerValue\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\t_modifyContent() {\n\t\tsuper._modifyContent()\n\t\tthis._notifySubscribers()\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport AbstractValue from './abstractValue.js'\nimport ICAL from 'ical.js'\n\n/**\n * @class BinaryValue\n * @classdesc Wrapper for ICAL.Binary\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.1.3\n * @url https://github.com/mozilla-comm/ical.js/blob/master/lib/ical/binary.js\n */\nexport default class BinaryValue extends AbstractValue {\n\n\t/**\n\t * Sets the raw b64 encoded value\n\t *\n\t * @returns {String}\n\t */\n\tget rawValue() {\n\t\treturn this._innerValue.value\n\t}\n\n\t/**\n\t * Gets the raw b64 encoded value\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @param {String} value - The new raw value\n\t */\n\tset rawValue(value) {\n\t\tthis._modifyContent()\n\t\tthis._innerValue.value = value\n\t}\n\n\t/**\n\t * Gets the decoded value\n\t *\n\t * @returns {String}\n\t */\n\tget value() {\n\t\treturn this._innerValue.decodeValue()\n\t}\n\n\t/**\n\t * Sets the decoded Value\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @param  {String} decodedValue - The new encoded value\n\t */\n\tset value(decodedValue) {\n\t\tthis._modifyContent()\n\t\tthis._innerValue.setEncodedValue(decodedValue)\n\t}\n\n\t/**\n\t * clones this value\n\t *\n\t * @returns {BinaryValue}\n\t */\n\tclone() {\n\t\treturn BinaryValue.fromRawValue(this._innerValue.value)\n\t}\n\n\t/**\n\t * Create a new BinaryValue object from an ICAL.Binary object\n\t *\n\t * @param {ICAL.Binary} icalValue - The ICAL.Binary object\n\t * @returns {BinaryValue}\n\t */\n\tstatic fromICALJs(icalValue) {\n\t\treturn new BinaryValue(icalValue)\n\t}\n\n\t/**\n\t * Create a new BinaryValue object from a raw b64 encoded value\n\t *\n\t * @param {String} rawValue - The raw value\n\t * @returns {BinaryValue}\n\t */\n\tstatic fromRawValue(rawValue) {\n\t\tconst icalBinary = new ICAL.Binary(rawValue)\n\t\treturn BinaryValue.fromICALJs(icalBinary)\n\t}\n\n\t/**\n\t * Create a new BinaryValue object from decoded value\n\t *\n\t * @param {String} decodedValue - The encoded value\n\t * @returns {BinaryValue}\n\t */\n\tstatic fromDecodedValue(decodedValue) {\n\t\tconst icalBinary = new ICAL.Binary()\n\t\ticalBinary.setEncodedValue(decodedValue)\n\t\treturn BinaryValue.fromICALJs(icalBinary)\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport AbstractValue from './abstractValue.js'\nimport ICAL from 'ical.js'\n\n/**\n * @class DurationValue\n * @classdesc Wrapper for ICAL.Duration\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.3.6\n * @url https://github.com/mozilla-comm/ical.js/blob/master/lib/ical/duration.js\n */\nexport default class DurationValue extends AbstractValue {\n\n\t/**\n\t * Gets the weeks of the stored duration-value\n\t *\n\t * @returns {Number}\n\t */\n\tget weeks() {\n\t\treturn this._innerValue.weeks\n\t}\n\n\t/**\n\t * Sets the weeks of the stored duration-value\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @throws {TypeError} if value is negative\n\t * @param {Number} weeks Amount of weeks\n\t */\n\tset weeks(weeks) {\n\t\tthis._modifyContent()\n\t\tif (weeks < 0) {\n\t\t\tthrow new TypeError('Weeks cannot be negative, use isNegative instead')\n\t\t}\n\n\t\tthis._innerValue.weeks = weeks\n\t}\n\n\t/**\n\t * Gets the days of the stored duration-value\n\t *\n\t * @returns {Number}\n\t */\n\tget days() {\n\t\treturn this._innerValue.days\n\t}\n\n\t/**\n\t * Sets the days of the stored duration-value\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @throws {TypeError} if value is negative\n\t * @param {Number} days Amount of days\n\t */\n\tset days(days) {\n\t\tthis._modifyContent()\n\t\tif (days < 0) {\n\t\t\tthrow new TypeError('Days cannot be negative, use isNegative instead')\n\t\t}\n\n\t\tthis._innerValue.days = days\n\t}\n\n\t/**\n\t * Gets the hours of the stored duration-value\n\t *\n\t * @returns {Number}\n\t */\n\tget hours() {\n\t\treturn this._innerValue.hours\n\t}\n\n\t/**\n\t * Sets the weeks of the stored duration-value\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @throws {TypeError} if value is negative\n\t * @param {Number} hours Amount of hours\n\t */\n\tset hours(hours) {\n\t\tthis._modifyContent()\n\t\tif (hours < 0) {\n\t\t\tthrow new TypeError('Hours cannot be negative, use isNegative instead')\n\t\t}\n\n\t\tthis._innerValue.hours = hours\n\t}\n\n\t/**\n\t * Gets the minutes of the stored duration-value\n\t *\n\t * @returns {Number}\n\t */\n\tget minutes() {\n\t\treturn this._innerValue.minutes\n\t}\n\n\t/**\n\t * Sets the minutes of the stored duration-value\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @throws {TypeError} if value is negative\n\t * @param {Number} minutes Amount of minutes\n\t */\n\tset minutes(minutes) {\n\t\tthis._modifyContent()\n\t\tif (minutes < 0) {\n\t\t\tthrow new TypeError('Minutes cannot be negative, use isNegative instead')\n\t\t}\n\n\t\tthis._innerValue.minutes = minutes\n\t}\n\n\t/**\n\t * Gets the seconds of the stored duration-value\n\t *\n\t * @returns {Number}\n\t */\n\tget seconds() {\n\t\treturn this._innerValue.seconds\n\t}\n\n\t/**\n\t * Sets the seconds of the stored duration-value\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @throws {TypeError} if value is negative\n\t * @param {Number} seconds Amount of seconds\n\t */\n\tset seconds(seconds) {\n\t\tthis._modifyContent()\n\t\tif (seconds < 0) {\n\t\t\tthrow new TypeError('Seconds cannot be negative, use isNegative instead')\n\t\t}\n\n\t\tthis._innerValue.seconds = seconds\n\t}\n\n\t/**\n\t * Gets the negative-indicator of the stored duration-value\n\t *\n\t * @returns {Boolean}\n\t */\n\tget isNegative() {\n\t\treturn this._innerValue.isNegative\n\t}\n\n\t/**\n\t * Gets the negative-indicator of the stored duration-value\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @param {Boolean} isNegative Whether or not the duration is negative\n\t */\n\tset isNegative(isNegative) {\n\t\tthis._modifyContent()\n\t\tthis._innerValue.isNegative = !!isNegative\n\t}\n\n\t/**\n\t * Gets the amount of total seconds of the stored duration-value\n\t *\n\t * @returns {*|Number}\n\t */\n\tget totalSeconds() {\n\t\treturn this._innerValue.toSeconds()\n\t}\n\n\t/**\n\t * Sets the amount of total seconds of the stored duration-value\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @param {Number} totalSeconds The total amounts of seconds to set\n\t */\n\tset totalSeconds(totalSeconds) {\n\t\tthis._modifyContent()\n\t\tthis._innerValue.fromSeconds(totalSeconds)\n\t}\n\n\t/**\n\t * Compares this duration to another one\n\t *\n\t * @param {DurationValue} otherDuration The duration to compare to\n\t * @returns {Number} -1, 0 or 1 for less/equal/greater\n\t */\n\tcompare(otherDuration) {\n\t\treturn this._innerValue.compare(otherDuration.toICALJs())\n\t}\n\n\t/**\n\t * Adds the value of another duration to this one\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @param {DurationValue} otherDuration The duration to add\n\t */\n\taddDuration(otherDuration) {\n\t\tthis._modifyContent()\n\t\tthis.totalSeconds += otherDuration.totalSeconds\n\t\tthis._innerValue.normalize()\n\t}\n\n\t/**\n\t * Subtract the value of another duration from this one\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @param {DurationValue} otherDuration The duration to subtract\n\t */\n\tsubtractDuration(otherDuration) {\n\t\tthis._modifyContent()\n\t\tthis.totalSeconds -= otherDuration.totalSeconds\n\t\tthis._innerValue.normalize()\n\t}\n\n\t/**\n\t * clones this value\n\t *\n\t * @returns {DurationValue}\n\t */\n\tclone() {\n\t\treturn DurationValue.fromICALJs(this._innerValue.clone())\n\t}\n\n\t/**\n\t * Create a new DurationValue object from an ICAL.Duration object\n\t *\n\t * @param {ICAL.Duration} icalValue The ical.js duration value\n\t * @returns {DurationValue}\n\t */\n\tstatic fromICALJs(icalValue) {\n\t\treturn new DurationValue(icalValue)\n\t}\n\n\t/**\n\t * Create a new DurationValue object from a number of seconds\n\t *\n\t * @param {Number} seconds Total amount of seconds\n\t * @returns {DurationValue}\n\t */\n\tstatic fromSeconds(seconds) {\n\t\tconst icalDuration = ICAL.Duration.fromSeconds(seconds)\n\t\treturn new DurationValue(icalDuration)\n\n\t}\n\n\t/**\n\t * Create a new DurationValue object from data\n\t *\n\t * @param {Object} data The destructuring object\n\t * @param {Number=} data.weeks Number of weeks to set\n\t * @param {Number=} data.days Number of days to set\n\t * @param {Number=} data.hours Number of hours to set\n\t * @param {Number=} data.minutes Number of minutes to set\n\t * @param {Number=} data.seconds Number of seconds to set\n\t * @param {Boolean=} data.isNegative Whether or not duration is negative\n\t * @returns {DurationValue}\n\t */\n\tstatic fromData(data) {\n\t\tconst icalDuration = ICAL.Duration.fromData(data)\n\t\treturn new DurationValue(icalDuration)\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport AbstractValue from './abstractValue.js'\nimport DurationValue from './durationValue.js'\nimport ICAL from 'ical.js'\n\n/**\n * @class DateTimeValue\n * @classdesc Wrapper for ICAL.Time\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.3.4\n * @url https://tools.ietf.org/html/rfc5545#section-3.3.5\n * @url https://tools.ietf.org/html/rfc5545#section-3.3.12\n * @url https://github.com/mozilla-comm/ical.js/blob/master/lib/ical/time.js\n */\nexport default class DateTimeValue extends AbstractValue {\n\n\t/**\n\t * Gets the year of the stored date-time-value\n\t *\n\t * @returns {Number}\n\t */\n\tget year() {\n\t\treturn this._innerValue.year\n\t}\n\n\t/**\n\t * Sets the year of the stored date-time-value\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @param {Number} year Number of years to set\n\t */\n\tset year(year) {\n\t\tthis._modifyContent()\n\t\tthis._innerValue.year = year\n\t}\n\n\t/**\n\t * Gets the month of the stored date-time-value\n\t *\n\t * @returns {Number}\n\t */\n\tget month() {\n\t\treturn this._innerValue.month\n\t}\n\n\t/**\n\t * Sets the month of the stored date-time-value\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @param {Number} month Number of months to set\n\t */\n\tset month(month) {\n\t\tthis._modifyContent()\n\t\tif (month < 1 || month > 12) {\n\t\t\tthrow new TypeError('Month out of range')\n\t\t}\n\n\t\tthis._innerValue.month = month\n\t}\n\n\t/**\n\t * Gets the day of the stored date-time-value\n\t *\n\t * @returns {Number}\n\t */\n\tget day() {\n\t\treturn this._innerValue.day\n\t}\n\n\t/**\n\t * Sets the day of the stored date-time-value\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @throws {TypeError} if out of range\n\t * @param {Number} day Number of days to set\n\t */\n\tset day(day) {\n\t\tthis._modifyContent()\n\t\tif (day < 1 || day > 31) {\n\t\t\tthrow new TypeError('Day out of range')\n\t\t}\n\n\t\tthis._innerValue.day = day\n\t}\n\n\t/**\n\t * Gets the hour of the stored date-time-value\n\t *\n\t * @returns {Number}\n\t */\n\tget hour() {\n\t\treturn this._innerValue.hour\n\t}\n\n\t/**\n\t * Sets the hour of the stored date-time-value\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @throws {TypeError} if out of range\n\t * @param {Number} hour Number of hours to set\n\t */\n\tset hour(hour) {\n\t\tthis._modifyContent()\n\t\tif (hour < 0 || hour > 23) {\n\t\t\tthrow new TypeError('Hour out of range')\n\t\t}\n\n\t\tthis._innerValue.hour = hour\n\t}\n\n\t/**\n\t * Gets the minute of the stored date-time-value\n\t *\n\t * @returns {Number}\n\t */\n\tget minute() {\n\t\treturn this._innerValue.minute\n\t}\n\n\t/**\n\t * Sets the minute of the stored date-time-value\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @throws {TypeError} if out of range\n\t * @param {Number} minute Number of minutes to set\n\t */\n\tset minute(minute) {\n\t\tthis._modifyContent()\n\t\tif (minute < 0 || minute > 59) {\n\t\t\tthrow new TypeError('Minute out of range')\n\t\t}\n\n\t\tthis._innerValue.minute = minute\n\t}\n\n\t/**\n\t * Gets the second of the stored date-time-value\n\t *\n\t * @returns {Number}\n\t */\n\tget second() {\n\t\treturn this._innerValue.second\n\t}\n\n\t/**\n\t * Sets the second of the stored date-time-value\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @throws {TypeError} if out of range\n\t * @param {Number} second Number of seconds to set\n\t */\n\tset second(second) {\n\t\tthis._modifyContent()\n\t\tif (second < 0 || second > 59) {\n\t\t\tthrow new TypeError('Second out of range')\n\t\t}\n\n\t\tthis._innerValue.second = second\n\t}\n\n\t/**\n\t * Gets the timezone of this date-time-value\n\t *\n\t * @returns {String|null}\n\t */\n\tget timezoneId() {\n\t\t// If zone.tzid is set and it's not 'floating' nor 'UTC', then it's a proper\n\t\t// timezone that we also have a timezone id for\n\t\tif (this._innerValue.zone.tzid && this._innerValue.zone.tzid !== 'floating' && this._innerValue.zone.tzid === 'UTC') {\n\t\t\treturn this._innerValue.zone.tzid\n\t\t}\n\n\t\t// If there is a timezone set, but we didn't have a zone.tzid in the previous if,\n\t\t// this means that the tzid does not have a definition stored along it.\n\t\t// we will keep this information anyway to not lose it\n\t\tif (this._innerValue.timezone) {\n\t\t\treturn this._innerValue.timezone\n\t\t}\n\n\t\t// this is the case when it's floating / UTC\n\t\treturn this._innerValue.zone.tzid || null\n\t}\n\n\t/**\n\t * Gets whether this date-time-value is a date or date-time\n\t *\n\t * @returns {boolean}\n\t */\n\tget isDate() {\n\t\treturn this._innerValue.isDate\n\t}\n\n\t/**\n\t * Sets whether this date-time-value is a date or date-time\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @param {boolean} isDate Whether this is a date or date-time value\n\t */\n\tset isDate(isDate) {\n\t\tthis._modifyContent()\n\t\tthis._innerValue.isDate = !!isDate\n\n\t\tif (isDate) {\n\t\t\tthis._innerValue.hour = 0\n\t\t\tthis._innerValue.minute = 0\n\t\t\tthis._innerValue.second = 0\n\t\t}\n\t}\n\n\t/**\n\t * Gets the unix-time\n\t *\n\t * @returns {Number}\n\t */\n\tget unixTime() {\n\t\treturn this._innerValue.toUnixTime()\n\t}\n\n\t/**\n\t * returns vanilla javascript date object\n\t *\n\t * @returns {Date}\n\t */\n\tget jsDate() {\n\t\treturn this._innerValue.toJSDate()\n\t}\n\n\t/**\n\t * Adds a duration to this date-time-value\n\t *\n\t * @param {DurationValue} duration The duration to ad\n\t */\n\taddDuration(duration) {\n\t\tthis._innerValue.addDuration(duration.toICALJs())\n\t}\n\n\t/**\n\t * Subtract another date excluding timezones\n\t *\n\t * @param {DateTimeValue} other The date-time value to subtract\n\t * @returns {DurationValue}\n\t */\n\tsubtractDateWithoutTimezone(other) {\n\t\tconst icalDuration = this._innerValue.subtractDate(other.toICALJs())\n\t\treturn DurationValue.fromICALJs(icalDuration)\n\t}\n\n\t/**\n\t * Subtract another date, taking timezones into account\n\t *\n\t * @param {DateTimeValue} other The date-time value to subtract\n\t * @returns {DurationValue}\n\t */\n\tsubtractDateWithTimezone(other) {\n\t\tconst icalDuration = this._innerValue.subtractDateTz(other.toICALJs())\n\t\treturn DurationValue.fromICALJs(icalDuration)\n\t}\n\n\t/**\n\t * Compares this DateTimeValue object with another one\n\t *\n\t * @param {DateTimeValue} other The date-time to compare to\n\t * @returns {Number} -1, 0 or 1 for less/equal/greater\n\t */\n\tcompare(other) {\n\t\treturn this._innerValue.compare(other.toICALJs())\n\t}\n\n\t/**\n\t * Compares only the date part in a given timezone\n\t *\n\t * @param {DateTimeValue} other The date-time to compare to\n\t * @param {Timezone} timezone The timezone to compare in\n\t * @returns {Number} -1, 0 or 1 for less/equal/greater\n\t */\n\tcompareDateOnlyInGivenTimezone(other, timezone) {\n\t\treturn this._innerValue.compareDateOnlyTz(other.toICALJs(), timezone.toICALTimezone())\n\t}\n\n\t/**\n\t * Returns a clone of this object which was converted to a different timezone\n\t *\n\t * @param {Timezone} timezone TimezoneId to convert to\n\t * @returns {DateTimeValue}\n\t */\n\tgetInTimezone(timezone) {\n\t\tconst clonedICALTime = this._innerValue.convertToZone(timezone.toICALTimezone())\n\t\treturn DateTimeValue.fromICALJs(clonedICALTime)\n\t}\n\n\t/**\n\t * Get the inner ICAL.Timezone\n\t *\n\t * @returns {ICAL.Timezone}\n\t * @package\n\t */\n\tgetICALTimezone() {\n\t\treturn this._innerValue.zone\n\t}\n\n\t/**\n\t * Returns a clone of this object which was converted to a different timezone\n\t *\n\t * @param {ICAL.Timezone} timezone TimezoneId to convert to\n\t * @returns {DateTimeValue}\n\t * @package\n\t */\n\tgetInICALTimezone(timezone) {\n\t\tconst clonedICALTime = this._innerValue.convertToZone(timezone)\n\t\treturn DateTimeValue.fromICALJs(clonedICALTime)\n\t}\n\n\t/**\n\t * Returns a clone of this object which was converted to UTC\n\t *\n\t * @returns {DateTimeValue}\n\t */\n\tgetInUTC() {\n\t\tconst clonedICALTime = this._innerValue.convertToZone(ICAL.Timezone.utcTimezone)\n\t\treturn DateTimeValue.fromICALJs(clonedICALTime)\n\t}\n\n\t/**\n\t * This silently replaces the inner timezone without converting the actual time\n\t *\n\t * @param {ICAL.Timezone} timezone The timezone to replace with\n\t * @package\n\t */\n\tsilentlyReplaceTimezone(timezone) {\n\t\tthis._modify()\n\t\tthis._innerValue = new ICAL.Time({\n\t\t\tyear: this.year,\n\t\t\tmonth: this.month,\n\t\t\tday: this.day,\n\t\t\thour: this.hour,\n\t\t\tminute: this.minute,\n\t\t\tsecond: this.second,\n\t\t\tisDate: this.isDate,\n\t\t\ttimezone,\n\t\t})\n\t}\n\n\t/**\n\t * Replaces the inner timezone without converting the actual time\n\t *\n\t * @param {Timezone} timezone The timezone to replace with\n\t */\n\treplaceTimezone(timezone) {\n\t\tthis._modifyContent()\n\t\tthis._innerValue = ICAL.Time.fromData({\n\t\t\tyear: this.year,\n\t\t\tmonth: this.month,\n\t\t\tday: this.day,\n\t\t\thour: this.hour,\n\t\t\tminute: this.minute,\n\t\t\tsecond: this.second,\n\t\t\tisDate: this.isDate,\n\t\t}, timezone.toICALTimezone())\n\t}\n\n\t/**\n\t * Calculates the UTC offset of the date-time-value in its timezone\n\t *\n\t * @returns {Number}\n\t */\n\tutcOffset() {\n\t\treturn this._innerValue.utcOffset()\n\t}\n\n\t/**\n\t * Check if this is an event with floating time\n\t *\n\t * @returns {boolean}\n\t */\n\tisFloatingTime() {\n\t\treturn this._innerValue.zone.tzid === 'floating'\n\t}\n\n\t/**\n\t * clones this value\n\t *\n\t * @returns {DateTimeValue}\n\t */\n\tclone() {\n\t\treturn DateTimeValue.fromICALJs(this._innerValue.clone())\n\t}\n\n\t/**\n\t * Create a new DateTimeValue object from an ICAL.Time object\n\t *\n\t * @param {ICAL.Time} icalValue The ical.js Date value to initialise from\n\t * @returns {DateTimeValue}\n\t */\n\tstatic fromICALJs(icalValue) {\n\t\treturn new DateTimeValue(icalValue)\n\t}\n\n\t/**\n\t * Creates a new DateTimeValue object based on a vanilla javascript object\n\t *\n\t * @param {Date} jsDate The JavaScript date to initialise from\n\t * @param {Boolean=} useUTC Whether or not to treat it as UTC\n\t * @returns {DateTimeValue}\n\t */\n\tstatic fromJSDate(jsDate, useUTC = false) {\n\t\tconst icalValue = ICAL.Time.fromJSDate(jsDate, useUTC)\n\t\treturn DateTimeValue.fromICALJs(icalValue)\n\t}\n\n\t/**\n\t * Creates a new DateTimeValue object based on simple parameters\n\t *\n\t * @param {Object} data The destructuring object\n\t * @param {Number=} data.year Amount of years to set\n\t * @param {Number=} data.month Amount of month to set (1-based)\n\t * @param {Number=} data.day Amount of days to set\n\t * @param {Number=} data.hour Amount of hours to set\n\t * @param {Number=} data.minute Amount of minutes to set\n\t * @param {Number=} data.second Amount of seconds to set\n\t * @param {Boolean=} data.isDate Whether this is a date or date-time\n\t * @param {Timezone=} timezone The timezone of the DateTimeValue\n\t * @returns {DateTimeValue}\n\t */\n\tstatic fromData(data, timezone) {\n\t\tconst icalValue = ICAL.Time.fromData(data, timezone\n\t\t\t? timezone.toICALTimezone()\n\t\t\t: undefined)\n\t\treturn DateTimeValue.fromICALJs(icalValue)\n\t}\n\n}\n\nDateTimeValue.SUNDAY = ICAL.Time.SUNDAY\nDateTimeValue.MONDAY = ICAL.Time.MONDAY\nDateTimeValue.TUESDAY = ICAL.Time.TUESDAY\nDateTimeValue.WEDNESDAY = ICAL.Time.WEDNESDAY\nDateTimeValue.THURSDAY = ICAL.Time.THURSDAY\nDateTimeValue.FRIDAY = ICAL.Time.FRIDAY\nDateTimeValue.SATURDAY = ICAL.Time.SATURDAY\n\nDateTimeValue.DEFAULT_WEEK_START = DateTimeValue.MONDAY\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport AbstractValue from './abstractValue.js'\nimport DateTimeValue from './dateTimeValue.js'\nimport DurationValue from './durationValue.js'\nimport ICAL from 'ical.js'\n\n/**\n * @class PeriodValue\n * @classdesc Wrapper for ICAL.Period\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.3.9\n * @url https://github.com/mozilla-comm/ical.js/blob/master/lib/ical/period.js\n */\nexport default class PeriodValue extends AbstractValue {\n\n\t/**\n\t * @inheritDoc\n\t */\n\tconstructor(...args) {\n\t\tsuper(...args)\n\n\t\t/**\n\t\t * DateTimeValue object for start\n\t\t *\n\t\t * @type {DateTimeValue}\n\t\t * @private\n\t\t */\n\t\tthis._start = DateTimeValue.fromICALJs(this._innerValue.start)\n\n\t\t/**\n\t\t * DateTimeValue object for end\n\t\t *\n\t\t * @type {DateTimeValue|null}\n\t\t * @private\n\t\t */\n\t\tthis._end = null\n\n\t\t/**\n\t\t * DurationValue object for duration\n\t\t *\n\t\t * @type {DurationValue|null}\n\t\t * @private\n\t\t */\n\t\tthis._duration = null\n\t}\n\n\t/**\n\t * Gets the start of the period-value\n\t *\n\t * @returns {DateTimeValue}\n\t */\n\tget start() {\n\t\treturn this._start\n\t}\n\n\t/**\n\t * Sets the start of the period-value\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @param {DateTimeValue} start The start of the period\n\t */\n\tset start(start) {\n\t\tthis._modifyContent()\n\t\tthis._start = start\n\t\tthis._innerValue.start = start.toICALJs()\n\t}\n\n\t/**\n\t * Gets the end of the period-value\n\t *\n\t * @returns {DateTimeValue}\n\t */\n\tget end() {\n\t\tif (!this._end) {\n\t\t\tif (this._duration) {\n\t\t\t\tthis._duration.lock()\n\t\t\t\tthis._duration = null\n\t\t\t}\n\n\t\t\tthis._innerValue.end = this._innerValue.getEnd()\n\t\t\tthis._end = DateTimeValue.fromICALJs(this._innerValue.end)\n\t\t\tthis._innerValue.duration = null\n\n\t\t\tif (this.isLocked()) {\n\t\t\t\tthis._end.lock()\n\t\t\t}\n\t\t}\n\n\t\treturn this._end\n\t}\n\n\t/**\n\t * Sets the end of the period-value\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @param {DateTimeValue} end The end of the period\n\t */\n\tset end(end) {\n\t\tthis._modifyContent()\n\t\tthis._innerValue.duration = null\n\t\tthis._innerValue.end = end.toICALJs()\n\t\tthis._end = end\n\t}\n\n\t/**\n\t * Gets the duration of the period-value\n\t * The value is automatically locked.\n\t * If you want to edit the value, clone it and it as new duration\n\t *\n\t * @returns {DurationValue}\n\t */\n\tget duration() {\n\t\tif (!this._duration) {\n\t\t\tif (this._end) {\n\t\t\t\tthis._end.lock()\n\t\t\t\tthis._end = null\n\t\t\t}\n\n\t\t\tthis._innerValue.duration = this._innerValue.getDuration()\n\t\t\tthis._duration = DurationValue.fromICALJs(this._innerValue.duration)\n\t\t\tthis._innerValue.end = null\n\n\t\t\tif (this.isLocked()) {\n\t\t\t\tthis._duration.lock()\n\t\t\t}\n\t\t}\n\n\t\treturn this._duration\n\t}\n\n\t/**\n\t * Sets the duration of the period-value\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @param {DurationValue} duration The duration to set\n\t */\n\tset duration(duration) {\n\t\tthis._modifyContent()\n\t\tthis._innerValue.end = null\n\t\tthis._innerValue.duration = duration.toICALJs()\n\t\tthis._duration = duration\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tlock() {\n\t\tsuper.lock()\n\t\tthis.start.lock()\n\n\t\tif (this._end) {\n\t\t\tthis._end.lock()\n\t\t}\n\t\tif (this._duration) {\n\t\t\tthis._duration.lock()\n\t\t}\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tunlock() {\n\t\tsuper.unlock()\n\t\tthis.start.unlock()\n\n\t\tif (this._end) {\n\t\t\tthis._end.unlock()\n\t\t}\n\t\tif (this._duration) {\n\t\t\tthis._duration.unlock()\n\t\t}\n\t}\n\n\t/**\n\t * clones this value\n\t *\n\t * @returns {PeriodValue}\n\t */\n\tclone() {\n\t\treturn PeriodValue.fromICALJs(this._innerValue.clone())\n\t}\n\n\t/**\n\t * Create a new PeriodValue object from a ICAL.Period object\n\t *\n\t * @param {ICAL.Period} icalValue The ical.js period value to initialise from\n\t * @returns {PeriodValue}\n\t */\n\tstatic fromICALJs(icalValue) {\n\t\treturn new PeriodValue(icalValue)\n\t}\n\n\t/**\n\t * Create a new PeriodValue object from start and end\n\t *\n\t * @param {Object} data The destructuring object\n\t * @param {DateTimeValue} data.start The start of the period\n\t * @param {DateTimeValue} data.end The end of the period\n\t * @returns {PeriodValue}\n\t */\n\tstatic fromDataWithEnd(data) {\n\t\tconst icalPeriod = ICAL.Period.fromData({\n\t\t\tstart: data.start.toICALJs(),\n\t\t\tend: data.end.toICALJs(),\n\t\t})\n\t\treturn PeriodValue.fromICALJs(icalPeriod)\n\t}\n\n\t/**\n\t * Create a new PeriodValue object from start and duration\n\t *\n\t * @param {Object} data The destructuring object\n\t * @param {DateTimeValue} data.start The start of the period\n\t * @param {DurationValue} data.duration The duration of the period\n\t * @returns {PeriodValue}\n\t */\n\tstatic fromDataWithDuration(data) {\n\t\tconst icalPeriod = ICAL.Period.fromData({\n\t\t\tstart: data.start.toICALJs(),\n\t\t\tduration: data.duration.toICALJs(),\n\t\t})\n\t\treturn PeriodValue.fromICALJs(icalPeriod)\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport AbstractValue from './abstractValue.js'\nimport DateTimeValue from './dateTimeValue.js'\nimport { uc } from '../helpers/stringHelper.js'\nimport ICAL from 'ical.js'\n\nconst ALLOWED_FREQ = ['SECONDLY', 'MINUTELY', 'HOURLY', 'DAILY', 'WEEKLY', 'MONTHLY', 'YEARLY']\n\n/**\n * @class RecurValue\n * @classdesc Wrapper for ICAL.Recur\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.3.10\n * @url https://github.com/mozilla-comm/ical.js/blob/master/lib/ical/recur.js\n */\nexport default class RecurValue extends AbstractValue {\n\n\t/**\n\t * Constructor\n\t *\n\t * @param {ICAL.Recur} icalValue The ical.js rrule value\n\t * @param {DateTimeValue?} until The Until date\n\t */\n\tconstructor(icalValue, until) {\n\t\tsuper(icalValue)\n\n\t\t/**\n\t\t * DateTimeValue object for Until\n\t\t *\n\t\t * @type {DateTimeValue}\n\t\t * @private\n\t\t */\n\t\tthis._until = until\n\t}\n\n\t/**\n\t * Gets the stored interval of this recurrence rule\n\t *\n\t * @returns {Number}\n\t */\n\tget interval() {\n\t\treturn this._innerValue.interval\n\t}\n\n\t/**\n\t * Sets the stored interval of this recurrence rule\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @param {Number} interval New Interval to set\n\t */\n\tset interval(interval) {\n\t\tthis._modifyContent()\n\t\tthis._innerValue.interval = parseInt(interval, 10)\n\t}\n\n\t/**\n\t * Gets the weekstart used to calculate the recurrence expansion\n\t *\n\t * @returns {Number}\n\t */\n\tget weekStart() {\n\t\treturn this._innerValue.wkst\n\t}\n\n\t/**\n\t * Sets the weekstart used to calculate the recurrence expansion\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @throws {TypeError} if weekstart out of range\n\t * @param {Number} weekStart New start of week to set\n\t */\n\tset weekStart(weekStart) {\n\t\tthis._modifyContent()\n\t\tif (weekStart < DateTimeValue.SUNDAY || weekStart > DateTimeValue.SATURDAY) {\n\t\t\tthrow new TypeError('Weekstart out of range')\n\t\t}\n\n\t\tthis._innerValue.wkst = weekStart\n\t}\n\n\t/**\n\t * Gets the until value if set\n\t * The value is automatically locked.\n\t * If you want to edit the value, clone it and it as new until\n\t *\n\t * @returns {null|DateTimeValue}\n\t */\n\tget until() {\n\t\tif (!this._until && this._innerValue.until) {\n\t\t\tthis._until = DateTimeValue.fromICALJs(this._innerValue.until)\n\t\t}\n\n\t\treturn this._until\n\t}\n\n\t/**\n\t * Sets the until value, automatically removes count\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @param {DateTimeValue} until New until date to set\n\t */\n\tset until(until) {\n\t\tthis._modifyContent()\n\n\t\tif (this._until) {\n\t\t\tthis._until.lock()\n\t\t}\n\n\t\tthis._until = until\n\t\tthis._innerValue.count = null\n\t\tthis._innerValue.until = until.toICALJs()\n\t}\n\n\t/**\n\t * Gets the count value if set\n\t *\n\t * @returns {null|Number}\n\t */\n\tget count() {\n\t\treturn this._innerValue.count\n\t}\n\n\t/**\n\t * Sets the count value, automatically removes until\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @param {Number} count New occurrence limit to set\n\t */\n\tset count(count) {\n\t\tthis._modifyContent()\n\n\t\tif (this._until) {\n\t\t\tthis._until.lock()\n\t\t\tthis._until = null\n\t\t}\n\n\t\tthis._innerValue.until = null\n\t\tthis._innerValue.count = parseInt(count, 10)\n\t}\n\n\t/**\n\t * Gets the frequency of the recurrence rule\n\t *\n\t * @returns {String} see\n\t */\n\tget frequency() {\n\t\treturn this._innerValue.freq\n\t}\n\n\t/**\n\t * Sets the frequency of the recurrence rule\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @throws {TypeError} if frequency is unknown\n\t * @param {String} freq New frequency to set\n\t */\n\tset frequency(freq) {\n\t\tthis._modifyContent()\n\t\tif (!ALLOWED_FREQ.includes(freq)) {\n\t\t\tthrow new TypeError('Unknown frequency')\n\t\t}\n\n\t\tthis._innerValue.freq = freq\n\t}\n\n\t/**\n\t * Modifies this recurrence-value to unset count and until\n\t */\n\tsetToInfinite() {\n\t\tthis._modifyContent()\n\n\t\tif (this._until) {\n\t\t\tthis._until.lock()\n\t\t\tthis._until = null\n\t\t}\n\n\t\tthis._innerValue.until = null\n\t\tthis._innerValue.count = null\n\t}\n\n\t/**\n\t * Checks whether the stored rule is finite\n\t *\n\t * @returns {Boolean}\n\t */\n\tisFinite() {\n\t\treturn this._innerValue.isFinite()\n\t}\n\n\t/**\n\t * Checks whether the recurrence rule is limited by count\n\t *\n\t * @returns {Boolean}\n\t */\n\tisByCount() {\n\t\treturn this._innerValue.isByCount()\n\t}\n\n\t/**\n\t * Adds a part to a component to the recurrence-rule\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @param {String} componentName The name of the recurrence-component to add\n\t * @param {String|Number} value The value to add\n\t */\n\taddComponent(componentName, value) {\n\t\tthis._modifyContent()\n\t\tthis._innerValue.addComponent(componentName, value)\n\t}\n\n\t/**\n\t * Sets / overwrites a component to the recurrence-rule\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @param {String} componentName The name of the component to set\n\t * @param {Number[]|String[]} value The value to set\n\t */\n\tsetComponent(componentName, value) {\n\t\tthis._modifyContent()\n\n\t\tif (value.length === 0) {\n\t\t\tdelete this._innerValue.parts[componentName.toUpperCase()]\n\t\t} else {\n\t\t\tthis._innerValue.setComponent(componentName, value)\n\t\t}\n\t}\n\n\t/**\n\t * Removes all parts of a component\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @param {String} componentName The name of the component to remove\n\t */\n\tremoveComponent(componentName) {\n\t\tdelete this._innerValue.parts[uc(componentName)]\n\t}\n\n\t/**\n\t * Gets all parts of a component\n\t *\n\t * @param {String} componentName The name of the component to get\n\t * @returns {Array}\n\t */\n\tgetComponent(componentName) {\n\t\treturn this._innerValue.getComponent(componentName)\n\t}\n\n\t/**\n\t * Checks if this recurrence rule is valid according to RFC 5545\n\t *\n\t * @returns {boolean}\n\t */\n\tisRuleValid() {\n\t\treturn true\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tlock() {\n\t\tsuper.lock()\n\n\t\tif (this._until) {\n\t\t\tthis._until.lock()\n\t\t}\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tunlock() {\n\t\tsuper.unlock()\n\n\t\tif (this._until) {\n\t\t\tthis._until.unlock()\n\t\t}\n\t}\n\n\t/**\n\t * clones this value\n\t *\n\t * @returns {RecurValue}\n\t */\n\tclone() {\n\t\treturn RecurValue.fromICALJs(this._innerValue.clone())\n\t}\n\n\t/**\n\t * Create a new RecurValue object from a ICAL.Recur object\n\t *\n\t * @param {ICAL.Recur} icalValue The ICAL.JS Recur value\n\t * @param {DateTimeValue?} until The Until date\n\t * @returns {RecurValue}\n\t */\n\tstatic fromICALJs(icalValue, until = null) {\n\t\treturn new RecurValue(icalValue, until)\n\t}\n\n\t/**\n\t * Create a new RecurValue object from a data object\n\t *\n\t * @param {Object} data The destructuring object\n\t * @param {String=} data.freq FREQ part of RRULE\n\t * @param {Number=} data.interval INTERVAL part of RRULE\n\t * @param {Number=} data.wkst WEEKSTART part of RRULE\n\t * @param {DateTimeValue=} data.until UNTIL part of RRULE\n\t * @param {Number=} data.count COUNT part of RRULE\n\t * @param {Number[]=} data.bysecond BYSECOND part of RRULE\n\t * @param {Number[]=} data.byminute BYMINUTE part of RRULE\n\t * @param {Number[]=} data.byhour BYHOUR part of RRULE\n\t * @param {String[]=} data.byday BYDAY part of RRULE\n\t * @param {Number[]=} data.bymonthday BYMONTHDAY part of RRULE\n\t * @param {Number[]=} data.byyearday BYYEARDAY part of RRULE\n\t * @param {Number[]=} data.byweekno BYWEEKNO part of RRULE\n\t * @param {Number[]=} data.bymonth BYMONTH part of RRULE\n\t * @param {Number[]=} data.bysetpos BYSETPOS part of RRULE\n\t * @returns {RecurValue}\n\t */\n\tstatic fromData(data) {\n\t\tlet until = null\n\n\t\tif (data.until) {\n\t\t\tuntil = data.until\n\t\t\tdata.until = data.until.toICALJs()\n\t\t}\n\n\t\tconst icalRecur = ICAL.Recur.fromData(data)\n\t\treturn RecurValue.fromICALJs(icalRecur, until)\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport AbstractValue from './abstractValue.js'\nimport ICAL from 'ical.js'\n\n/**\n * @class UTCOffsetValue\n * @classdesc Wrapper for ICAL.UtcOffset\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.3.14\n * @url https://github.com/mozilla-comm/ical.js/blob/master/lib/ical/utc_offset.js\n */\nexport default class UTCOffsetValue extends AbstractValue {\n\n\t/**\n\t * Gets the hour part of the offset-value\n\t *\n\t * @returns {Number}\n\t */\n\tget hours() {\n\t\treturn this._innerValue.hours\n\t}\n\n\t/**\n\t * Sets the hour part of the offset-value\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n \t * @param {Number} hours - New hours to set\n\t */\n\tset hours(hours) {\n\t\tthis._modifyContent()\n\t\tthis._innerValue.hours = hours\n\t}\n\n\t/**\n\t * Gets the minute part of the offset-value\n\t *\n\t * @returns {Number}\n\t */\n\tget minutes() {\n\t\treturn this._innerValue.minutes\n\t}\n\n\t/**\n\t * Sets the minute part of the offset-value\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @param {Number} minutes - New minutes to set\n\t */\n\tset minutes(minutes) {\n\t\tthis._modifyContent()\n\t\tthis._innerValue.minutes = minutes\n\t}\n\n\t/**\n\t * Gets the factor\n\t *\n\t * @returns {Number}\n\t */\n\tget factor() {\n\t\treturn this._innerValue.factor\n\t}\n\n\t/**\n\t * Sets the factor\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @throws {TypeError} if factor is neither 1 nor -1\n\t * @param {Number} factor - New factor to set, 1 for positive, -1 for negative\n\t */\n\tset factor(factor) {\n\t\tthis._modifyContent()\n\t\tif (factor !== 1 && factor !== -1) {\n\t\t\tthrow new TypeError('Factor may only be set to 1 or -1')\n\t\t}\n\n\t\tthis._innerValue.factor = factor\n\t}\n\n\t/**\n\t * Gets the total amount of seconds\n\t *\n\t * @returns {Number}\n\t */\n\tget totalSeconds() {\n\t\treturn this._innerValue.toSeconds()\n\t}\n\n\t/**\n\t * Sets the total amount of seconds\n\t *\n\t * @throws {ModificationNotAllowedError} if value is locked for modification\n\t * @param {Number} totalSeconds - New number of total seconds to set\n\t */\n\tset totalSeconds(totalSeconds) {\n\t\tthis._modifyContent()\n\t\tthis._innerValue.fromSeconds(totalSeconds)\n\t}\n\n\t/**\n\t * Compares this UTCOffset to another one\n\t *\n\t * @param {UTCOffsetValue} other - The other UTCOffsetValue to compare with\n\t * @returns {Number} -1, 0 or 1 for less/equal/greater\n\t */\n\tcompare(other) {\n\t\treturn this._innerValue.compare(other.toICALJs())\n\t}\n\n\t/**\n\t * Clones this value\n\t *\n\t * @returns {UTCOffsetValue}\n\t */\n\tclone() {\n\t\treturn UTCOffsetValue.fromICALJs(this._innerValue.clone())\n\t}\n\n\t/**\n\t * Create a new UTCOffsetValue object from a ICAL.UTCOffset object\n\t *\n\t * @param {ICAL.UtcOffset} icalValue - The ICAL.UtcOffset object to initialize this object from\n\t * @returns {UTCOffsetValue}\n\t */\n\tstatic fromICALJs(icalValue) {\n\t\treturn new UTCOffsetValue(icalValue)\n\t}\n\n\t/**\n\t * Create a new UTCOffsetValue object from a data object\n\t *\n\t * @param {Object} data - Object with data to create UTCOffsetValue object from\n\t * @param {Number=} data.hours - The number of hours to set\n\t * @param {Number=} data.minutes - The number of minutes to set\n\t * @param {Number=} data.factor - The factor to use, 1 for positive, -1 for negative\n\t * @returns {UTCOffsetValue}\n\t */\n\tstatic fromData(data) {\n\t\tconst icalUTCOffset = new ICAL.UtcOffset()\n\t\ticalUTCOffset.fromData(data)\n\t\treturn UTCOffsetValue.fromICALJs(icalUTCOffset)\n\t}\n\n\t/**\n\t * Create a new UTCOffsetValue object from an amount of seconds\n\t *w\n\t * @param {Number} seconds - The total number of seconds to create the UTCOffsetValue object from\n\t * @returns {UTCOffsetValue}\n\t */\n\tstatic fromSeconds(seconds) {\n\t\tconst icalUTCOffset = ICAL.UtcOffset.fromSeconds(seconds)\n\t\treturn UTCOffsetValue.fromICALJs(icalUTCOffset)\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nexport default class UnknownICALTypeError extends Error {}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @author Richard Steinmetz <richard@steinmetz.cloud>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport AbstractValue from './abstractValue'\nimport BinaryValue from './binaryValue.js'\nimport DurationValue from './durationValue.js'\nimport PeriodValue from './periodValue.js'\nimport RecurValue from './recurValue.js'\nimport DateTimeValue from './dateTimeValue.js'\nimport UTCOffsetValue from './utcOffsetValue.js'\nimport UnknownICALTypeError from '../errors/unknownICALTypeError.js'\nimport { lc } from '../helpers/stringHelper.js'\n\n/**\n *\n * @param {String} icaltype The icaltype to get a Value constructor for\n * @returns {RecurValue|PeriodValue|BinaryValue|DurationValue|UTCOffsetValue|DateTimeValue}\n */\nexport function getConstructorForICALType(icaltype) {\n\tswitch (lc(icaltype)) {\n\tcase 'binary':\n\t\treturn BinaryValue\n\n\tcase 'date':\n\tcase 'date-time':\n\t\treturn DateTimeValue\n\n\tcase 'duration':\n\t\treturn DurationValue\n\n\tcase 'period':\n\t\treturn PeriodValue\n\n\tcase 'recur':\n\t\treturn RecurValue\n\n\tcase 'utc-offset':\n\t\treturn UTCOffsetValue\n\n\tdefault:\n\t\tthrow new UnknownICALTypeError()\n\t}\n}\n\nexport {\n\tAbstractValue,\n\tBinaryValue,\n\tDateTimeValue,\n\tDurationValue,\n\tPeriodValue,\n\tRecurValue,\n\tUTCOffsetValue,\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport ExpectedICalJSError from '../errors/expectedICalJSError.js'\nimport Parameter from '../parameters/parameter.js'\nimport { createProperty } from '../factories/icalFactory.js'\nimport { lc, uc } from '../helpers/stringHelper.js'\nimport { getConstructorForICALType } from '../values'\nimport AbstractValue from '../values/abstractValue.js'\nimport DateTimeValue from '../values/dateTimeValue.js'\nimport lockableTrait from '../traits/lockable.js'\nimport observerTrait from '../traits/observer.js'\nimport ICAL from 'ical.js'\n\n/**\n * @class Property\n * @classdesc This class represents a property as defined in RFC 5545 Section 3.5\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.5\n * @url https://github.com/mozilla-comm/ical.js/blob/master/lib/ical/property.js\n */\nexport default class Property extends observerTrait(lockableTrait(class {})) {\n\n\t/**\n\t * Constructor\n\t *\n\t * @param {String} name The name of the property\n\t * @param {String|Number|AbstractValue|String[]|Number[]|AbstractValue[]|null} value The value of the property\n\t * @param {Parameter[]|[String][]} parameters Array of parameters\n\t * @param {CalendarComponent|null} root The root of the calendar-document\n\t * @param {AbstractComponent|null} parent The parent-element of this property\n\t */\n\tconstructor(name, value = null, parameters = [], root = null, parent = null) {\n\t\tsuper()\n\n\t\t/**\n\t\t * Name of the property\n\t\t *\n\t\t * @type {String}\n\t\t * @protected\n\t\t */\n\t\tthis._name = uc(name)\n\n\t\t/**\n\t\t * Value of the property\n\t\t *\n\t\t * @type {String|Number|AbstractValue|String[]|Number[]|AbstractValue[]|null}\n\t\t * @protected\n\t\t */\n\t\tthis._value = value\n\n\t\t/**\n\t\t * List of parameters associated with this parameter\n\t\t *\n\t\t * @type {Map<String, Parameter>}\n\t\t */\n\t\tthis._parameters = new Map()\n\n\t\t/**\n\t\t * Root node of ical document\n\t\t *\n\t\t * @type {CalendarComponent|null}\n\t\t * @protected\n\t\t */\n\t\tthis._root = root\n\n\t\t/**\n\t\t * Parent node\n\t\t *\n\t\t * @type {AbstractComponent|null}\n\t\t * @protected\n\t\t */\n\t\tthis._parent = parent\n\n\t\tthis._setParametersFromConstructor(parameters)\n\t\tif (value instanceof AbstractValue) {\n\t\t\tvalue.subscribe(() => this._notifySubscribers())\n\t\t}\n\t}\n\n\t/**\n\t * Get property name\n\t *\n\t * @readonly\n\t * @returns {String}\n\t */\n\tget name() {\n\t\treturn this._name\n\t}\n\n\t/**\n\t * Get parameter value\n\t *\n\t * @returns {String|Number|AbstractValue|String[]|Number[]|AbstractValue[]|null}\n\t */\n\tget value() {\n\t\treturn this._value\n\t}\n\n\t/**\n\t * Set new parameter value\n\t *\n\t * @param {String|Number|AbstractValue|String[]|Number[]|AbstractValue[]|null} value The value of the property\n\t * @throws {ModificationNotAllowedError} if property is locked for modification\n\t */\n\tset value(value) {\n\t\tthis._modifyContent()\n\t\tthis._value = value\n\n\t\tif (value instanceof AbstractValue) {\n\t\t\tvalue.subscribe(() => this._notifySubscribers())\n\t\t}\n\t}\n\n\t/**\n\t * Gets the root of this property\n\t *\n\t * @returns {CalendarComponent|null}\n\t */\n\tget root() {\n\t\treturn this._root\n\t}\n\n\t/**\n\t * Sets the root of this property\n\t *\n\t * @param {CalendarComponent|null} root The root of the calendar-document\n\t * @throws {ModificationNotAllowedError} if property is locked for modification\n\t */\n\tset root(root) {\n\t\tthis._modify()\n\t\tthis._root = root\n\t}\n\n\t/**\n\t * Gets the direct parent element of this property\n\t *\n\t * @returns {AbstractComponent}\n\t */\n\tget parent() {\n\t\treturn this._parent\n\t}\n\n\t/**\n\t * Sets the direct parent element of this property\n\t *\n\t * @param {AbstractComponent|null} parent The parent element of this property\n\t * @throws {ModificationNotAllowedError} if property is locked for modification\n\t */\n\tset parent(parent) {\n\t\tthis._modify()\n\t\tthis._parent = parent\n\t}\n\n\t/**\n\t * Gets the first value of this property\n\t *\n\t * @returns {null|String|Number|AbstractValue}\n\t */\n\tgetFirstValue() {\n\t\tif (!this.isMultiValue()) {\n\t\t\treturn this.value\n\t\t} else {\n\t\t\tif (this.value.length > 0) {\n\t\t\t\treturn this.value[0]\n\t\t\t}\n\t\t}\n\n\t\treturn null\n\t}\n\n\t/**\n\t * Gets an iterator over all values\n\t */\n\t* getValueIterator() {\n\t\tif (this.isMultiValue()) {\n\t\t\tyield * this.value.slice()[Symbol.iterator]()\n\t\t} else {\n\t\t\tyield this.value\n\t\t}\n\t}\n\n\t/**\n\t * Adds a value to the multi-value property\n\t *\n\t * @param {String|AbstractValue} value Value to add\n\t */\n\taddValue(value) {\n\t\tif (!this.isMultiValue()) {\n\t\t\tthrow new TypeError('This is not a multivalue property')\n\t\t}\n\n\t\tthis._modifyContent()\n\t\tthis.value.push(value)\n\t}\n\n\t/**\n\t * Checks if a value is inside this multi-value property\n\t *\n\t * @param {String|AbstractValue} value Value to check for\n\t * @returns {Boolean}\n\t */\n\thasValue(value) {\n\t\tif (!this.isMultiValue()) {\n\t\t\tthrow new TypeError('This is not a multivalue property')\n\t\t}\n\n\t\treturn this.value.includes(value)\n\t}\n\n\t/**\n\t * Removes a value from this multi-value property\n\t *\n\t * @param {String|AbstractValue} value Value to remove\n\t */\n\tremoveValue(value) {\n\t\tif (!this.hasValue(value)) {\n\t\t\treturn\n\t\t}\n\n\t\tthis._modifyContent()\n\t\tconst index = this.value.indexOf(value)\n\t\tthis.value.splice(index, 1)\n\t}\n\n\t/**\n\t * Sets a parameter on this property\n\t *\n\t * @param {Parameter} parameter The parameter to set\n\t * @throws {ModificationNotAllowedError} if property is locked for modification\n\t */\n\tsetParameter(parameter) {\n\t\tthis._modify()\n\t\tthis._parameters.set(parameter.name, parameter)\n\t\tparameter.subscribe(() => this._notifySubscribers())\n\t}\n\n\t/**\n\t * Gets a parameter on this property by its name\n\t *\n\t * @param {String} parameterName Name of the parameter to get\n\t * @returns {Parameter}\n\t */\n\tgetParameter(parameterName) {\n\t\treturn this._parameters.get(uc(parameterName))\n\t}\n\n\t/**\n\t * Gets an iterator over all available parameters\n\t */\n\t* getParametersIterator() {\n\t\tyield * this._parameters.values()\n\t}\n\n\t/**\n\t * Get first value of a parameter\n\t *\n\t * @param {String} parameterName Name of the parameter\n\t * @returns {null|String}\n\t */\n\tgetParameterFirstValue(parameterName) {\n\t\tconst parameter = this.getParameter(parameterName)\n\t\tif (parameter instanceof Parameter) {\n\t\t\tif (parameter.isMultiValue()) {\n\t\t\t\treturn parameter.value[0]\n\t\t\t} else {\n\t\t\t\treturn parameter.value\n\t\t\t}\n\t\t}\n\n\t\treturn null\n\t}\n\n\t/**\n\t * Returns whether a parameter exists on this property\n\t *\n\t * @param {String} parameterName Name of the parameter\n\t * @returns {boolean}\n\t */\n\thasParameter(parameterName) {\n\t\treturn this._parameters.has(uc(parameterName))\n\t}\n\n\t/**\n\t * Deletes a parameter on this property\n\t *\n\t * @param {String} parameterName Name of the parameter\n\t * @throws {ModificationNotAllowedError} if property is locked for modification\n\t */\n\tdeleteParameter(parameterName) {\n\t\tthis._modify()\n\t\tthis._parameters.delete(uc(parameterName))\n\t}\n\n\t/**\n\t * update a parameter if it exists,\n\t * create a new one if it doesn't\n\t *\n\t * @param {String} parameterName Name of the parameter\n\t * @param {string|Array|null} value Value to set\n\t * @throws {ModificationNotAllowedError} if property is locked for modification\n\t */\n\tupdateParameterIfExist(parameterName, value) {\n\t\tthis._modify()\n\t\tif (this.hasParameter(parameterName)) {\n\t\t\tconst parameter = this.getParameter(parameterName)\n\t\t\tparameter.value = value\n\t\t} else {\n\t\t\tconst parameter = new Parameter(uc(parameterName), value)\n\t\t\tthis.setParameter(parameter)\n\t\t}\n\t}\n\n\t/**\n\t * Returns whether or not the value is a multivalue\n\t *\n\t * @returns {Boolean}\n\t */\n\tisMultiValue() {\n\t\treturn Array.isArray(this._value)\n\t}\n\n\t/**\n\t * Returns whether or not this valus is decorated\n\t *\n\t * @returns {boolean}\n\t */\n\tisDecoratedValue() {\n\t\tif (this.isMultiValue()) {\n\t\t\treturn this._value[0] instanceof AbstractValue\n\t\t} else {\n\t\t\treturn this._value instanceof AbstractValue\n\t\t}\n\t}\n\n\t/**\n\t * Marks this parameter is immutable\n\t * locks it against further modification\n\t */\n\tlock() {\n\t\tsuper.lock()\n\n\t\tfor (const parameter of this.getParametersIterator()) {\n\t\t\tparameter.lock()\n\t\t}\n\n\t\tif (this.isDecoratedValue()) {\n\t\t\tfor (const value of this.getValueIterator()) {\n\t\t\t\tvalue.lock()\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Marks this parameter as mutable\n\t * allowing further modification\n\t */\n\tunlock() {\n\t\tsuper.unlock()\n\n\t\tfor (const parameter of this.getParametersIterator()) {\n\t\t\tparameter.unlock()\n\t\t}\n\n\t\tif (this.isDecoratedValue()) {\n\t\t\tfor (const value of this.getValueIterator()) {\n\t\t\t\tvalue.unlock()\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Creates a copy of this parameter\n\t *\n\t * @returns {Property}\n\t */\n\tclone() {\n\t\tconst parameters = []\n\t\tfor (const parameter of this.getParametersIterator()) {\n\t\t\tparameters.push(parameter.clone())\n\t\t}\n\n\t\treturn new this.constructor(this.name, this._cloneValue(), parameters, this.root, this.parent)\n\t}\n\n\t/**\n\t * Copies the values of this property\n\t *\n\t * @returns {String|Number|AbstractValue|String[]|Number[]|AbstractValue[]|null}\n\t * @protected\n\t */\n\t_cloneValue() {\n\t\tif (this.isDecoratedValue()) {\n\t\t\tif (this.isMultiValue()) {\n\t\t\t\treturn this._value.map((val) => val.clone())\n\t\t\t} else {\n\t\t\t\treturn this._value.clone()\n\t\t\t}\n\t\t} else {\n\t\t\tif (this.isMultiValue()) {\n\t\t\t\t// only copy array values, don't copy array reference\n\t\t\t\treturn this._value.slice()\n\t\t\t} else {\n\t\t\t\treturn this._value\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Sets parameters from the constructor\n\t *\n\t * @param {Parameter[]|[String][]} parameters Array of parameters to set\n\t * @private\n\t */\n\t_setParametersFromConstructor(parameters) {\n\t\tparameters.forEach((parameter) => {\n\t\t\tif (!(parameter instanceof Parameter)) {\n\t\t\t\tparameter = new Parameter(parameter[0], parameter[1])\n\t\t\t}\n\n\t\t\tthis.setParameter(parameter)\n\t\t})\n\t}\n\n\t/**\n\t * Creates a new Component based on an ical object\n\t *\n\t * @param {ICAL.Property} icalProperty The ical.js property to initialise from\n\t * @param {CalendarComponent=} root The root of the calendar-document\n\t * @param {AbstractComponent=} parent The parent element of this property\n\t * @returns {Property}\n\t */\n\tstatic fromICALJs(icalProperty, root = null, parent = null) {\n\t\tif (!(icalProperty instanceof ICAL.Property)) {\n\t\t\tthrow new ExpectedICalJSError()\n\t\t}\n\n\t\tlet value\n\t\tif (icalProperty.isDecorated) {\n\t\t\tconst constructor = getConstructorForICALType(icalProperty.getFirstValue().icaltype)\n\t\t\tif (icalProperty.isMultiValue) {\n\t\t\t\tvalue = icalProperty.getValues().map((val) => constructor.fromICALJs(val))\n\t\t\t} else {\n\t\t\t\tvalue = constructor.fromICALJs(icalProperty.getFirstValue())\n\t\t\t}\n\t\t} else {\n\t\t\tif (icalProperty.isMultiValue) {\n\t\t\t\tvalue = icalProperty.getValues()\n\t\t\t} else {\n\t\t\t\tvalue = icalProperty.getFirstValue()\n\t\t\t}\n\t\t}\n\n\t\tconst parameters = []\n\t\tconst paramNames = Object.keys(Object.assign({}, icalProperty.toJSON()[1]))\n\t\tparamNames.forEach((paramName) => {\n\t\t\t// Timezone id is handled by DateTimeValue\n\t\t\tif (uc(paramName) === 'TZID') {\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tparameters.push([paramName, icalProperty.getParameter(paramName)])\n\t\t})\n\n\t\treturn new this(icalProperty.name, value, parameters, root, parent)\n\t}\n\n\t/**\n\t * Returns an ICAL.js property based on this Property\n\t *\n\t * @returns {ICAL.Property}\n\t */\n\ttoICALJs() {\n\t\tconst icalProperty = createProperty(lc(this.name))\n\n\t\tif (this.isMultiValue()) {\n\t\t\tif (this.isDecoratedValue()) {\n\t\t\t\ticalProperty.setValues(this.value.map((val) => val.toICALJs()))\n\t\t\t} else {\n\t\t\t\ticalProperty.setValues(this.value)\n\t\t\t}\n\t\t} else {\n\t\t\tif (this.isDecoratedValue()) {\n\t\t\t\ticalProperty.setValue(this.value.toICALJs())\n\t\t\t} else {\n\t\t\t\ticalProperty.setValue(this.value)\n\n\t\t\t}\n\t\t}\n\n\t\tfor (const parameter of this.getParametersIterator()) {\n\t\t\ticalProperty.setParameter(lc(parameter.name), parameter.value)\n\t\t}\n\n\t\tconst firstValue = this.getFirstValue()\n\t\tif (firstValue instanceof DateTimeValue\n\t\t\t&& firstValue.timezoneId !== 'floating'\n\t\t\t&& firstValue.timezoneId !== 'UTC'\n\t\t\t&& !firstValue.isDate) {\n\t\t\ticalProperty.setParameter('tzid', firstValue.timezoneId)\n\t\t}\n\n\t\treturn icalProperty\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\t_modifyContent() {\n\t\tsuper._modifyContent()\n\t\tthis._notifySubscribers()\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport Property from './property.js'\nimport BinaryValue from '../values/binaryValue.js'\n\n/**\n * @class AttachmentProperty\n * @classdesc This class represents an attachment property as defined in RFC 5545 Section 3.8.1.1\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.1\n */\nexport default class AttachmentProperty extends Property {\n\n\t/**\n\t * Gets the format-type of this attachment\n\t *\n\t * @returns {String}\n\t */\n\tget formatType() {\n\t\treturn this.getParameterFirstValue('FMTTYPE')\n\t}\n\n\t/**\n\t * Sets the format-type of this attachment\n\t *\n\t * @param {String} fmtType Mime-type of attachment\n\t */\n\tset formatType(fmtType) {\n\t\tthis.updateParameterIfExist('FMTTYPE', fmtType)\n\t}\n\n\t/**\n\t * Gets the uri of this attachment\n\t *\n\t * @returns {String|null}\n\t */\n\tget uri() {\n\t\tif (this._value instanceof BinaryValue) {\n\t\t\treturn null\n\t\t}\n\n\t\treturn this._value\n\t}\n\n\t/**\n\t * Sets the uri of this attachment\n\t *\n\t * @param {String} uri Link to attachment if applicable\n\t */\n\tset uri(uri) {\n\t\tthis.value = uri\n\t}\n\n\t/**\n\t * Gets the encoding of this attachment\n\t *\n\t * @returns {string|null}\n\t */\n\tget encoding() {\n\t\tif (this._value instanceof BinaryValue) {\n\t\t\treturn 'BASE64'\n\t\t}\n\n\t\treturn null\n\t}\n\n\t/**\n\t * Gets the data stored in this attachment\n\t *\n\t * @returns {String|null}\n\t */\n\tget data() {\n\t\tif (this._value instanceof BinaryValue) {\n\t\t\treturn this._value.value\n\t\t}\n\n\t\treturn null\n\t}\n\n\t/**\n\t * Sets the data stored in this attachment\n\t *\n\t * @param {String} data The data of the attachment\n\t */\n\tset data(data) {\n\t\tif (this.value instanceof BinaryValue) {\n\t\t\tthis.value.value = data\n\t\t} else {\n\t\t\tthis.value = BinaryValue.fromDecodedValue(data)\n\t\t}\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\ttoICALJs() {\n\t\tconst icalProperty = super.toICALJs()\n\t\tif (this._value instanceof BinaryValue && this.getParameterFirstValue('ENCODING') !== 'BASE64') {\n\t\t\ticalProperty.setParameter('ENCODING', 'BASE64')\n\t\t}\n\n\t\treturn icalProperty\n\t}\n\n\t/**\n\t * Creates a new AttachmentProperty based on data\n\t *\n\t * @param {String} data The data of the attachment\n\t * @param {String=} formatType The mime-type of the data\n\t * @returns {AttachmentProperty}\n\t */\n\tstatic fromData(data, formatType = null) {\n\t\tconst binaryValue = BinaryValue.fromDecodedValue(data)\n\t\tconst property = new AttachmentProperty('ATTACH', binaryValue)\n\n\t\tif (formatType) {\n\t\t\tproperty.formatType = formatType\n\t\t}\n\n\t\treturn property\n\t}\n\n\t/**\n\t * Creates a new AttachmentProperty based on a link\n\t *\n\t * @param {String} uri The URI for the attachment\n\t * @param {String=} formatType The mime-type of the uri\n\t * @returns {AttachmentProperty}\n\t */\n\tstatic fromLink(uri, formatType = null) {\n\t\tconst property = new AttachmentProperty('ATTACH', uri)\n\n\t\tif (formatType) {\n\t\t\tproperty.formatType = formatType\n\t\t}\n\n\t\treturn property\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport Property from './property.js'\nimport { startStringWith, uc } from '../helpers/stringHelper.js'\n\n/**\n * @class AttendeeProperty\n * @classdesc This class represents an attendee property as defined in RFC 5545 Section 3.8.4.1\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.4.1\n */\nexport default class AttendeeProperty extends Property {\n\n\t/**\n\t * Returns the role of the attendee.\n\t *\n\t * @returns {string}\n\t */\n\tget role() {\n\t\tconst allowed = ['CHAIR', 'REQ-PARTICIPANT', 'OPT-PARTICIPANT', 'NON-PARTICIPANT']\n\t\tconst defaultValue = 'REQ-PARTICIPANT'\n\n\t\tif (this.hasParameter('ROLE')) {\n\t\t\tconst value = this.getParameterFirstValue('ROLE')\n\t\t\tif (allowed.includes(value)) {\n\t\t\t\treturn value\n\t\t\t}\n\t\t}\n\n\t\treturn defaultValue\n\t}\n\n\t/**\n\t * Sets new role of the attendee\n\t *\n\t * @param {String} role The role of the attendee (e.g. CHAIR, REQ-PARTICIPANT)\n\t */\n\tset role(role) {\n\t\tthis.updateParameterIfExist('ROLE', role)\n\t}\n\n\t/**\n\t * Returns the calendar-user-type of an attendee\n\t *\n\t * @returns {string}\n\t */\n\tget userType() {\n\t\tconst allowed = ['INDIVIDUAL', 'GROUP', 'RESOURCE', 'ROOM', 'UNKNOWN']\n\n\t\tif (!this.hasParameter('CUTYPE')) {\n\t\t\treturn 'INDIVIDUAL'\n\t\t} else {\n\t\t\tconst value = this.getParameterFirstValue('CUTYPE')\n\t\t\tif (allowed.includes(value)) {\n\t\t\t\treturn value\n\t\t\t}\n\n\t\t\treturn 'UNKNOWN'\n\t\t}\n\t}\n\n\t/**\n\t * Sets new calendar-user-type of attendee\n\t *\n\t * @param {String} userType The type of user (e.g. INDIVIDUAL, GROUP)\n\t */\n\tset userType(userType) {\n\t\tthis.updateParameterIfExist('CUTYPE', userType)\n\t}\n\n\t/**\n\t * Returns the \"Rpondez s'il vous plat\" value for attendee\n\t *\n\t * @returns {boolean}\n\t */\n\tget rsvp() {\n\t\tif (!this.hasParameter('RSVP')) {\n\t\t\treturn false\n\t\t} else {\n\t\t\tconst value = this.getParameterFirstValue('RSVP')\n\t\t\treturn uc(value) === 'TRUE'\n\t\t}\n\t}\n\n\t/**\n\t * Updates the \"Rpondez s'il vous plat\" value for attendee\n\t *\n\t * @param {boolean} rsvp Whether or not to send out an invitation\n\t */\n\tset rsvp(rsvp) {\n\t\tthis.updateParameterIfExist('RSVP', rsvp ? 'TRUE' : 'FALSE')\n\t}\n\n\t/**\n\t * Returns the common-name of the attendee\n\t *\n\t * @returns {string|null}\n\t */\n\tget commonName() {\n\t\treturn this.getParameterFirstValue('CN')\n\t}\n\n\t/**\n\t * Sets a new common-name of the attendee\n\t *\n\t * @param {string} commonName The display name of the attendee\n\t */\n\tset commonName(commonName) {\n\t\tthis.updateParameterIfExist('CN', commonName)\n\t}\n\n\t/**\n\t * Returns the participation-status of the attendee\n\t *\n\t * @returns {string}\n\t */\n\tget participationStatus() {\n\t\tlet vobjectType\n\t\tif (this.parent) {\n\t\t\tvobjectType = this.parent.name\n\t\t} else {\n\t\t\t// let's assume we are inside an event\n\t\t\t// if we don't know better\n\t\t\tvobjectType = 'VEVENT'\n\t\t}\n\n\t\tconst allowed = {\n\t\t\tVEVENT: ['NEEDS-ACTION', 'ACCEPTED', 'DECLINED', 'TENTATIVE', 'DELEGATED'],\n\t\t\tVJOURNAL: ['NEEDS-ACTION', 'ACCEPTED', 'DECLINED'],\n\t\t\tVTODO: ['NEEDS-ACTION', 'ACCEPTED', 'DECLINED', 'TENTATIVE', 'DELEGATED', 'COMPLETED', 'IN-PROCESS'],\n\t\t}\n\n\t\tif (!this.hasParameter('PARTSTAT')) {\n\t\t\treturn 'NEEDS-ACTION'\n\t\t} else {\n\t\t\tconst value = this.getParameterFirstValue('PARTSTAT')\n\t\t\tif (allowed[vobjectType].includes(value)) {\n\t\t\t\treturn value\n\t\t\t}\n\n\t\t\treturn 'NEEDS-ACTION'\n\t\t}\n\t}\n\n\t/**\n\t * Sets a new participation-status of the attendee\n\t *\n\t * @param {String} participationStatus The participation status (e.g. ACCEPTED, DECLINED)\n\t */\n\tset participationStatus(participationStatus) {\n\t\tthis.updateParameterIfExist('PARTSTAT', participationStatus)\n\t}\n\n\t/**\n\t * Gets this attendee's language\n\t *\n\t * @returns {String}\n\t */\n\tget language() {\n\t\treturn this.getParameterFirstValue('LANGUAGE')\n\t}\n\n\t/**\n\t * Sets this attendee's language\n\t * This can be used to influence the language of the invitation email\n\t *\n\t * @param {String} language The preferred language of the attendee\n\t */\n\tset language(language) {\n\t\tthis.updateParameterIfExist('LANGUAGE', language)\n\t}\n\n\t/**\n\t * Gets the email of the attendee\n\t *\n\t * @returns {String}\n\t */\n\tget email() {\n\t\treturn this.value\n\t}\n\n\t/**\n\t * Sets the email address of the attendee\n\t *\n\t * @param {String} email The e-email address of the attendee\n\t */\n\tset email(email) {\n\t\tthis.value = startStringWith(email, 'mailto:')\n\t}\n\n\t/**\n\t * Is this attendee the organizer?\n\t *\n\t * @returns {boolean}\n\t */\n\tisOrganizer() {\n\t\treturn this._name === 'ORGANIZER'\n\t}\n\n\t/**\n\t * Creates a new AttendeeProperty from name and email\n\t *\n\t * @param {String} name The display name\n\t * @param {String} email The email address\n\t * @param {Boolean=} isOrganizer Whether this is the organizer or an attendee\n\t * @returns {AttendeeProperty}\n\t */\n\tstatic fromNameAndEMail(name, email, isOrganizer = false) {\n\t\tconst propertyName = isOrganizer\n\t\t\t? 'ORGANIZER'\n\t\t\t: 'ATTENDEE'\n\n\t\temail = startStringWith(email, 'mailto:')\n\t\treturn new AttendeeProperty(propertyName, email, [['CN', name]])\n\t}\n\n\t/**\n\t * Creates a new AttendeeProperty from name, email, role, userType and rsvp\n\t *\n\t * @param {String} name The display name\n\t * @param {String} email The email address\n\t * @param {String} role The role\n\t * @param {String} userType The type of user\n\t * @param {Boolean} rsvp Whether to send out an invitation\n\t * @param {Boolean=} isOrganizer Whether this is the organizer or an attendee\n\t * @returns {AttendeeProperty}\n\t */\n\tstatic fromNameEMailRoleUserTypeAndRSVP(name, email, role, userType, rsvp, isOrganizer = false) {\n\t\tconst propertyName = isOrganizer\n\t\t\t? 'ORGANIZER'\n\t\t\t: 'ATTENDEE'\n\n\t\temail = startStringWith(email, 'mailto:')\n\t\treturn new AttendeeProperty(propertyName, email, [\n\t\t\t['CN', name],\n\t\t\t['ROLE', role],\n\t\t\t['CUTYPE', userType],\n\t\t\t['RSVP', rsvp ? 'TRUE' : 'FALSE'],\n\t\t])\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport Property from './property.js'\nimport ICAL from 'ical.js'\n\nICAL.design.icalendar.property.conference = {\n\tdefaultType: 'uri',\n}\n\nICAL.design.icalendar.param.feature = {\n\tvalueType: 'cal-address',\n\tmultiValue: ',',\n}\n\n/**\n * @class ConferenceProperty\n *\n * @url https://tools.ietf.org/html/rfc7986#section-5.11\n */\nexport default class ConferenceProperty extends Property {\n\n\t/**\n\t * Iterator that iterates over all supported features\n\t * of the conference system\n\t */\n\t* getFeatureIterator() {\n\t\tif (!this.hasParameter('FEATURE')) {\n\t\t\treturn\n\t\t}\n\n\t\tconst parameter = this.getParameter('FEATURE')\n\t\tyield * parameter.getValueIterator()\n\t}\n\n\t/**\n\t * Lists all supported features of the conference system\n\t *\n\t * @returns {String[]}\n\t */\n\tlistAllFeatures() {\n\t\tif (!this.hasParameter('FEATURE')) {\n\t\t\treturn []\n\t\t}\n\n\t\treturn this.getParameter('FEATURE').value.slice()\n\t}\n\n\t/**\n\t * Adds a supported feature to the conference system\n\t *\n\t * @param {String} featureToAdd Feature to add\n\t */\n\taddFeature(featureToAdd) {\n\t\tthis._modify()\n\t\tif (!this.hasParameter('FEATURE')) {\n\t\t\tthis.updateParameterIfExist('FEATURE', [featureToAdd])\n\t\t} else {\n\t\t\tif (this.hasFeature(featureToAdd)) {\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tconst parameter = this.getParameter('FEATURE')\n\t\t\tparameter.value.push(featureToAdd)\n\t\t}\n\t}\n\n\t/**\n\t * Removes a supported feature\n\t *\n\t * @param {String} feature The feature to remove\n\t */\n\tremoveFeature(feature) {\n\t\tthis._modify()\n\t\tif (!this.hasFeature(feature)) {\n\t\t\treturn\n\t\t}\n\n\t\tconst parameter = this.getParameter('FEATURE')\n\t\tconst index = parameter.value.indexOf(feature)\n\t\tparameter.value.splice(index, 1)\n\t}\n\n\t/**\n\t * Removes all supported features from this conference system\n\t */\n\tclearAllFeatures() {\n\t\tthis.deleteParameter('FEATURE')\n\t}\n\n\t/**\n\t * Check if this conference system supports a feature\n\t *\n\t * @param {String} feature The feature to check\n\t * @returns {boolean}\n\t */\n\thasFeature(feature) {\n\t\tif (!this.hasParameter('FEATURE')) {\n\t\t\treturn false\n\t\t}\n\n\t\tconst parameter = this.getParameter('FEATURE')\n\t\tif (!Array.isArray(parameter.value)) {\n\t\t\treturn false\n\t\t}\n\n\t\treturn parameter.value.includes(feature)\n\t}\n\n\t/**\n\t * Gets label for the conference system\n\t *\n\t * @returns {String}\n\t */\n\tget label() {\n\t\treturn this.getParameterFirstValue('LABEL')\n\t}\n\n\t/**\n\t * Updates the label for the conference system\n\t *\n\t * @param {String} label The label to set\n\t */\n\tset label(label) {\n\t\tthis.updateParameterIfExist('LABEL', label)\n\t}\n\n\t/**\n\t * Gets the uri for this conference system\n\t */\n\tget uri() {\n\t\treturn this.value\n\t}\n\n\t/**\n\t * Sets the uri for this conference system\n\t *\n\t * @param {String} uri The URI to set\n\t */\n\tset uri(uri) {\n\t\tthis.value = uri\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\ttoICALJs() {\n\t\tconst icalProperty = super.toICALJs()\n\t\ticalProperty.setParameter('value', 'URI')\n\n\t\treturn icalProperty\n\t}\n\n\t/**\n\t * Creates a new ConferenceProperty based on URI, label and features\n\t *\n\t * @param {String} uri URI of the Conference\n\t * @param {String=} label Label of the conference\n\t * @param {String[]=} features Features of the conference\n\t * @returns {ConferenceProperty}\n\t */\n\tstatic fromURILabelAndFeatures(uri, label = null, features = null) {\n\t\tconst property = new ConferenceProperty('CONFERENCE', uri)\n\n\t\tif (label) {\n\t\t\tproperty.updateParameterIfExist('label', label)\n\t\t}\n\n\t\tif (features) {\n\t\t\tproperty.updateParameterIfExist('feature', features)\n\t\t}\n\n\t\treturn property\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport Property from './property.js'\n\n/**\n * @class FreeBusyProperty\n * @classdesc\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.2.6\n */\nexport default class FreeBusyProperty extends Property {\n\n\t/**\n\t * Gets the type of this FreeBusyProperty\n\t *\n\t * @returns {String}\n\t */\n\tget type() {\n\t\tconst allowed = ['FREE', 'BUSY', 'BUSY-UNAVAILABLE', 'BUSY-TENTATIVE']\n\t\tconst defaultValue = 'BUSY'\n\n\t\tif (this.hasParameter('FBTYPE')) {\n\t\t\tconst value = this.getParameterFirstValue('FBTYPE')\n\t\t\tif (allowed.includes(value)) {\n\t\t\t\treturn value\n\t\t\t}\n\t\t}\n\n\t\treturn defaultValue\n\t}\n\n\t/**\n\t * Sets the type of this FreeBusyProperty\n\t *\n\t * @param {String} type The type of information (e.g. FREE, BUSY, etc.)\n\t */\n\tset type(type) {\n\t\tthis.updateParameterIfExist('FBTYPE', type)\n\t}\n\n\t/**\n\t * Creates a new FreeBusyProperty based on period and type\n\t *\n\t * @param {PeriodValue} period The period for FreeBusy Information\n\t * @param {String} type The type of the period\n\t * @returns {FreeBusyProperty}\n\t */\n\tstatic fromPeriodAndType(period, type) {\n\t\treturn new FreeBusyProperty('FREEBUSY', period, [['fbtype', type]])\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport Property from './property.js'\nimport { createProperty } from '../factories/icalFactory.js'\nimport { lc } from '../helpers/stringHelper.js'\n\n/**\n * @class GeoProperty\n * @classdesc\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.6\n */\nexport default class GeoProperty extends Property {\n\n\t/**\n\t * @inheritDoc\n\t */\n\tconstructor(name, value = [0, 0], parameters = [], root = null, parent = null) {\n\t\tsuper(name, value, parameters, root, parent)\n\t}\n\n\t/**\n\t * Gets the latitude stored in this property\n\t *\n\t * @returns {Number}\n\t */\n\tget latitude() {\n\t\treturn this._value[0]\n\t}\n\n\t/**\n\t * Sets the latitude stored in this property\n\t *\n\t * @param {String|Number} lat Latitude\n\t */\n\tset latitude(lat) {\n\t\tthis._modifyContent()\n\t\tif (typeof lat !== 'number') {\n\t\t\tlat = parseFloat(lat)\n\t\t}\n\n\t\tthis._value[0] = lat\n\t}\n\n\t/**\n\t * Gets the longitude stored in this property\n\t */\n\tget longitude() {\n\t\treturn this._value[1]\n\t}\n\n\t/**\n\t * Sets the longitude stored in this property\n\t *\n\t * @param {String|Number} long Longitude\n\t */\n\tset longitude(long) {\n\t\tthis._modifyContent()\n\t\tif (typeof long !== 'number') {\n\t\t\tlong = parseFloat(long)\n\t\t}\n\n\t\tthis._value[1] = long\n\t}\n\n\t/**\n\t * @inheritDoc\n\t *\n\t * TODO: this is an ugly hack right now.\n\t * As soon as the value is an array, we assume it's multivalue\n\t * but GEO is a (the one and only besides request-status) structured value and is also\n\t * stored inside an array.\n\t *\n\t * Calling icalProperty.setValues will throw an error\n\t */\n\ttoICALJs() {\n\t\tconst icalProperty = createProperty(lc(this.name))\n\t\ticalProperty.setValue(this.value)\n\n\t\tthis._parameters.forEach((parameter) => {\n\t\t\ticalProperty.setParameter(lc(parameter.name), parameter.value)\n\t\t})\n\n\t\treturn icalProperty\n\t}\n\n\t/**\n\t * Creates a new GeoProperty based on a latitude and a longitude value\n\t *\n\t * @param {Number} lat Latitude\n\t * @param {Number} long Longitude\n\t * @returns {GeoProperty}\n\t */\n\tstatic fromPosition(lat, long) {\n\t\treturn new GeoProperty('GEO', [lat, long])\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport AttachmentProperty from './attachmentProperty.js'\nimport BinaryValue from '../values/binaryValue.js'\n\n/**\n * @class ImageProperty\n *\n * @url https://tools.ietf.org/html/rfc7986#section-5.10\n */\nexport default class ImageProperty extends AttachmentProperty {\n\n\t/**\n\t * Gets the image-type\n\t */\n\tget display() {\n\t\treturn this.getParameterFirstValue('DISPLAY') || 'BADGE'\n\t}\n\n\t/**\n\t * Gets the image-type\n\t *\n\t * @param {String} display The display-type image is optimized for\n\t */\n\tset display(display) {\n\t\tthis.updateParameterIfExist('DISPLAY', display)\n\t}\n\n\t/**\n\t * Creates a new ImageProperty based on data\n\t *\n\t * @param {String} data The data of the image\n\t * @param {String=} display The display-type it's optimized for\n\t * @param {String=} formatType The mime-type of the image\n\t * @returns {ImageProperty}\n\t */\n\tstatic fromData(data, display = null, formatType = null) {\n\t\tconst binaryValue = BinaryValue.fromDecodedValue(data)\n\t\tconst property = new ImageProperty('IMAGE', binaryValue)\n\n\t\tif (display) {\n\t\t\tproperty.display = display\n\t\t}\n\n\t\tif (formatType) {\n\t\t\tproperty.formatType = formatType\n\t\t}\n\n\t\treturn property\n\t}\n\n\t/**\n\t * Creates a new ImageProperty based on a link\n\t *\n\t * @param {String} uri The uri of the image\n\t * @param {String=} display The display-type it's optimized for\n\t * @param {String=} formatType The mime-type of the image\n\t * @returns {ImageProperty}\n\t */\n\tstatic fromLink(uri, display = null, formatType = null) {\n\t\tconst property = new ImageProperty('IMAGE', uri)\n\n\t\tif (display) {\n\t\t\tproperty.display = display\n\t\t}\n\n\t\tif (formatType) {\n\t\t\tproperty.formatType = formatType\n\t\t}\n\n\t\treturn property\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport Property from './property.js'\n\n/**\n * @class RelationProperty\n * @classdesc\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.4.5\n */\nexport default class RelationProperty extends Property {\n\n\t/**\n\t * Get's the relation-type of this related-to property\n\t *\n\t * @returns {String}\n\t */\n\tget relationType() {\n\t\tconst allowed = ['PARENT', 'CHILD', 'SIBLING']\n\t\tconst defaultValue = 'PARENT'\n\n\t\tif (!this.hasParameter('RELTYPE')) {\n\t\t\treturn defaultValue\n\t\t} else {\n\t\t\tconst value = this.getParameterFirstValue('RELTYPE')\n\t\t\tif (allowed.includes(value)) {\n\t\t\t\treturn value\n\t\t\t}\n\n\t\t\treturn defaultValue\n\t\t}\n\t}\n\n\t/**\n\t * Sets a new relation type\n\t *\n\t * @param {String} relationType The type of relation (e.g. SIBLING, PARENT, etc.)\n\t */\n\tset relationType(relationType) {\n\t\tthis.updateParameterIfExist('RELTYPE', relationType)\n\t}\n\n\t/**\n\t * Gets Id of related object\n\t *\n\t * @returns {String}\n\t */\n\tget relatedId() {\n\t\treturn this.value\n\t}\n\n\t/**\n\t * Sets a new related id\n\t *\n\t * @param {String} relatedId The Id of the related document\n\t */\n\tset relatedId(relatedId) {\n\t\tthis.value = relatedId\n\t}\n\n\t/**\n\t * Creates a new RELATED-TO property based on a relation-type and id\n\t *\n\t * @param {String} relType The type of the relation (e.g. SIBLING, CHILD)\n\t * @param {String} relId The Id of the related document\n\t * @returns {RelationProperty}\n\t */\n\tstatic fromRelTypeAndId(relType, relId) {\n\t\treturn new RelationProperty('RELATED-TO', relId, [['RELTYPE', relType]])\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport Property from './property.js'\nimport { createProperty } from '../factories/icalFactory.js'\nimport { lc } from '../helpers/stringHelper.js'\n\n/**\n * @class RequestStatusProperty\n * @classdesc\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.8.3\n */\nexport default class RequestStatusProperty extends Property {\n\n\t/**\n\t * @inheritDoc\n\t */\n\tconstructor(name, value = ['1', 'Pending'], parameters = [], root = null, parent = null) {\n\t\tsuper(name, value, parameters, root, parent)\n\t}\n\n\t/**\n\t * Gets the status code of the request status\n\t *\n\t * @returns {Number}\n\t */\n\tget statusCode() {\n\t\treturn parseFloat(this.value[0])\n\t}\n\n\t/**\n\t * Sets the status code of the request status\n\t *\n\t * @param {Number} statusCode The statusCode of the request\n\t */\n\tset statusCode(statusCode) {\n\t\tthis._modifyContent()\n\n\t\tthis.value[0] = statusCode.toString()\n\n\t\t// This makes sure 2.0 is actually saved as 2.0, not 2\n\t\tif (statusCode === Math.floor(statusCode)) {\n\t\t\tthis.value[0] += '.0'\n\t\t}\n\t}\n\n\t/**\n\t * Gets the status message of the request status\n\t *\n\t * @returns {string}\n\t */\n\tget statusMessage() {\n\t\treturn this.value[1]\n\t}\n\n\t/**\n\t * Sets the status message of the request status\n\t *\n\t * @param {String} statusMessage The message of the request\n\t */\n\tset statusMessage(statusMessage) {\n\t\tthis._modifyContent()\n\t\tthis.value[1] = statusMessage\n\t}\n\n\t/**\n\t * Gets the exception data of the request status if available\n\t *\n\t * @returns {null|String}\n\t */\n\tget exceptionData() {\n\t\tif (!this.value[2]) {\n\t\t\treturn null\n\t\t}\n\n\t\treturn this.value[2]\n\t}\n\n\t/**\n\t * Sets the exception dtat of the request status\n\t *\n\t * @param {String} exceptionData The additional exception-data\n\t */\n\tset exceptionData(exceptionData) {\n\t\tthis._modifyContent()\n\t\tthis.value[2] = exceptionData\n\t}\n\n\t/**\n\t * Check if request is pending\n\t *\n\t * @returns {boolean}\n\t */\n\tisPending() {\n\t\treturn this.statusCode >= 1 && this.statusCode < 2\n\t}\n\n\t/**\n\t * Check if request was successful\n\t *\n\t * @returns {boolean}\n\t */\n\tisSuccessful() {\n\t\treturn this.statusCode >= 2 && this.statusCode < 3\n\t}\n\n\t/**\n\t * Check if a client error occurred\n\t *\n\t * @returns {boolean}\n\t */\n\tisClientError() {\n\t\treturn this.statusCode >= 3 && this.statusCode < 4\n\t}\n\n\t/**\n\t * Check if a scheduling error occurred\n\t *\n\t * @returns {boolean}\n\t */\n\tisSchedulingError() {\n\t\treturn this.statusCode >= 4 && this.statusCode < 5\n\t}\n\n\t/**\n\t * @inheritDoc\n\t *\n\t * TODO: this is an ugly hack right now.\n\t * As soon as the value is an array, we assume it's multivalue\n\t * but REQUEST-STATUS is a (the one and only besides GEO) structured value and is also\n\t * stored inside an array.\n\t *\n\t * Calling icalProperty.setValues will throw an error\n\t */\n\ttoICALJs() {\n\t\tconst icalProperty = createProperty(lc(this.name))\n\t\ticalProperty.setValue(this.value)\n\n\t\tthis._parameters.forEach((parameter) => {\n\t\t\ticalProperty.setParameter(lc(parameter.name), parameter.value)\n\t\t})\n\n\t\treturn icalProperty\n\t}\n\n\t/**\n\t * Creates a new RequestStatusProperty from a code and a status message\n\t *\n\t * @param {Number} code The status-code of the request\n\t * @param {String} message The message of the request\n\t * @returns {RequestStatusProperty}\n\t */\n\tstatic fromCodeAndMessage(code, message) {\n\t\treturn new RequestStatusProperty('REQUEST-STATUS', [code.toString(), message])\n\t}\n\n}\n\n// All request statuses registered in RFC 5546\nRequestStatusProperty.SUCCESS = [2.0, 'Success']\nRequestStatusProperty.SUCCESS_FALLBACK = [2.1, 'Success, but fallback taken on one or more property values.']\nRequestStatusProperty.SUCCESS_PROP_IGNORED = [2.2, 'Success; invalid property ignored.']\nRequestStatusProperty.SUCCESS_PROPPARAM_IGNORED = [2.3, 'Success; invalid property parameter ignored.']\nRequestStatusProperty.SUCCESS_NONSTANDARD_PROP_IGNORED = [2.4, 'Success; unknown, non-standard property ignored.']\nRequestStatusProperty.SUCCESS_NONSTANDARD_PROPPARAM_IGNORED = [2.5, 'Success; unknown, non-standard property value ignored.']\nRequestStatusProperty.SUCCESS_COMP_IGNORED = [2.6, 'Success; invalid calendar component ignored.']\nRequestStatusProperty.SUCCESS_FORWARDED = [2.7, 'Success; request forwarded to Calendar User.']\nRequestStatusProperty.SUCCESS_REPEATING_IGNORED = [2.8, 'Success; repeating event ignored. Scheduled as a single component.']\nRequestStatusProperty.SUCCESS_TRUNCATED_END = [2.9, 'Success; truncated end date time to date boundary.']\nRequestStatusProperty.SUCCESS_REPEATING_VTODO_IGNORED = [2.10, 'Success; repeating VTODO ignored.  Scheduled as a single VTODO.']\nRequestStatusProperty.SUCCESS_UNBOUND_RRULE_CLIPPED = [2.11, 'Success; unbounded RRULE clipped at some finite number of instances.']\n\nRequestStatusProperty.CLIENT_INVALID_PROPNAME = [3.0, 'Invalid property name.']\nRequestStatusProperty.CLIENT_INVALID_PROPVALUE = [3.1, 'Invalid property value.']\nRequestStatusProperty.CLIENT_INVALID_PROPPARAM = [3.2, 'Invalid property parameter.']\nRequestStatusProperty.CLIENT_INVALID_PROPPARAMVALUE = [3.3, 'Invalid property parameter value.']\nRequestStatusProperty.CLIENT_INVALUD_CALENDAR_COMP_SEQ = [3.4, 'Invalid calendar component sequence.']\nRequestStatusProperty.CLIENT_INVALID_DATE_TIME = [3.5, 'Invalid date or time.']\nRequestStatusProperty.CLIENT_INVALID_RRULE = [3.6, 'Invalid rule.']\nRequestStatusProperty.CLIENT_INVALID_CU = [3.7, 'Invalid Calendar User.']\nRequestStatusProperty.CLIENT_NO_AUTHORITY = [3.8, 'No authority.']\nRequestStatusProperty.CLIENT_UNSUPPORTED_VERSION = [3.9, 'Unsupported version.']\nRequestStatusProperty.CLIENT_TOO_LARGE = [3.10, 'Request entity too large.']\nRequestStatusProperty.CLIENT_REQUIRED_COMP_OR_PROP_MISSING = [3.11, 'Required component or property missing.']\nRequestStatusProperty.CLIENT_UNKNOWN_COMP_OR_PROP = [3.12, 'Unknown component or property found.']\nRequestStatusProperty.CLIENT_UNSUPPORTED_COMP_OR_PROP = [3.13, 'Unsupported component or property found.']\nRequestStatusProperty.CLIENT_UNSUPPORTED_CAPABILITY = [3.14, 'Unsupported capability.']\n\nRequestStatusProperty.SCHEDULING_EVENT_CONFLICT = [4.0, 'Event conflict.  Date/time is busy.']\n\nRequestStatusProperty.SERVER_REQUEST_NOT_SUPPORTED = [5.0, 'Request not supported.']\nRequestStatusProperty.SERVER_SERVICE_UNAVAILABLE = [5.1, 'Service unavailable.']\nRequestStatusProperty.SERVER_INVALID_CALENDAR_SERVICE = [5.2, 'Invalid calendar service.']\nRequestStatusProperty.SERVER_NO_SCHEDULING_FOR_USER = [5.3, 'No scheduling support for user.']\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport Property from './property.js'\n\n/**\n * @class TextProperty\n * @classdesc\n */\nexport default class TextProperty extends Property {\n\n\t/**\n\t * Gets the alternate text\n\t *\n\t * @returns {String}\n\t */\n\tget alternateText() {\n\t\treturn this.getParameterFirstValue('ALTREP')\n\t}\n\n\t/**\n\t * Sets the alternate text\n\t *\n\t * @param {String} altRep The alternative text\n\t */\n\tset alternateText(altRep) {\n\t\tthis.updateParameterIfExist('ALTREP', altRep)\n\t}\n\n\t/**\n\t * Gets language of this property\n\t *\n\t * @returns {String}\n\t */\n\tget language() {\n\t\treturn this.getParameterFirstValue('LANGUAGE')\n\t}\n\n\t/**\n\t * Sets language of this property\n\t *\n\t * @param {String} language The language of the text\n\t */\n\tset language(language) {\n\t\tthis.updateParameterIfExist('LANGUAGE', language)\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport Property from './property.js'\nimport DurationValue from '../values/durationValue.js'\nimport DateTimeValue from '../values/dateTimeValue.js'\n\n/**\n * @class TriggerProperty\n * @classdesc\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.6.3\n */\nexport default class TriggerProperty extends Property {\n\n\t/**\n\t * Gets the related parameter\n\t *\n\t * @returns {String}\n\t */\n\tget related() {\n\t\tif (!this.hasParameter('RELATED')) {\n\t\t\treturn 'START'\n\t\t}\n\n\t\treturn this.getParameterFirstValue('RELATED')\n\t}\n\n\t/**\n\t * Sets the related parameter\n\t *\n\t * @param {String} related Either START or END\n\t */\n\tset related(related) {\n\t\tthis.updateParameterIfExist('RELATED', related)\n\t}\n\n\t/**\n\t * Gets the value of this trigger\n\t * (If you override the setter, you also have to override the getter or\n\t *  it will simply be undefined)\n\t *\n\t * @returns {String|Number|AbstractValue|String[]|Number[]|AbstractValue[]}\n\t */\n\tget value() {\n\t\treturn super.value\n\t}\n\n\t/**\n\t * Set the value of this trigger\n\t *\n\t * @param {DurationValue|DateTimeValue} value The time of trigger\n\t */\n\tset value(value) {\n\t\tsuper.value = value\n\n\t\t// If it's not a duration, remove related parameter\n\t\tif (value instanceof DateTimeValue) {\n\t\t\tthis.deleteParameter('RELATED')\n\t\t\tsuper.value = value.getInUTC()\n\t\t}\n\t}\n\n\t/**\n\t * Gets whether this alarm trigger is relative\n\t *\n\t * @returns {boolean}\n\t */\n\tisRelative() {\n\t\treturn this.getFirstValue() instanceof DurationValue\n\t}\n\n\t/**\n\t * Creates a new absolute trigger\n\t *\n\t * @param {DateTimeValue} alarmTime Time to create Trigger from\n\t * @returns {TriggerProperty}\n\t */\n\tstatic fromAbsolute(alarmTime) {\n\t\treturn new TriggerProperty('TRIGGER', alarmTime)\n\t}\n\n\t/**\n\t * Creates a new relative trigger\n\t *\n\t * @param {DurationValue} alarmOffset Duration to create Trigger from\n\t * @param {Boolean=} relatedToStart Related to Start or end?\n\t * @returns {TriggerProperty}\n\t */\n\tstatic fromRelativeAndRelated(alarmOffset, relatedToStart = true) {\n\t\treturn new TriggerProperty('TRIGGER', alarmOffset, [['RELATED', relatedToStart ? 'START' : 'END']])\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @author Richard Steinmetz <richard@steinmetz.cloud>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport AttachmentProperty from './attachmentProperty.js'\nimport AttendeeProperty from './attendeeProperty.js'\nimport ConferenceProperty from './conferenceProperty.js'\nimport FreeBusyProperty from './freeBusyProperty.js'\nimport GeoProperty from './geoProperty.js'\nimport ImageProperty from './imageProperty.js'\nimport RelationProperty from './relationProperty.js'\nimport RequestStatusProperty from './requestStatusProperty.js'\nimport TextProperty from './textProperty.js'\nimport TriggerProperty from './triggerProperty.js'\nimport Property from './property.js'\nimport { uc } from '../helpers/stringHelper.js'\n\n/**\n *\n * @param {String} propName Name of the prop to get constructor for\n * @returns {AttendeeProperty|GeoProperty|ConferenceProperty|Property|AttachmentProperty|ImageProperty|RelationProperty|RequestStatusProperty}\n */\nexport function getConstructorForPropertyName(propName) {\n\tswitch (uc(propName)) {\n\tcase 'ATTACH':\n\t\treturn AttachmentProperty\n\n\tcase 'ATTENDEE':\n\tcase 'ORGANIZER':\n\t\treturn AttendeeProperty\n\n\tcase 'CONFERENCE':\n\t\treturn ConferenceProperty\n\n\tcase 'FREEBUSY':\n\t\treturn FreeBusyProperty\n\n\tcase 'GEO':\n\t\treturn GeoProperty\n\n\tcase 'IMAGE':\n\t\treturn ImageProperty\n\n\tcase 'RELATED-TO':\n\t\treturn RelationProperty\n\n\tcase 'REQUEST-STATUS':\n\t\treturn RequestStatusProperty\n\n\tcase 'TRIGGER':\n\t\treturn TriggerProperty\n\n\tcase 'COMMENT':\n\tcase 'CONTACT':\n\tcase 'DESCRIPTION':\n\tcase 'LOCATION':\n\tcase 'SUMMARY':\n\t\treturn TextProperty\n\n\tdefault:\n\t\treturn Property\n\t}\n}\n\nexport {\n\tAttachmentProperty,\n\tAttendeeProperty,\n\tConferenceProperty,\n\tFreeBusyProperty,\n\tGeoProperty,\n\tImageProperty,\n\tProperty,\n\tRelationProperty,\n\tRequestStatusProperty,\n\tTextProperty,\n\tTriggerProperty,\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport lockableTrait from '../traits/lockable.js'\nimport ExpectedICalJSError from '../errors/expectedICalJSError.js'\nimport { lc, uc, ucFirst } from '../helpers/stringHelper.js'\nimport { createComponent } from '../factories/icalFactory.js'\nimport { getConstructorForPropertyName } from '../properties'\nimport Property from '../properties/property.js'\nimport Parameter from '../parameters/parameter.js'\nimport observerTrait from '../traits/observer.js'\nimport ICAL from 'ical.js'\n\n/**\n * @class AbstractComponent\n */\nexport default class AbstractComponent extends observerTrait(lockableTrait(class {})) {\n\n\t/**\n\t * Constructor\n\t *\n\t * @param {String} name - Name of component\n\t * @param {Property[]} properties - Array of properties stored inside the component\n\t * @param {AbstractComponent[]} components - Array of subcomponents stored inside this component\n\t * @param {CalendarComponent|null} root - The root of this calendar document\n\t * @param {AbstractComponent|null} parent - The parent component of this element\n\t */\n\tconstructor(name, properties = [], components = [], root = null, parent = null) {\n\t\tsuper()\n\n\t\t/**\n\t\t * Name of component\n\t\t *\n\t\t * @type {String}\n\t\t * @private\n\t\t */\n\t\tthis._name = uc(name)\n\n\t\t/**\n\t\t * All properties in this component\n\t\t *\n\t\t * @type {Map<String, Property[]>}\n\t\t * @private\n\t\t */\n\t\tthis._properties = new Map()\n\n\t\t/**\n\t\t * All subcomponents of this component\n\t\t *\n\t\t * @type {Map<String, AbstractComponent[]>}\n\t\t * @private\n\t\t */\n\t\tthis._components = new Map()\n\n\t\t/**\n\t\t * Root node of ical document\n\t\t *\n\t\t * @type {CalendarComponent|null}\n\t\t * @private\n\t\t */\n\t\tthis._root = root\n\n\t\t/**\n\t\t * Parent node\n\t\t *\n\t\t * @type {AbstractComponent|null}\n\t\t * @private\n\t\t */\n\t\tthis._parent = parent\n\n\t\tthis._setPropertiesFromConstructor(properties)\n\t\tthis._setComponentsFromConstructor(components)\n\t}\n\n\t/**\n\t * Get the component's name\n\t *\n\t * @returns {String}\n\t */\n\tget name() {\n\t\treturn this._name\n\t}\n\n\t/**\n\t * Gets the root of this calendar-document\n\t *\n\t * @returns {CalendarComponent}\n\t */\n\tget root() {\n\t\treturn this._root\n\t}\n\n\t/**\n\t * Sets the root of this calendar-document\n\t *\n\t * @param {CalendarComponent} root The new root element\n\t */\n\tset root(root) {\n\t\tthis._modify()\n\t\tthis._root = root\n\n\t\tfor (const property of this.getPropertyIterator()) {\n\t\t\tproperty.root = root\n\t\t}\n\n\t\tfor (const component of this.getComponentIterator()) {\n\t\t\tcomponent.root = root\n\t\t}\n\n\t}\n\n\t/**\n\t * Gets the parent component\n\t *\n\t * @returns {AbstractComponent}\n\t */\n\tget parent() {\n\t\treturn this._parent\n\t}\n\n\t/**\n\t * Sets the parent component\n\t *\n\t * @param {AbstractComponent} parent The new parent element\n\t */\n\tset parent(parent) {\n\t\tthis._modify()\n\t\tthis._parent = parent\n\t}\n\n\t/**\n\t * Gets the first property that matches the given propertyName\n\t *\n\t * @param {String} propertyName Name of the property to get\n\t * @returns {Property|null}\n\t */\n\tgetFirstProperty(propertyName) {\n\t\tif (!this._properties.has(uc(propertyName))) {\n\t\t\treturn null\n\t\t}\n\n\t\treturn this._properties.get(uc(propertyName))[0]\n\t}\n\n\t/**\n\t * Gets the first value of the first property matching that name\n\t *\n\t * @param {String} propertyName Name of the property to get first value of\n\t * @returns {String|Number|AbstractValue|String[]|Number[]|AbstractValue[]|null}\n\t */\n\tgetFirstPropertyFirstValue(propertyName) {\n\t\tconst property = this.getFirstProperty(propertyName)\n\t\tif (!property) {\n\t\t\treturn null\n\t\t}\n\n\t\treturn property.getFirstValue()\n\t}\n\n\t/**\n\t * update a property if it exists,\n\t * create a new one if it doesn't\n\t *\n\t * @param {String} propertyName Name of the property to update / create\n\t * @param {String|Number|AbstractValue|String[]|Number[]|AbstractValue[]|null} value The value to set\n\t */\n\tupdatePropertyWithValue(propertyName, value) {\n\t\tthis._modify()\n\t\tconst property = this.getFirstProperty(propertyName)\n\t\tif (property) {\n\t\t\tproperty.value = value\n\t\t} else {\n\t\t\tconst constructor = getConstructorForPropertyName(propertyName)\n\t\t\tconst newProperty = new constructor(propertyName, value, [], this, this.root)\n\t\t\tthis.addProperty(newProperty)\n\t\t}\n\t}\n\n\t/**\n\t * Returns iterator for all properties of a given propertyName\n\t * or if no propertyName was given over all available properties\n\t *\n\t * @param {String=} propertyName Name of the property to get an iterator for\n\t */\n\t* getPropertyIterator(propertyName = null) {\n\t\tif (propertyName) {\n\t\t\tif (!this.hasProperty(propertyName)) {\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\t// this._properties.get() returns an array\n\t\t\t// [Symbol.iterator]() creates an iterator from that array\n\t\t\tyield * this._properties.get(uc(propertyName)).slice()[Symbol.iterator]()\n\t\t} else {\n\t\t\tfor (const key of this._properties.keys()) {\n\t\t\t\tyield * this.getPropertyIterator(key)\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Get all properties by name that match the given LANG parameter\n\t *\n\t * @param {String} propertyName The name of the property\n\t * @param {String|null} lang The lang to query\n\t * @private\n\t */\n\t* _getAllOfPropertyByLang(propertyName, lang) {\n\t\tfor (const property of this.getPropertyIterator(propertyName)) {\n\t\t\t// getParameterFirstValue will return null if language not set, so no language parameter will match lang=null\n\t\t\tif (property.getParameterFirstValue('LANGUAGE') === lang) {\n\t\t\t\tyield property\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Get the first property by name that matches the given LANG parameter\n\t *\n\t * @param {String} propertyName The name of the property\n\t * @param {String|null} lang The lang to query\n\t * @returns {Property|null}\n\t * @private\n\t */\n\t_getFirstOfPropertyByLang(propertyName, lang) {\n\t\tconst iterator = this._getAllOfPropertyByLang(propertyName, lang)\n\t\treturn iterator.next().value || null\n\t}\n\n\t/**\n\t * Adds a property\n\t *\n\t * @param {Property} property The property to add\n\t * @returns {boolean}\n\t */\n\taddProperty(property) {\n\t\tthis._modify()\n\n\t\tproperty.root = this.root\n\t\tproperty.parent = this\n\n\t\tif (this._properties.has(property.name)) {\n\t\t\tconst arr = this._properties.get(property.name)\n\t\t\tif (arr.indexOf(property) !== -1) {\n\t\t\t\t// If the property is already part of this component,\n\t\t\t\t// return false to indicate an error\n\t\t\t\treturn false\n\t\t\t}\n\n\t\t\tarr.push(property)\n\t\t} else {\n\t\t\tthis._properties.set(property.name, [property])\n\t\t}\n\n\t\tproperty.subscribe(() => this._notifySubscribers())\n\n\t\treturn true\n\t}\n\n\t/**\n\t * Checks if this component has a property of the given name\n\t *\n\t * @param {String} propertyName The name of the property\n\t * @returns {boolean}\n\t */\n\thasProperty(propertyName) {\n\t\treturn this._properties.has(uc(propertyName))\n\t}\n\n\t/**\n\t * Removes the given property from this component\n\t *\n\t * @param {Property} property The property to delete\n\t * @returns {boolean}\n\t */\n\tdeleteProperty(property) {\n\t\tthis._modify()\n\t\tif (!this._properties.has(property.name)) {\n\t\t\treturn false\n\t\t}\n\n\t\tconst arr = this._properties.get(property.name)\n\t\tconst index = arr.indexOf(property)\n\t\tif (index === -1) {\n\t\t\treturn false\n\t\t}\n\n\t\tif (index !== -1 && arr.length === 1) {\n\t\t\t// If this is the last property of the given name,\n\t\t\t// remove the entire array from _properties\n\t\t\t// This is required for hasProperty to work properly\n\t\t\tthis._properties.delete(property.name)\n\t\t} else {\n\t\t\tarr.splice(index, 1)\n\t\t}\n\n\t\treturn true\n\t}\n\n\t/**\n\t * Removes all properties of a given name\n\t *\n\t * @param {String} propertyName The name of the property\n\t * @returns {boolean}\n\t */\n\tdeleteAllProperties(propertyName) {\n\t\tthis._modify()\n\t\treturn this._properties.delete(uc(propertyName))\n\t}\n\n\t/**\n\t * Gets the first component of a given name\n\t *\n\t * @param {String} componentName The name of the component\n\t * @returns {AbstractComponent|null}\n\t */\n\tgetFirstComponent(componentName) {\n\t\tif (!this.hasComponent(componentName)) {\n\t\t\treturn null\n\t\t}\n\n\t\treturn this._components.get(uc(componentName))[0]\n\t}\n\n\t/**\n\t * Returns iterator for all components of a given componentName\n\t * or if no componentName was given over all available components\n\t *\n\t * @param {String=} componentName The name of the component\n\t */\n\t* getComponentIterator(componentName) {\n\t\tif (componentName) {\n\t\t\tif (!this.hasComponent(componentName)) {\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\t// this._components.get() returns an array\n\t\t\t// [Symbol.iterator]() creates an iterator from that array\n\t\t\tyield * this._components.get(uc(componentName)).slice()[Symbol.iterator]()\n\t\t} else {\n\t\t\tfor (const key of this._components.keys()) {\n\t\t\t\tyield * this.getComponentIterator(key)\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Adds a new component to this component\n\t *\n\t * @param {AbstractComponent} component The component to add\n\t * @returns {Boolean}\n\t */\n\taddComponent(component) {\n\t\tthis._modify()\n\n\t\tcomponent.root = this.root\n\t\tcomponent.parent = this\n\n\t\tif (this._components.has(component.name)) {\n\t\t\tconst arr = this._components.get(component.name)\n\t\t\tif (arr.indexOf(component) !== -1) {\n\t\t\t\t// If the property is already part of this component,\n\t\t\t\t// return false to indicate an error\n\t\t\t\treturn false\n\t\t\t}\n\n\t\t\tarr.push(component)\n\t\t} else {\n\t\t\tthis._components.set(component.name, [component])\n\t\t}\n\n\t\tcomponent.subscribe(() => this._notifySubscribers())\n\n\t\treturn true\n\t}\n\n\t/**\n\t * Checks if this component has a component of the given name\n\t *\n\t * @param {String} componentName The name of the component\n\t * @returns {boolean}\n\t */\n\thasComponent(componentName) {\n\t\treturn this._components.has(uc(componentName))\n\t}\n\n\t/**\n\t * Removes the given component from this component\n\t *\n\t * @param {AbstractComponent} component The component to delete\n\t * @returns {boolean}\n\t */\n\tdeleteComponent(component) {\n\t\tthis._modify()\n\t\tif (!this._components.has(component.name)) {\n\t\t\treturn false\n\t\t}\n\n\t\tconst arr = this._components.get(component.name)\n\t\tconst index = arr.indexOf(component)\n\t\tif (index === -1) {\n\t\t\treturn false\n\t\t}\n\n\t\tif (index !== -1 && arr.length === 1) {\n\t\t\t// If this is the last component of the given name,\n\t\t\t// remove the entire array from _components\n\t\t\t// This is required for hasComponent to work properly\n\t\t\tthis._components.delete(component.name)\n\t\t} else {\n\t\t\tarr.splice(index, 1)\n\t\t}\n\n\t\treturn true\n\t}\n\n\t/**\n\t * Removes all components of a given name\n\t *\n\t * @param {String} componentName The name of the component\n\t * @returns {boolean}\n\t */\n\tdeleteAllComponents(componentName) {\n\t\tthis._modify()\n\t\treturn this._components.delete(uc(componentName))\n\t}\n\n\t/**\n\t * Marks this parameter is immutable\n\t * locks it against further modification\n\t */\n\tlock() {\n\t\tsuper.lock()\n\n\t\tfor (const property of this.getPropertyIterator()) {\n\t\t\tproperty.lock()\n\t\t}\n\n\t\tfor (const component of this.getComponentIterator()) {\n\t\t\tcomponent.lock()\n\t\t}\n\t}\n\n\t/**\n\t * Marks this parameter as mutable\n\t * allowing further modification\n\t */\n\tunlock() {\n\t\tsuper.unlock()\n\n\t\tfor (const property of this.getPropertyIterator()) {\n\t\t\tproperty.unlock()\n\t\t}\n\n\t\tfor (const component of this.getComponentIterator()) {\n\t\t\tcomponent.unlock()\n\t\t}\n\t}\n\n\t/**\n\t * Creates a copy of this parameter\n\t *\n\t * @returns {AbstractComponent}\n\t */\n\tclone() {\n\t\tconst properties = []\n\t\tfor (const property of this.getPropertyIterator()) {\n\t\t\tproperties.push(property.clone())\n\t\t}\n\n\t\tconst components = []\n\t\tfor (const component of this.getComponentIterator()) {\n\t\t\tcomponents.push(component.clone())\n\t\t}\n\n\t\treturn new this.constructor(this.name, properties, components, this.root, this.parent)\n\t}\n\n\t/**\n\t * Adds properties from constructor to this._properties\n\t *\n\t * @param {Property[]} properties Array of properties\n\t * @private\n\t */\n\t_setPropertiesFromConstructor(properties) {\n\t\tfor (let property of properties) {\n\t\t\tif (Array.isArray(property)) {\n\t\t\t\tconst constructor = getConstructorForPropertyName(property[0])\n\t\t\t\tproperty = new constructor(property[0], property[1])\n\t\t\t}\n\n\t\t\tthis.addProperty(property)\n\t\t}\n\t}\n\n\t/**\n\t * Adds components from constructor to this._components\n\t *\n\t * @param {AbstractComponent[]} components Array of components\n\t * @private\n\t */\n\t_setComponentsFromConstructor(components) {\n\t\tfor (const component of components) {\n\t\t\tthis.addComponent(component)\n\t\t}\n\t}\n\n\t/**\n\t * Creates a new Component based on an ical object\n\t *\n\t * @param {ICAL.Component} icalValue The ical.js component to initialise from\n\t * @param {CalendarComponent=} root The root of the Calendar Document\n\t * @param {AbstractComponent=} parent The parent element of this component\n\t * @returns {AbstractComponent}\n\t */\n\tstatic fromICALJs(icalValue, root = null, parent = null) {\n\t\tif (!(icalValue instanceof ICAL.Component)) {\n\t\t\tthrow new ExpectedICalJSError()\n\t\t}\n\n\t\tconst name = icalValue.name\n\t\tconst newComponent = new this(name, [], [], root, parent)\n\n\t\tfor (const icalProp of icalValue.getAllProperties()) {\n\t\t\tconst constructor = getConstructorForPropertyName(icalProp.name)\n\t\t\tconst property = constructor.fromICALJs(icalProp, root, newComponent)\n\t\t\tnewComponent.addProperty(property)\n\t\t}\n\n\t\tfor (const icalComp of icalValue.getAllSubcomponents()) {\n\t\t\tconst constructor = this._getConstructorForComponentName(icalComp.name)\n\t\t\tconst component = constructor.fromICALJs(icalComp, root, newComponent)\n\t\t\tnewComponent.addComponent(component)\n\t\t}\n\n\t\treturn newComponent\n\t}\n\n\t/**\n\t * Gets a constructor for a give component name\n\t *\n\t * @param {String} componentName The name of the component\n\t * @returns {AbstractComponent}\n\t * @protected\n\t */\n\tstatic _getConstructorForComponentName(componentName) {\n\t\treturn AbstractComponent\n\t}\n\n\t/**\n\t * turns this Component into an ICAL.js component\n\t *\n\t * @returns {ICAL.Component}\n\t */\n\ttoICALJs() {\n\t\tconst component = createComponent(lc(this.name))\n\n\t\tfor (const prop of this.getPropertyIterator()) {\n\t\t\tcomponent.addProperty(prop.toICALJs())\n\t\t}\n\t\tfor (const comp of this.getComponentIterator()) {\n\t\t\tcomponent.addSubcomponent(comp.toICALJs())\n\t\t}\n\n\t\treturn component\n\t}\n\n}\n\n/**\n * Advertise properties that may at most occur once\n *\n * Properties, which may at most occur once, get a simple getter and setter\n *\n * @param {Object} prototype The object's prototype\n * @param {Object} options The options for advertising properties\n * @param {Boolean} advertiseValueOnly Whether to advertise the value only or the entire property\n */\nexport function advertiseSingleOccurrenceProperty(prototype, options, advertiseValueOnly = true) {\n\toptions = getDefaultOncePropConfig(options)\n\n\tObject.defineProperty(prototype, options.name, {\n\t\tget() {\n\t\t\tconst value = this.getFirstPropertyFirstValue(options.iCalendarName)\n\n\t\t\tif (!value) {\n\t\t\t\treturn options.defaultValue\n\t\t\t} else {\n\t\t\t\tif (Array.isArray(options.allowedValues) && !options.allowedValues.includes(value)) {\n\t\t\t\t\treturn options.unknownValue\n\t\t\t\t}\n\n\t\t\t\treturn value\n\t\t\t}\n\t\t},\n\t\tset(value) {\n\t\t\tthis._modify()\n\n\t\t\tif (value === null) {\n\t\t\t\tthis.deleteAllProperties(options.iCalendarName)\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tif (Array.isArray(options.allowedValues) && !options.allowedValues.includes(value)) {\n\t\t\t\tthrow new TypeError('Illegal value')\n\t\t\t}\n\t\t\tthis.updatePropertyWithValue(options.iCalendarName, value)\n\t\t},\n\t})\n}\n\n/**\n * Advertise properties that may occur more than once\n *\n * Properties, which may occur more than once, won't get simple getter / setter,\n * but rather a more advanced set of get{name}Iterator, get{name}List, add{name},\n * remove{name} and clearAll{name} methods\n *\n * @param {Object} prototype The object's prototype\n * @param {Object} options The options for advertising properties\n */\nexport function advertiseMultipleOccurrenceProperty(prototype, options) {\n\toptions = getDefaultMultiplePropConfig(options)\n\n\tprototype['get' + ucFirst(options.name) + 'Iterator'] = function * () {\n\t\tyield * this.getPropertyIterator(options.iCalendarName)\n\t}\n\n\tprototype['get' + ucFirst(options.name) + 'List'] = function() {\n\t\treturn Array.from(this['get' + ucFirst(options.name) + 'Iterator']())\n\t}\n\n\tprototype['remove' + ucFirst(options.name)] = function(property) {\n\t\tthis.deleteProperty(property)\n\t}\n\n\tprototype['clearAll' + ucFirst(options.pluralName)] = function() {\n\t\tthis.deleteAllProperties(options.iCalendarName)\n\t}\n}\n\n/**\n * advertises a multi-value string property enabling simple access by language\n * This is used for:\n * - CATEGORIES\n * - RESOURCES\n *\n * @param {Object} prototype The object's prototype\n * @param {Object} options The options for advertising properties\n */\nexport function advertiseMultiValueStringPropertySeparatedByLang(prototype, options) {\n\toptions = getDefaultMultiplePropConfig(options)\n\n\tprototype['get' + ucFirst(options.name) + 'Iterator'] = function * (lang = null) {\n\t\tfor (const property of this._getAllOfPropertyByLang(options.iCalendarName, lang)) {\n\t\t\tyield * property.getValueIterator()\n\t\t}\n\t}\n\n\tprototype['get' + ucFirst(options.name) + 'List'] = function(lang = null) {\n\t\treturn Array.from(this['get' + ucFirst(options.name) + 'Iterator'](lang))\n\t}\n\n\tprototype['add' + ucFirst(options.name)] = function(value, lang = null) {\n\t\tconst property = this._getFirstOfPropertyByLang(options.iCalendarName, lang)\n\t\tif (property) {\n\t\t\tproperty.addValue(value)\n\t\t} else {\n\t\t\tconst newProperty = new Property(options.iCalendarName, [value])\n\t\t\tif (lang) {\n\t\t\t\tconst languageParameter = new Parameter('LANGUAGE', lang)\n\t\t\t\tnewProperty.setParameter(languageParameter)\n\t\t\t}\n\n\t\t\tthis.addProperty(newProperty)\n\t\t}\n\t}\n\n\tprototype['remove' + ucFirst(options.name)] = function(value, lang = null) {\n\t\tfor (const property of this._getAllOfPropertyByLang(options.iCalendarName, lang)) {\n\t\t\tif (property.isMultiValue() && property.hasValue(value)) {\n\t\t\t\tif (property.value.length === 1) {\n\t\t\t\t\tthis.deleteProperty(property)\n\t\t\t\t\treturn true\n\t\t\t\t}\n\n\t\t\t\tproperty.removeValue(value)\n\t\t\t\treturn true\n\t\t\t}\n\t\t}\n\n\t\treturn false\n\t}\n\n\tprototype['clearAll' + ucFirst(options.pluralName)] = function(lang = null) {\n\t\tfor (const property of this._getAllOfPropertyByLang(options.iCalendarName, lang)) {\n\t\t\tthis.deleteProperty(property)\n\t\t}\n\t}\n}\n\n/**\n * advertise a component\n *\n * @param {Object} prototype The object's prototype\n * @param {Object} options The options for advertising components\n */\nexport function advertiseComponent(prototype, options) {\n\toptions = getDefaultMultipleCompConfig(options)\n\n\tprototype['get' + ucFirst(options.name) + 'Iterator'] = function * () {\n\t\tyield * this.getComponentIterator(options.iCalendarName)\n\t}\n\n\tprototype['get' + ucFirst(options.name) + 'List'] = function() {\n\t\treturn Array.from(this['get' + ucFirst(options.name) + 'Iterator']())\n\t}\n\n\tprototype['remove' + ucFirst(options.name)] = function(component) {\n\t\tthis.deleteComponent(component)\n\t}\n\n\tprototype['clearAll' + ucFirst(options.pluralName)] = function() {\n\t\tthis.deleteAllComponents(options.iCalendarName)\n\t}\n}\n\n/**\n * Fill up the options object for advertiseProperty\n *\n * @param {Object|String} options The options object\n * @param {String} options.name Advertised name of the property\n * @param {String=} options.iCalendarName The iCalendar name of the property\n * @param {String[]=} options.allowedValues A list of allowed values\n * @param {String|Number=} options.defaultValue The default value if unset\n * @param {String|Number=} options.unknownValue The fallback value if unknown value\n * @returns {Object}\n */\nfunction getDefaultOncePropConfig(options) {\n\tif (typeof options === 'string') {\n\t\toptions = {\n\t\t\tname: options,\n\t\t}\n\t}\n\n\treturn Object.assign({}, {\n\t\tiCalendarName: uc(options.name),\n\t\tpluralName: options.name + 's',\n\t\tallowedValues: null,\n\t\tdefaultValue: null,\n\t\tunknownValue: null,\n\t}, options)\n}\n\n/**\n * Fill up the options object for advertiseProperty\n *\n * @param {Object|String} options The options object\n * @param {String} options.name Advertised name of property\n * @param {String=} options.iCalendarName The iCalendar name of the property\n * @param {Boolean=} options.customAddMethod Whether or not to use a custom add method\n * @returns {Object}\n */\nfunction getDefaultMultiplePropConfig(options) {\n\tif (typeof options === 'string') {\n\t\toptions = {\n\t\t\tname: options,\n\t\t}\n\t}\n\n\treturn Object.assign({}, {\n\t\tiCalendarName: uc(options.name),\n\t\tpluralName: options.name + 's',\n\t}, options)\n}\n\n/**\n * Fill up the options object for advertiseComponent\n *\n * @param {Object|String} options Options destructuring object\n * @param {String} options.name Advertised name of component\n * @param {String=} options.iCalendarName The iCalendar name of the component\n * @param {Boolean=} options.customAddMethod Whether or not to use a custom add method\n * @returns {Object}\n */\nfunction getDefaultMultipleCompConfig(options) {\n\tif (typeof options === 'string') {\n\t\toptions = {\n\t\t\tname: options,\n\t\t}\n\t}\n\n\treturn Object.assign({}, {\n\t\tiCalendarName: 'V' + uc(options.name),\n\t\tpluralName: options.name + 's',\n\t}, options)\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\n/**\n * Gets a new DateObject set to now\n *\n * @returns {Date}\n */\nexport function dateFactory() {\n\treturn new Date()\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nexport default class RecurringWithoutDtStartError extends Error {}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport Property from '../properties/property.js'\nimport { uc } from '../helpers/stringHelper.js'\nimport DateTimeValue from '../values/dateTimeValue.js'\nimport ModificationNotAllowedError from '../errors/modificationNotAllowedError.js'\nimport RecurringWithoutDtStartError from '../errors/recurringWithoutDtStartError.js'\nimport PeriodValue from '../values/periodValue.js'\nimport ICAL from 'ical.js'\n\n/**\n * @class RecurrenceHelper\n * @classdesc\n *\n * TODO: This needs caching\n */\nexport default class RecurrenceManager {\n\n\t/**\n\t * Constructor\n\t *\n\t * @param {AbstractRecurringComponent} masterItem The master-item of the recurrence-set\n\t */\n\tconstructor(masterItem) {\n\n\t\t/**\n\t\t *\n\t\t * @type {AbstractRecurringComponent}\n\t\t * @private\n\t\t */\n\t\tthis._masterItem = masterItem\n\n\t\t/**\n\t\t * Set of Recurrence exception items\n\t\t *\n\t\t * Number is the unix time representation of the recurrence ID\n\t\t *\n\t\t * @type {Map<Number, AbstractRecurringComponent>}\n\t\t * @private\n\t\t */\n\t\tthis._recurrenceExceptionItems = new Map()\n\n\t\t/**\n\t\t * A sorted index of recurrence ids with range\n\t\t *\n\t\t * @type {Number[]}\n\t\t * @private\n\t\t */\n\t\tthis._rangeRecurrenceExceptionItemsIndex = []\n\n\t\t/**\n\t\t * Cached difference of dtstart and recurrenceId for recurrence exceptions with range\n\t\t *\n\t\t * @type {Map<Number, DurationValue>}\n\t\t * @private\n\t\t */\n\t\tthis._rangeRecurrenceExceptionItemsDiffCache = new Map()\n\n\t\t/**\n\t\t * Set of Recurrence exception items that have a RANGE of THISANDFUTURE\n\t\t *\n\t\t * Number is the unix time representation of the recurrence ID\n\t\t *\n\t\t * @type {Map<Number, AbstractRecurringComponent>}\n\t\t * @private\n\t\t */\n\t\tthis._rangeRecurrenceExceptionItems = new Map()\n\t}\n\n\t/**\n\t *\n\t * @returns {AbstractRecurringComponent}\n\t */\n\tget masterItem() {\n\t\treturn this._masterItem\n\t}\n\n\t/**\n\t *\n\t * @param {AbstractRecurringComponent} masterItem The master-item of the recurrence-set\n\t */\n\tset masterItem(masterItem) {\n\t\tthis._masterItem = masterItem\n\t}\n\n\t/**\n\t * Gets an iterator over all registered recurrence exceptions of this calendar-document\n\t */\n\t* getRecurrenceExceptionIterator() {\n\t\tyield * this._recurrenceExceptionItems.values()\n\t}\n\n\t/**\n\t * Gets a list of all registered recurrence-exceptions of this calendar-document\n\t *\n\t * @returns {AbstractRecurringComponent[]}\n\t */\n\tgetRecurrenceExceptionList() {\n\t\treturn Array.from(this.getRecurrenceExceptionIterator())\n\t}\n\n\t/**\n\t * Checks if there is a recurrence Exception for a given recurrenceId\n\t *\n\t * @param {DateTimeValue|Number} recurrenceId The recurrenceId to check\n\t * @returns {boolean}\n\t */\n\thasRecurrenceExceptionForId(recurrenceId) {\n\t\tif (recurrenceId instanceof DateTimeValue) {\n\t\t\trecurrenceId = recurrenceId.unixTime\n\t\t} else if (recurrenceId instanceof ICAL.Time) {\n\t\t\trecurrenceId = recurrenceId.toUnixTime()\n\t\t}\n\n\t\treturn this._recurrenceExceptionItems.has(recurrenceId)\n\t}\n\n\t/**\n\t * Gets the recurrence exception for a given recurrence Id\n\t *\n\t * @param {DateTimeValue|Number} recurrenceId The recurrenceId to get\n\t * @returns {AbstractRecurringComponent|null}\n\t */\n\tgetRecurrenceException(recurrenceId) {\n\t\tif (recurrenceId instanceof DateTimeValue) {\n\t\t\trecurrenceId = recurrenceId.unixTime\n\t\t} else if (recurrenceId instanceof ICAL.Time) {\n\t\t\trecurrenceId = recurrenceId.toUnixTime()\n\t\t}\n\n\t\treturn this._recurrenceExceptionItems.get(recurrenceId) || null\n\t}\n\n\t/**\n\t * Check if there is a recurrence-exception with a range for a given recurrence-id\n\t *\n\t * @param {DateTimeValue|Number} recurrenceId The recurrenceId to check\n\t * @returns {boolean}\n\t */\n\thasRangeRecurrenceExceptionForId(recurrenceId) {\n\t\tif (recurrenceId instanceof DateTimeValue) {\n\t\t\trecurrenceId = recurrenceId.unixTime\n\t\t} else if (recurrenceId instanceof ICAL.Time) {\n\t\t\trecurrenceId = recurrenceId.toUnixTime()\n\t\t}\n\n\t\tif (this._rangeRecurrenceExceptionItemsIndex.length === 0) {\n\t\t\treturn false\n\t\t}\n\n\t\treturn this._rangeRecurrenceExceptionItemsIndex[0] < recurrenceId\n\t}\n\n\t/**\n\t * Get recurrence-exception with range that's affecting the given recurrence-id\n\t *\n\t * @param {DateTimeValue|Number} recurrenceId The recurrenceId to get\n\t * @returns {AbstractRecurringComponent|null}\n\t */\n\tgetRangeRecurrenceExceptionForId(recurrenceId) {\n\t\tif (recurrenceId instanceof DateTimeValue) {\n\t\t\trecurrenceId = recurrenceId.unixTime\n\t\t} else if (recurrenceId instanceof ICAL.Time) {\n\t\t\trecurrenceId = recurrenceId.toUnixTime()\n\t\t}\n\n\t\tconst index = ICAL.helpers.binsearchInsert(\n\t\t\tthis._rangeRecurrenceExceptionItemsIndex,\n\t\t\trecurrenceId,\n\t\t\t(a, b) => a - b\n\t\t)\n\n\t\tif (index === 0) {\n\t\t\treturn null\n\t\t}\n\n\t\tconst key = this._rangeRecurrenceExceptionItemsIndex[index - 1]\n\t\treturn this._rangeRecurrenceExceptionItems.get(key)\n\t}\n\n\t/**\n\t * Gets the difference between recurrence-id and start\n\t * Mostly needed to handle recurrence-exceptions with range\n\t *\n\t * @param {DateTimeValue|Number} recurrenceId The recurrenceId to get\n\t * @returns {DurationValue|null}\n\t */\n\tgetRangeRecurrenceExceptionDiff(recurrenceId) {\n\t\tif (recurrenceId instanceof DateTimeValue) {\n\t\t\trecurrenceId = recurrenceId.unixTime\n\t\t} else if (recurrenceId instanceof ICAL.Time) {\n\t\t\trecurrenceId = recurrenceId.toUnixTime()\n\t\t}\n\n\t\tif (this._rangeRecurrenceExceptionItemsDiffCache.has(recurrenceId)) {\n\t\t\treturn this._rangeRecurrenceExceptionItemsDiffCache.get(recurrenceId)\n\t\t}\n\n\t\tconst recurrenceException = this.getRangeRecurrenceExceptionForId(recurrenceId)\n\t\tif (!recurrenceException) {\n\t\t\treturn null\n\t\t}\n\n\t\tconst originalRecurrenceId = recurrenceException.recurrenceId\n\t\tconst originalModifiedStart = recurrenceException.startDate\n\n\t\tconst difference = originalModifiedStart.subtractDateWithTimezone(originalRecurrenceId)\n\t\tdifference.lock()\n\n\t\tthis._rangeRecurrenceExceptionItemsDiffCache.set(recurrenceId, difference)\n\t\treturn difference\n\t}\n\n\t/**\n\t * Adds a new recurrence-exception to this calendar-document\n\t *\n\t * @param {AbstractRecurringComponent} recurrenceExceptionItem The recurrence-exception-item to relate to recurrence-set\n\t */\n\trelateRecurrenceException(recurrenceExceptionItem) {\n\t\tthis._modify()\n\t\tconst key = this._getRecurrenceIdKey(recurrenceExceptionItem)\n\n\t\tthis._recurrenceExceptionItems.set(key, recurrenceExceptionItem)\n\t\tif (recurrenceExceptionItem.modifiesFuture()) {\n\t\t\tthis._rangeRecurrenceExceptionItems.set(key, recurrenceExceptionItem)\n\t\t\tconst index = ICAL.helpers.binsearchInsert(\n\t\t\t\tthis._rangeRecurrenceExceptionItemsIndex,\n\t\t\t\tkey,\n\t\t\t\t(a, b) => a - b\n\t\t\t)\n\n\t\t\tthis._rangeRecurrenceExceptionItemsIndex.splice(index, 0, key)\n\t\t}\n\n\t\trecurrenceExceptionItem.recurrenceManager = this\n\t}\n\n\t/**\n\t * Removes a recurrence exception by the item itself\n\t *\n\t * @param {AbstractRecurringComponent} recurrenceExceptionItem The recurrence-exception remove\n\t */\n\tremoveRecurrenceException(recurrenceExceptionItem) {\n\t\tconst key = this._getRecurrenceIdKey(recurrenceExceptionItem)\n\t\tthis.removeRecurrenceExceptionByRecurrenceId(key)\n\t}\n\n\t/**\n\t * Removes a recurrence exception by it's unix-time\n\t *\n\t * @param {Number} recurrenceId The recurrence-exception to remove\n\t */\n\tremoveRecurrenceExceptionByRecurrenceId(recurrenceId) {\n\t\tthis._modify()\n\t\tthis._recurrenceExceptionItems.delete(recurrenceId)\n\t\tthis._rangeRecurrenceExceptionItems.delete(recurrenceId)\n\t\tthis._rangeRecurrenceExceptionItemsDiffCache.delete(recurrenceId)\n\n\t\tconst index = this._rangeRecurrenceExceptionItemsIndex.indexOf(recurrenceId)\n\t\tif (index !== -1) {\n\t\t\tthis._rangeRecurrenceExceptionItemsIndex.splice(index, 1)\n\t\t}\n\t}\n\n\t/**\n\t *\n\t * @param {AbstractRecurringComponent} recurrenceExceptionItem Object to get key from\n\t * @returns {Number}\n\t * @private\n\t */\n\t_getRecurrenceIdKey(recurrenceExceptionItem) {\n\t\treturn recurrenceExceptionItem\n\t\t\t.recurrenceId\n\t\t\t.unixTime\n\t}\n\n\t/**\n\t * Gets an iterator over all recurrence rules\n\t */\n\t* getRecurrenceRuleIterator() {\n\t\tfor (const property of this._masterItem.getPropertyIterator('RRULE')) {\n\t\t\tyield property.getFirstValue()\n\t\t}\n\t}\n\n\t/**\n\t * Gets a list of all recurrence rules\n\t *\n\t * @returns {RecurValue[]}\n\t */\n\tgetRecurrenceRuleList() {\n\t\treturn Array.from(this.getRecurrenceRuleIterator())\n\t}\n\n\t/**\n\t * Adds a new recurrence rule\n\t *\n\t * @param {RecurValue} recurrenceRule The RRULE to add\n\t */\n\taddRecurrenceRule(recurrenceRule) {\n\t\tthis._modify()\n\t\tthis.resetCache()\n\n\t\tconst property = new Property('RRULE', recurrenceRule)\n\t\tthis._masterItem.addProperty(property)\n\t}\n\n\t/**\n\t * Removes a recurrence rule\n\t *\n\t * @param {RecurValue} recurrenceRule The RRULE to remove\n\t */\n\tremoveRecurrenceRule(recurrenceRule) {\n\t\tthis._modify()\n\t\tthis.resetCache()\n\n\t\tfor (const property of this._masterItem.getPropertyIterator('RRULE')) {\n\t\t\tif (property.getFirstValue() === recurrenceRule) {\n\t\t\t\tthis._masterItem.deleteProperty(property)\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Removes all recurrence rules\n\t */\n\tclearAllRecurrenceRules() {\n\t\tthis._modify()\n\t\tthis.resetCache()\n\n\t\tthis._masterItem.deleteAllProperties('RRULE')\n\t}\n\n\t/**\n\t * Gets an iterator over all recurrence\n\t *\n\t * @param {boolean} isNegative Whether or not to get EXDATES\n\t * @param {String} valueType Limit type of EXDATES\n\t */\n\t* getRecurrenceDateIterator(isNegative = false, valueType = null) {\n\t\tfor (const property of this._getPropertiesForRecurrenceDate(isNegative, valueType)) {\n\t\t\tyield * property.getValueIterator()\n\t\t}\n\t}\n\n\t/**\n\t *\n\t * @param {boolean} isNegative Whether or not to get EXDATES\n\t * @param {String} valueType Limit type of EXDATES\n\t * @returns {(DateTimeValue|PeriodValue)[]}\n\t */\n\tlistAllRecurrenceDates(isNegative = false, valueType = null) {\n\t\treturn Array.from(this.getRecurrenceDateIterator(isNegative, valueType))\n\t}\n\n\t/**\n\t * This adds a new recurrence-date value.\n\t * It automatically adds it to the first property of the same value-type\n\t * or creates a new one if necessary\n\t *\n\t * @param {boolean} isNegative Whether we are dealing with an EXDATE or RDATE\n\t * @param {DateTimeValue|PeriodValue} value EXDATE to add\n\t */\n\taddRecurrenceDate(isNegative = false, value) {\n\t\tthis._modify()\n\t\tthis.resetCache()\n\n\t\t// Only add DateTime Value if its of the same timezone\n\t\tlet timezoneId = null\n\t\tif (value instanceof DateTimeValue && !value.isDate) {\n\t\t\ttimezoneId = value.timezoneId\n\t\t}\n\n\t\tconst valueType = this._getValueTypeByValue(value)\n\t\tconst iterator = this._getPropertiesForRecurrenceDate(isNegative, valueType, timezoneId)\n\n\t\tconst first = iterator.next.value\n\t\tif (first instanceof Property) {\n\t\t\tconst propertyValue = first.value\n\t\t\tpropertyValue.push(value)\n\t\t\tthis.masterItem.markPropertyAsDirty(isNegative ? 'EXDATE' : 'RDATE')\n\t\t} else {\n\t\t\tconst propertyName = this._getPropertyNameByIsNegative(isNegative)\n\t\t\tconst property = new Property(propertyName, value)\n\t\t\tthis._masterItem.addProperty(property)\n\t\t}\n\t}\n\n\t/**\n\t * Checks if a recurrenceID is an RDATE or EXDATE\n\t *\n\t * @param {Boolean} isNegative Whether we are dealing with an EXDATE or RDATE\n\t * @param {DateTimeValue} recurrenceId Recurrence-Id to check\n\t * @returns {boolean}\n\t */\n\thasRecurrenceDate(isNegative = false, recurrenceId) {\n\t\tfor (let value of this.getRecurrenceDateIterator(isNegative)) {\n\t\t\tif (value instanceof PeriodValue) {\n\t\t\t\tvalue = value.start\n\t\t\t}\n\n\t\t\tif (value.compare(recurrenceId) === 0) {\n\t\t\t\treturn true\n\t\t\t}\n\t\t}\n\n\t\treturn false\n\t}\n\n\t/**\n\t *\n\t * @param {Boolean} isNegative Whether we are dealing with an EXDATE or RDATE\n\t * @param {DateTimeValue} recurrenceId Recurrence-Id to get\n\t * @returns {null|DateTimeValue|PeriodValue}\n\t */\n\tgetRecurrenceDate(isNegative = false, recurrenceId) {\n\t\tfor (const value of this.getRecurrenceDateIterator(isNegative)) {\n\t\t\tlet valueToCheck = value\n\t\t\tif (valueToCheck instanceof PeriodValue) {\n\t\t\t\tvalueToCheck = valueToCheck.start\n\t\t\t}\n\n\t\t\tif (valueToCheck.compare(recurrenceId) === 0) {\n\t\t\t\treturn value\n\t\t\t}\n\t\t}\n\n\t\treturn null\n\t}\n\n\t/**\n\t * This deletes a recurrence-date value from this recurrence-set\n\t *\n\t * @param {boolean} isNegative Whether we are dealing with an EXDATE or RDATE\n\t * @param {DateTimeValue|PeriodValue} value The EXDATE/RDATE to remove\n\t */\n\tremoveRecurrenceDate(isNegative = false, value) {\n\t\tthis._modify()\n\t\tthis.resetCache()\n\n\t\tconst valueType = this._getValueTypeByValue(value)\n\t\tfor (const property of this._getPropertiesForRecurrenceDate(isNegative, valueType)) {\n\t\t\tfor (const valueToCheck of property.getValueIterator()) {\n\t\t\t\tif (value === valueToCheck) {\n\t\t\t\t\tconst allValues = property.value\n\n\t\t\t\t\tif (allValues.length === 1) {\n\t\t\t\t\t\tthis.masterItem.deleteProperty(property)\n\t\t\t\t\t\tcontinue\n\t\t\t\t\t}\n\n\t\t\t\t\tconst index = allValues.indexOf(value)\n\t\t\t\t\tallValues.splice(index, 1)\n\t\t\t\t\tthis.masterItem.markPropertyAsDirty(isNegative ? 'EXDATE' : 'RDATE')\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Clears all recurrence-date information\n\t *\n\t * @param {boolean} isNegative Whether we are dealing with an EXDATE or RDATE\n\t * @param {String} valueType The type of RDATEs/EXDATEs to remove\n\t */\n\tclearAllRecurrenceDates(isNegative = false, valueType = null) {\n\t\tthis._modify()\n\t\tthis.resetCache()\n\n\t\tfor (const property of this._getPropertiesForRecurrenceDate(isNegative, valueType)) {\n\t\t\tthis._masterItem.deleteProperty(property)\n\t\t}\n\t}\n\n\t/**\n\t * Gets the property name for recurrence dates based on the isNegative boolean\n\t *\n\t * @param {boolean} isNegative Whether we are dealing with an EXDATE or RDATE\n\t * @returns {string}\n\t * @private\n\t */\n\t_getPropertyNameByIsNegative(isNegative) {\n\t\treturn isNegative\n\t\t\t? 'EXDATE'\n\t\t\t: 'RDATE'\n\t}\n\n\t/**\n\t * Gets the value type based on the provided value\n\t *\n\t * @param {PeriodValue|DateTimeValue} value The value to get type of property from\n\t * @returns {string}\n\t * @private\n\t */\n\t_getValueTypeByValue(value) {\n\t\tif (value instanceof PeriodValue) {\n\t\t\treturn 'PERIOD'\n\t\t} else if (value.isDate) {\n\t\t\treturn 'DATE'\n\t\t} else {\n\t\t\treturn 'DATETIME'\n\t\t}\n\t}\n\n\t/**\n\t *\n\t * @param {boolean} isNegative Whether we are dealing with an EXDATE or RDATE\n\t * @param {String|null} valueType The type of values to get\n\t * @param {ICAL.Timezone=} timezoneId Filter by timezone\n\t * @private\n\t */\n\t* _getPropertiesForRecurrenceDate(isNegative, valueType, timezoneId = null) {\n\t\tconst propertyName = this._getPropertyNameByIsNegative(isNegative)\n\n\t\tfor (const property of this._masterItem.getPropertyIterator(propertyName)) {\n\t\t\tif (valueType === null) {\n\t\t\t\tyield property\n\t\t\t} else if (uc(valueType) === 'PERIOD' && property.getFirstValue() instanceof PeriodValue) {\n\t\t\t\tyield property\n\t\t\t} else if (uc(valueType) === 'DATE' && property.getFirstValue().isDate) {\n\t\t\t\tyield property\n\t\t\t} else if (uc(valueType) === 'DATETIME' && !property.getFirstValue().isDate) {\n\t\t\t\tif (timezoneId === null || property.getFirstValue().timezoneId === timezoneId) {\n\t\t\t\t\tyield property\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Checks if the entire set of recurrence rules is finite\n\t *\n\t * @returns {boolean}\n\t */\n\tisFinite() {\n\t\treturn this.getRecurrenceRuleList().every((rule) => rule.isFinite())\n\t}\n\n\t/**\n\t * @returns {boolean}\n\t */\n\tisEmptyRecurrenceSet() {\n\t\treturn this._getRecurExpansionObject().next() === undefined\n\t}\n\n\t/**\n\t * Gets the occurrence at the exact given recurrenceId\n\t *\n\t * @param {DateTimeValue} recurrenceId RecurrenceId to get\n\t * @returns {AbstractRecurringComponent|null}\n\t */\n\tgetOccurrenceAtExactly(recurrenceId) {\n\t\tif (!this.masterItem.isRecurring()) {\n\t\t\tif (this.masterItem.getReferenceRecurrenceId().compare(recurrenceId) === 0) {\n\t\t\t\treturn this.masterItem\n\t\t\t}\n\n\t\t\treturn null\n\t\t}\n\n\t\tconst iterator = this._getRecurExpansionObject()\n\t\tconst icalRecurrenceId = recurrenceId.toICALJs()\n\n\t\tlet next\n\t\twhile ((next = iterator.next())) {\n\t\t\tif (next.compare(icalRecurrenceId) === 0) {\n\t\t\t\t// It's a match \n\t\t\t\treturn this._getOccurrenceAtRecurrenceId(DateTimeValue.fromICALJs(next))\n\t\t\t}\n\n\t\t\tif (next.compare(icalRecurrenceId) === 1) {\n\t\t\t\t// We hit an occurrence in the future, return null\n\t\t\t\treturn null\n\t\t\t}\n\t\t}\n\n\t\treturn null\n\t}\n\n\t/**\n\t * Gets the closest occurrence to the given recurrenceId.\n\t * That's either the closest in the future, or in case the\n\t * recurrence-set ends before recurrenceId, the last one\n\t *\n\t * This function works solely on the basis of recurrence-ids.\n\t * It ignores the actual date of recurrence-exceptions.\n\t * Ideally we should fix it and provide a similar implementation\n\t * like getAllOccurrencesBetweenIterator, but for now it's the\n\t * accepted behavior.\n\t *\n\t * @param {DateTimeValue} recurrenceId RecurrenceId to get\n\t * @returns {AbstractRecurringComponent}\n\t */\n\tgetClosestOccurrence(recurrenceId) {\n\t\tif (!this.masterItem.isRecurring()) {\n\t\t\treturn this.masterItem\n\t\t}\n\n\t\tconst iterator = this._getRecurExpansionObject()\n\t\trecurrenceId = recurrenceId.toICALJs()\n\n\t\tlet previous = null\n\t\tlet next\n\t\twhile ((next = iterator.next())) {\n\t\t\tif (next.compare(recurrenceId) === -1) {\n\t\t\t\tprevious = next\n\t\t\t} else {\n\t\t\t\t// This is the case when it's either equal or in the future\n\t\t\t\tconst dateTimeValue = DateTimeValue.fromICALJs(next)\n\t\t\t\treturn this._getOccurrenceAtRecurrenceId(dateTimeValue)\n\t\t\t}\n\t\t}\n\n\t\tconst dateTimeValue = DateTimeValue.fromICALJs(previous)\n\t\treturn this._getOccurrenceAtRecurrenceId(dateTimeValue)\n\t}\n\n\t/**\n\t * Get all occurrences between start and end\n\t * Start and End are inclusive\n\t *\n\t * @param {DateTimeValue} queriedTimeRangeStart Start of time-range\n\t * @param {DateTimeValue} queriedTimeRangeEnd End of time-range\n\t */\n\t* getAllOccurrencesBetweenIterator(queriedTimeRangeStart, queriedTimeRangeEnd) {\n\t\tif (!this.masterItem.isRecurring()) {\n\t\t\tif (typeof this.masterItem.isInTimeFrame !== 'function') {\n\t\t\t\tyield this.masterItem\n\t\t\t}\n\t\t\tif (this.masterItem.isInTimeFrame(queriedTimeRangeStart, queriedTimeRangeEnd)) {\n\t\t\t\tyield this.masterItem\n\t\t\t}\n\n\t\t\treturn\n\t\t}\n\n\t\tconst iterator = this._getRecurExpansionObject()\n\t\tconst queriedICALJsTimeRangeStart = queriedTimeRangeStart.toICALJs()\n\t\tconst queriedICALJsTimeRangeEnd = queriedTimeRangeEnd.toICALJs()\n\n\t\tconst recurrenceIdKeys = Array.from(this._recurrenceExceptionItems.keys())\n\t\tconst maximumRecurrenceId = Math.max.apply(Math, recurrenceIdKeys)\n\n\t\tlet next\n\t\twhile ((next = iterator.next())) {\n\t\t\t// We have to get the real occurrence to resolve RECURRENCE-IDs\n\t\t\tconst dateTimeValue = DateTimeValue.fromICALJs(next)\n\t\t\tconst occurrence = this._getOccurrenceAtRecurrenceId(dateTimeValue)\n\n\t\t\t// Check what type of recurrence object we are dealing with\n\t\t\t// Depending on that, the time to compare to changes\n\t\t\t// If we are dealing events, we have to compare to the end-date\n\t\t\t// If we are dealing with tasks, we will have to compare to the due-date\n\t\t\t// etc.\n\t\t\t// For now we are only implementing events, other components will come later\n\t\t\tlet compareDate = null\n\t\t\tswitch (uc(occurrence.name)) {\n\t\t\tcase 'VEVENT':\n\t\t\tcase 'VTODO':\n\t\t\t\tcompareDate = occurrence.endDate.toICALJs()\n\t\t\t\tbreak\n\n\t\t\tcase 'VJOURNAL':\n\t\t\tdefault:\n\t\t\t\tcompareDate = next\n\t\t\t\tbreak\n\t\t\t}\n\n\t\t\t// If the date we are comparing to is before our time-range,\n\t\t\t// we don't want to yield this event\n\t\t\tif (compareDate.compare(queriedICALJsTimeRangeStart) === -1) {\n\t\t\t\tcontinue\n\t\t\t}\n\n\t\t\t// If we have an object that is:\n\t\t\t// 1. either\n\t\t\t// 1.1 - no recurrence exception\n\t\t\t//     or\n\t\t\t// 1.2 - a recurrence-exception that modifies the future\n\t\t\t// and\n\t\t\t// 2. starts after the queried time-range ends, then we stop expanding\n\t\t\tconst startDate = occurrence.startDate.toICALJs()\n\t\t\tif ((!occurrence.isRecurrenceException() || occurrence.modifiesFuture()) && startDate.compare(queriedICALJsTimeRangeEnd) === 1) {\n\t\t\t\t// Just break if there are no recurrence-exceptions\n\t\t\t\tif (this._recurrenceExceptionItems.size === 0) {\n\t\t\t\t\tbreak\n\t\t\t\t}\n\n\t\t\t\t// Keep iterating until our currently checked recurrenceId\n\t\t\t\t// is bigger than the maximum recurrence-id that we have.\n\t\t\t\tif (next.toUnixTime() > maximumRecurrenceId) {\n\t\t\t\t\tbreak\n\t\t\t\t} else {\n\t\t\t\t\tcontinue\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (typeof occurrence.isInTimeFrame !== 'function') {\n\t\t\t\tyield occurrence\n\t\t\t}\n\t\t\tif (occurrence.isInTimeFrame(queriedTimeRangeStart, queriedTimeRangeEnd)) {\n\t\t\t\tyield occurrence\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Get all occurrences between start and end\n\t *\n\t * @param {DateTimeValue} start Start of time-range\n\t * @param {DateTimeValue} end End of time-range\n\t * @returns {(*|null)[]}\n\t */\n\tgetAllOccurrencesBetween(start, end) {\n\t\treturn Array.from(this.getAllOccurrencesBetweenIterator(start, end))\n\t}\n\n\t/**\n\t * Update the UID of all components in the recurrence set\n\t *\n\t * @param {String} newUID The new UID of the calendar-document\n\t */\n\tupdateUID(newUID) {\n\t\tthis._masterItem.updatePropertyWithValue('UID', newUID)\n\n\t\tfor (const recurrenceExceptionItem of this.getRecurrenceExceptionIterator()) {\n\t\t\trecurrenceExceptionItem.updatePropertyWithValue('UID', newUID)\n\t\t}\n\t}\n\n\t/**\n\t * Updates the recurrence-information accordingly,\n\t * whenever the start-date of the master-item changes\n\t *\n\t * @param {DateTimeValue} newStartDate The new start-date\n\t * @param {DateTimeValue} oldStartDate The old start-date\n\t */\n\tupdateStartDateOfMasterItem(newStartDate, oldStartDate) {\n\t\tconst difference = newStartDate.subtractDateWithTimezone(oldStartDate)\n\n\t\t// update EXDATE\n\t\tfor (const exdate of this.getRecurrenceDateIterator(true)) {\n\t\t\t// If this EXDATE matches an RDATE, don't update, because we don't update RDATEs\n\t\t\tif (this.hasRecurrenceDate(false, exdate)) {\n\t\t\t\tcontinue\n\t\t\t}\n\n\t\t\t// EXDATE are always either DATE or DATETIME,\n\t\t\t// no need to check for PERIOD\n\t\t\texdate.addDuration(difference)\n\t\t}\n\n\t\tfor (const recurrenceException of this.getRecurrenceExceptionIterator()) {\n\t\t\t// We don't edit RDATES, so don't update recurrence-ids if they\n\t\t\t// are based on an RDATE\n\t\t\tif (this.hasRecurrenceDate(false, recurrenceException.recurrenceId)) {\n\t\t\t\tcontinue\n\t\t\t}\n\n\t\t\tthis.removeRecurrenceException(recurrenceException)\n\t\t\trecurrenceException.recurrenceId.addDuration(difference)\n\t\t\tthis.relateRecurrenceException(recurrenceException)\n\t\t}\n\n\t\t// update UNTIL of recurrence-rules\n\t\tfor (const rrule of this.getRecurrenceRuleIterator()) {\n\t\t\tif (rrule.until) {\n\t\t\t\trrule.until.addDuration(difference)\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Gets an object for the given recurrenceId\n\t * It does not verify that the given recurrenceId\n\t * is actually a valid recurrence of this calendar-document\n\t *\n\t * @param {DateTimeValue} recurrenceId Recurrence-Id to get\n\t * @returns {AbstractRecurringComponent}\n\t * @private\n\t */\n\t_getOccurrenceAtRecurrenceId(recurrenceId) {\n\t\tif (this.hasRecurrenceExceptionForId(recurrenceId)) {\n\t\t\tconst recurrenceException = this.getRecurrenceException(recurrenceId)\n\n\t\t\tif (!recurrenceException.canCreateRecurrenceExceptions()) {\n\t\t\t\treturn recurrenceException\n\t\t\t}\n\n\t\t\treturn recurrenceException\n\t\t\t\t.forkItem(recurrenceId)\n\t\t} else if (this.hasRangeRecurrenceExceptionForId(recurrenceId)) {\n\t\t\tconst rangeRecurrenceException = this.getRangeRecurrenceExceptionForId(recurrenceId)\n\t\t\tconst difference = this.getRangeRecurrenceExceptionDiff(recurrenceId)\n\n\t\t\treturn rangeRecurrenceException\n\t\t\t\t.forkItem(recurrenceId, difference)\n\t\t} else if (recurrenceId.compare(this._masterItem.startDate) === 0) {\n\t\t\tif (!this._masterItem.canCreateRecurrenceExceptions()) {\n\t\t\t\treturn this._masterItem\n\t\t\t}\n\n\t\t\treturn this._masterItem\n\t\t\t\t.forkItem(recurrenceId)\n\t\t} else {\n\t\t\treturn this._masterItem\n\t\t\t\t.forkItem(recurrenceId)\n\t\t}\n\t}\n\n\t/**\n\t * Resets the internal recur-expansion object.\n\t * This is necessary after each modification of the\n\t * recurrence-information\n\t */\n\tresetCache() {\n\t\t// TODO - implement me\n\t}\n\n\t/**\n\t * Gets a new ICAL.RecurExpansion object\n\t *\n\t * Inspired by how ICAL.JS RecurExpansion\n\t * serialises and unserialises its state\n\t *\n\t * @returns {ICAL.RecurExpansion}\n\t * @private\n\t */\n\t_getRecurExpansionObject() {\n\t\tif (this._masterItem.startDate === null) {\n\t\t\tthrow new RecurringWithoutDtStartError()\n\t\t}\n\n\t\tconst dtstart = this._masterItem.startDate.toICALJs()\n\t\tlet last = dtstart.clone()\n\t\tconst ruleIterators = []\n\t\tlet ruleDateInc\n\t\tconst ruleDates = []\n\t\tlet ruleDate = null\n\t\tconst exDates = []\n\t\tconst complete = false\n\n\t\tfor (const ruleValue of this.getRecurrenceRuleIterator()) {\n\t\t\truleIterators.push(ruleValue.toICALJs().iterator(dtstart))\n\t\t\truleIterators[ruleIterators.length - 1].next()\n\t\t}\n\n\t\tfor (let rDateValue of this.getRecurrenceDateIterator()) {\n\t\t\tif (rDateValue instanceof PeriodValue) {\n\t\t\t\trDateValue = rDateValue.start\n\t\t\t}\n\n\t\t\trDateValue = rDateValue.toICALJs()\n\t\t\tconst index = ICAL.helpers.binsearchInsert(\n\t\t\t\truleDates,\n\t\t\t\trDateValue,\n\t\t\t\t(a, b) => a.compare(b)\n\t\t\t)\n\n\t\t\truleDates.splice(index, 0, rDateValue)\n\t\t}\n\n\t\t// Is the first RDATE prior to our current DTSTART?\n\t\tif (ruleDates.length > 0 && ruleDates[0].compare(dtstart) === -1) {\n\t\t\truleDateInc = 0\n\t\t\tlast = ruleDates[0].clone()\n\t\t} else {\n\t\t\truleDateInc = ICAL.helpers.binsearchInsert(\n\t\t\t\truleDates,\n\t\t\t\tdtstart,\n\t\t\t\t(a, b) => a.compare(b)\n\t\t\t)\n\t\t\truleDate = exDates[ruleDateInc]\n\t\t}\n\n\t\tfor (let exDateValue of this.getRecurrenceDateIterator(true)) {\n\t\t\texDateValue = exDateValue.toICALJs()\n\t\t\tconst index = ICAL.helpers.binsearchInsert(\n\t\t\t\texDates,\n\t\t\t\texDateValue,\n\t\t\t\t(a, b) => a.compare(b)\n\t\t\t)\n\t\t\texDates.splice(index, 0, exDateValue)\n\t\t}\n\n\t\tconst exDateInc = ICAL.helpers.binsearchInsert(\n\t\t\texDates,\n\t\t\tdtstart,\n\t\t\t(a, b) => a.compare(b)\n\t\t)\n\t\tconst exDate = exDates[exDateInc]\n\n\t\treturn new ICAL.RecurExpansion({\n\t\t\tdtstart,\n\t\t\tlast,\n\t\t\truleIterators,\n\t\t\truleDateInc,\n\t\t\texDateInc,\n\t\t\truleDates,\n\t\t\truleDate,\n\t\t\texDates,\n\t\t\texDate,\n\t\t\tcomplete,\n\t\t})\n\t}\n\n\t/**\n\t * @private\n\t */\n\t_modify() {\n\t\tif (this._masterItem.isLocked()) {\n\t\t\tthrow new ModificationNotAllowedError()\n\t\t}\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport AbstractComponent, {\n\tadvertiseSingleOccurrenceProperty,\n} from '../abstractComponent.js'\nimport Timezone from '../../timezones/timezone.js'\n\n/**\n * @class TimezoneComponent\n * @classdesc\n *\n * There are no advertised properties / components for the TimezoneComponent,\n * since we don't care about it.\n * Editing / accessing the timezone information directly is not a use-case\n * All the timezone-handling is done by the underlying ICAL.JS\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.6.5\n */\nexport default class TimezoneComponent extends AbstractComponent {\n\n\t/**\n\t * Returns a calendar-js Timezone object\n\t *\n\t * @returns {Timezone}\n\t */\n\ttoTimezone() {\n\t\treturn new Timezone(this.toICALJs())\n\t}\n\n}\n\n/**\n * The timezoneId of this timezone-component\n *\n * @name TimezoneComponent#timezoneId\n * @type {String}\n */\nadvertiseSingleOccurrenceProperty(TimezoneComponent.prototype, {\n\tname: 'timezoneId',\n\tiCalendarName: 'tzid',\n})\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport TimezoneComponent from '../components/root/timezoneComponent.js'\nimport ICAL from 'ical.js'\n\n/**\n * @class Timezone\n */\nexport default class Timezone {\n\n\t/**\n\t * Constructor\n\t *\n\t * @param {String|ICAL.Timezone|ICAL.Component} timezoneId Id of the timezone\n\t * @param {String?} ics The iCalendar timezone definition\n\t */\n\tconstructor(timezoneId, ics) {\n\n\t\t/**\n\t\t * Id of the timezone, used before initialising\n\t\t *\n\t\t * @type {String}\n\t\t * @private\n\t\t */\n\t\tthis._timezoneId = null\n\n\t\t/**\n\t\t * ICS representation of the timezone, used before initialising\n\t\t *\n\t\t * @type {String}\n\t\t * @private\n\t\t */\n\t\tthis._ics = null\n\n\t\t/**\n\t\t * @type {ICAL.Timezone|null}\n\t\t */\n\t\tthis._innerValue = null\n\n\t\t/**\n\t\t *\n\t\t * @type {boolean}\n\t\t * @private\n\t\t */\n\t\tthis._initialized = false\n\n\t\t// If the first parameter is already\n\t\t// an instance of ICAL.Timezone,\n\t\t// skip lazy loading\n\t\tif (timezoneId instanceof ICAL.Timezone) {\n\t\t\tthis._innerValue = timezoneId\n\t\t\tthis._initialized = true\n\t\t} else if (timezoneId instanceof ICAL.Component) {\n\t\t\tthis._innerValue = new ICAL.Timezone(timezoneId)\n\t\t\tthis._initialized = true\n\t\t} else {\n\t\t\tthis._timezoneId = timezoneId\n\t\t\tthis._ics = ics\n\t\t}\n\t}\n\n\t/**\n\t * Gets the timezone id\n\t *\n\t * @returns {String}\n\t */\n\tget timezoneId() {\n\t\tif (this._initialized) {\n\t\t\treturn this._innerValue.tzid\n\t\t}\n\n\t\treturn this._timezoneId\n\t}\n\n\t/**\n\t * Gets the UTC Offset for a given date in this timezone\n\t *\n\t * @param {Number} year Year of the date\n\t * @param {Number} month Month of the date (1-based)\n\t * @param {Number} day Day of the date\n\t * @param {Number} hour Hour of the date\n\t * @param {Number} minute Minute of the date\n\t * @param {Number} second Second of the date\n\t * @returns {Number}\n\t */\n\toffsetForArray(year, month, day, hour, minute, second) {\n\t\tthis._initialize()\n\n\t\tconst time = new ICAL.Time({\n\t\t\tyear,\n\t\t\tmonth,\n\t\t\tday,\n\t\t\thour,\n\t\t\tminute,\n\t\t\tsecond,\n\t\t\tisDate: false,\n\t\t})\n\t\treturn this._innerValue.utcOffset(time)\n\t}\n\n\t/**\n\t * Converts a timestamp to an array of year, month, day, hour, minute, second.\n\t *\n\t * @param {Number} ms Timestamp in milliseconds\n\t * @returns {Number[]}\n\t */\n\ttimestampToArray(ms) {\n\t\tthis._initialize()\n\n\t\t// just create a dummy object because fromUnixTime is not exposed on ICAL.Time\n\t\tconst time = ICAL.Time.fromData({\n\t\t\tyear: 1970,\n\t\t\tmonth: 1,\n\t\t\tday: 1,\n\t\t\thour: 0,\n\t\t\tminute: 0,\n\t\t\tsecond: 0,\n\t\t})\n\t\ttime.fromUnixTime(Math.floor(ms / 1000))\n\n\t\tconst local = time.convertToZone(this._innerValue)\n\t\treturn [\n\t\t\tlocal.year,\n\t\t\tlocal.month, // THIS is 1-based !\n\t\t\tlocal.day,\n\t\t\tlocal.hour,\n\t\t\tlocal.minute,\n\t\t\tlocal.second,\n\t\t]\n\t}\n\n\t/**\n\t *\n\t * @returns {TimezoneComponent}\n\t */\n\ttoTimezoneComponent() {\n\t\treturn TimezoneComponent.fromICALJs(this.toICALJs())\n\t}\n\n\t/**\n\t * Returns\n\t *\n\t * @returns {ICAL.Timezone}\n\t */\n\ttoICALTimezone() {\n\t\tthis._initialize()\n\t\treturn this._innerValue\n\t}\n\n\t/**\n\t * Returns the corresponding ICAL.\n\t *\n\t * @returns {ICAL.Component}\n\t */\n\ttoICALJs() {\n\t\tthis._initialize()\n\t\treturn this._innerValue.component\n\t}\n\n\t/**\n\t * Initialises the inner ICAL.Timezone component\n\t *\n\t * @private\n\t */\n\t_initialize() {\n\t\tif (!this._initialized) {\n\t\t\tconst jCal = ICAL.parse(this._ics)\n\t\t\tconst icalComp = new ICAL.Component(jCal)\n\t\t\tthis._innerValue = new ICAL.Timezone(icalComp)\n\t\t\tthis._initialized = true\n\t\t}\n\t}\n\n}\n\nTimezone.utc = new Timezone(ICAL.Timezone.utcTimezone)\nTimezone.floating = new Timezone(ICAL.Timezone.localTimezone)\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport AbstractComponent, {\n\tadvertiseMultipleOccurrenceProperty,\n\tadvertiseSingleOccurrenceProperty,\n} from '../abstractComponent.js'\nimport AttendeeProperty from '../../properties/attendeeProperty.js'\nimport TriggerProperty from '../../properties/triggerProperty.js'\n\n/**\n * @class AlarmComponent\n * @classdesc\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.6.6\n */\nexport default class AlarmComponent extends AbstractComponent {\n\n\t/**\n\t * Adds a new attendee based on their name and email-address\n\t *\n\t * @param {String} name - Name of the attendee\n\t * @param {String} email - E-Mail address of the attendee\n\t * @returns {boolean}\n\t */\n\taddAttendeeFromNameAndEMail(name, email) {\n\t\tconst attendeeProperty = AttendeeProperty.fromNameAndEMail(name, email)\n\t\treturn this.addProperty(attendeeProperty)\n\t}\n\n\t/**\n\t * Gets the trigger property\n\t *\n\t * @url https://tools.ietf.org/html/rfc5545#section-3.8.6.3\n\t *\n\t * @returns {TriggerProperty}\n\t */\n\tget trigger() {\n\t\treturn this.getFirstProperty('TRIGGER')\n\t}\n\n\t/**\n\t * Sets an absolute alarm\n\t *\n\t * @param {DateTimeValue} alarmTime - Absolute time for the trigger\n\t */\n\tsetTriggerFromAbsolute(alarmTime) {\n\t\tconst triggerProperty = TriggerProperty.fromAbsolute(alarmTime)\n\t\tthis.deleteAllProperties('TRIGGER')\n\t\tthis.addProperty(triggerProperty)\n\t}\n\n\t/**\n\t * Sets a relative trigger\n\t *\n\t * @param {DurationValue} alarmOffset - Relative time of the trigger, either related to start or end\n\t * @param {Boolean=} relatedToStart - Related to Start or end?\n\t */\n\tsetTriggerFromRelative(alarmOffset, relatedToStart = true) {\n\t\tconst triggerProperty = TriggerProperty.fromRelativeAndRelated(alarmOffset, relatedToStart)\n\t\tthis.deleteAllProperties('TRIGGER')\n\t\tthis.addProperty(triggerProperty)\n\t}\n\n}\n\n/**\n * Action to be taken when this Alarm is due\n * Possible values:\n * - AUDIO\n * - DISPLAY\n * - EMAIL\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.6.1\n *\n * @name AlarmComponent#action\n * @type {String}\n */\nadvertiseSingleOccurrenceProperty(AlarmComponent.prototype, 'action')\n\n/**\n * Description for this alarm\n * Can only be used in combination with action DISPLAY and EMAIL\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.5\n *\n * @name AlarmComponent#description\n * @type {String}\n */\nadvertiseSingleOccurrenceProperty(AlarmComponent.prototype, 'description')\n\n/**\n * Summary for this alarm\n * Can only be used in combination with action EMAIL\n * Will be used as the EMAIL's subject\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.12\n *\n * @name AlarmComponent#summary\n * @type {String}\n */\nadvertiseSingleOccurrenceProperty(AlarmComponent.prototype, 'summary')\n\n/**\n * The duration specifies the delay period between repeated alarms.\n * This property must be specified along with the repeat property\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.2.5\n *\n * @name AlarmComponent#duration\n * @type {String}\n */\nadvertiseSingleOccurrenceProperty(AlarmComponent.prototype, 'duration')\n\n/**\n * The number of times an alarm should be repeated.\n * This property must be specified along with the duration property\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.6.2\n *\n * @name AlarmComponent#repeat\n * @type {Number}\n */\nadvertiseSingleOccurrenceProperty(AlarmComponent.prototype, 'repeat')\n\n/**\n * This attachment points to a sound file, can only be used in combination\n * with ACTION AUDIO\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.1\n *\n * @name AlarmComponent#attachment\n * @type {AttachmentProperty}\n */\nadvertiseSingleOccurrenceProperty(AlarmComponent.prototype, {\n\tname: 'attachment',\n\tiCalendarName: 'ATTACH',\n})\n\n/**\n * Get an iterator over all attendees\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.4.1\n *\n * @name AlarmComponent#getAttendeeIterator\n * @function\n * @returns {IterableIterator<AttendeeProperty>}\n */\n\n/**\n * Get a list of all attendees\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.4.1\n *\n * @name AlarmComponent#getAttendeeList\n * @function\n * @returns {AttendeeProperty[]}\n */\n\n/**\n * Adds a new attendee to this alarm-component\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.4.1\n *\n * @name AlarmComponent#addAttendee\n * @function\n * @param {AttendeeProperty} attendee - The attendee object to add\n */\n\n/**\n * Removes an attendee from this alarm-component\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.4.1\n *\n * @name AlarmComponent#removeAttendee\n * @function\n * @param {AttendeeProperty} attendee - The attendee object to remove\n */\n\n/**\n * Removes all attendees from this alarm-component\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.4.1\n *\n * @name AlarmComponent#clearAllAttendees\n * @function\n */\nadvertiseMultipleOccurrenceProperty(AlarmComponent.prototype, 'attendee')\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport AbstractComponent from '../abstractComponent.js'\nimport AlarmComponent from './alarmComponent.js'\nimport { uc } from '../../helpers/stringHelper.js'\n\n/**\n * Gets the constructor for a component name\n * This will only return a constructor for components,\n * that can be nested inside other ones\n *\n * @param {String} compName - Component name to get default constructor for\n * @returns {AlarmComponent|AbstractComponent}\n */\nexport function getConstructorForComponentName(compName) {\n\tswitch (uc(compName)) {\n\tcase 'VALARM':\n\t\treturn AlarmComponent\n\n\tdefault:\n\t\treturn AbstractComponent\n\t}\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport AbstractComponent, {\n\tadvertiseComponent,\n\tadvertiseMultipleOccurrenceProperty,\n\tadvertiseMultiValueStringPropertySeparatedByLang,\n\tadvertiseSingleOccurrenceProperty,\n} from '../abstractComponent.js'\nimport DateTimeValue from '../../values/dateTimeValue.js'\nimport DurationValue from '../../values/durationValue.js'\nimport PeriodValue from '../../values/periodValue.js'\nimport { dateFactory } from '../../factories/dateFactory.js'\nimport { uc } from '../../helpers/stringHelper.js'\nimport RecurrenceManager from '../../recurrence/recurrenceManager.js'\nimport { v4 as uuid } from 'uuid'\nimport RelationProperty from '../../properties/relationProperty.js'\nimport AttendeeProperty from '../../properties/attendeeProperty.js'\nimport Timezone from '../../timezones/timezone.js'\nimport RequestStatusProperty from '../../properties/requestStatusProperty.js'\nimport AttachmentProperty from '../../properties/attachmentProperty.js'\nimport ImageProperty from '../../properties/imageProperty.js'\nimport TextProperty from '../../properties/textProperty.js'\nimport AlarmComponent from '../nested/alarmComponent.js'\nimport TriggerProperty from '../../properties/triggerProperty.js'\nimport { getConfig } from '../../config.js'\nimport { getConstructorForComponentName } from '../nested'\n\n/**\n * @class AbstractRecurringComponent\n * @classdesc AbstractRecurringComponent is the basis for\n * EventComponent, JournalComponent and TodoComponent.\n *\n * It contains all the logic for recurrence-expansion and\n * recurrence-management plus all management for all\n * properties and all subcomponents that the three\n * components mentioned before have in common\n */\nexport default class AbstractRecurringComponent extends AbstractComponent {\n\n\t/**\n\t * @inheritDoc\n\t */\n\tconstructor(...args) {\n\t\tsuper(...args)\n\n\t\t/**\n\t\t * In case this object is virtual, primary item refers to the master object\n\t\t * that this object was forked from.\n\t\t *\n\t\t * Otherwise primary item is null\n\t\t *\n\t\t * @type {AbstractRecurringComponent}\n\t\t * @private\n\t\t */\n\t\tthis._primaryItem = null\n\n\t\t/**\n\t\t * Indicator whether this is a direct fork of a primary item, representing\n\t\t * the very same recurrence id\n\t\t *\n\t\t * @type {boolean}\n\t\t * @private\n\t\t */\n\t\tthis._isExactForkOfPrimary = false\n\n\t\t/**\n\t\t * The original recurrence-id of this occurrence.\n\t\t * Mostly needed for range exceptions with a range\n\t\t *\n\t\t * @type {DateTimeValue|null}\n\t\t * @private\n\t\t */\n\t\tthis._originalRecurrenceId = null\n\n\t\t/**\n\t\t * Instance of the recurrence manager.\n\t\t * This object is shared among all instances\n\t\t * of a recurrence-set\n\t\t *\n\t\t * @type {RecurrenceManager}\n\t\t * @private\n\t\t */\n\t\tthis._recurrenceManager = null\n\n\t\t/**\n\t\t * Indicator whether this component was modified\n\t\t * In case it was, the last-modified property\n\t\t * needs to be updated before saving the event\n\t\t *\n\t\t * @type {boolean}\n\t\t * @private\n\t\t */\n\t\tthis._dirty = false\n\n\t\t/**\n\t\t * Indicator whether there have been significant changes\n\t\t * In case the changes are considered significant,\n\t\t * the sequence needs to be incremented\n\t\t *\n\t\t * @type {boolean}\n\t\t * @private\n\t\t */\n\t\tthis._significantChange = false\n\n\t\t/**\n\t\t * Id of this AbstractRecurringComponent\n\t\t *\n\t\t * @type {String|null}\n\t\t * @private\n\t\t */\n\t\tthis._cachedId = null\n\t}\n\n\t/**\n\t * Gets the primary-item of this recurring item\n\t *\n\t * @returns {AbstractRecurringComponent}\n\t */\n\tget primaryItem() {\n\t\treturn this._primaryItem\n\t}\n\n\t/**\n\t * Sets the primary-item of this recurring item\n\t *\n\t * @param {AbstractRecurringComponent} primaryItem The new primary-item\n\t */\n\tset primaryItem(primaryItem) {\n\t\tthis._modify()\n\t\tthis._primaryItem = primaryItem\n\t}\n\n\t/**\n\t * Gets whether or not this is a fork of the primary item\n\t * for the same recurrence-id\n\t *\n\t * @returns {boolean}\n\t */\n\tget isExactForkOfPrimary() {\n\t\treturn this._isExactForkOfPrimary\n\t}\n\n\t/**\n\t * Sets the isExactForkOfPrimary indicator, see getter for description\n\t *\n\t * @param {boolean} isExactForkOfPrimary Whether or not this is an exact fork\n\t */\n\tset isExactForkOfPrimary(isExactForkOfPrimary) {\n\t\tthis._isExactForkOfPrimary = isExactForkOfPrimary\n\t}\n\n\t/**\n\t * Gets the original recurrence-id\n\t *\n\t * @returns {DateTimeValue}\n\t */\n\tget originalRecurrenceId() {\n\t\treturn this._originalRecurrenceId\n\t}\n\n\t/**\n\t * Sets the original recurrence-id\n\t *\n\t * @param {DateTimeValue} originalRecurrenceId The new original recurrence-id\n\t */\n\tset originalRecurrenceId(originalRecurrenceId) {\n\t\tthis._originalRecurrenceId = originalRecurrenceId\n\t}\n\n\t/**\n\t * Gets the recurrence-manager of this recurrence-set\n\t *\n\t * @returns {RecurrenceManager}\n\t */\n\tget recurrenceManager() {\n\t\treturn this._recurrenceManager\n\t}\n\n\t/**\n\t * Sets the recurrence-manager of this recurrence-set\n\t *\n\t * @param {RecurrenceManager} recurrenceManager The new recurrence-manager\n\t */\n\tset recurrenceManager(recurrenceManager) {\n\t\tthis._recurrenceManager = recurrenceManager\n\t}\n\n\t/**\n\t * Gets the master-item of this recurring item\n\t *\n\t * @returns {AbstractRecurringComponent}\n\t */\n\tget masterItem() {\n\t\treturn this.recurrenceManager.masterItem\n\t}\n\n\t/**\n\t * Returns whether this item is the master item\n\t *\n\t * @returns {boolean}\n\t */\n\tisMasterItem() {\n\t\treturn this.masterItem === this\n\t}\n\n\t/**\n\t * Gets a unique ID for this occurrence of the event\n\t *\n\t * Please note that if the same event occurs in multiple calendars,\n\t * this id will not be unique. Software using this library will have to\n\t * manually mix in the calendar id into this id\n\t *\n\t * @returns {String}\n\t */\n\tget id() {\n\t\tif (this._cachedId) {\n\t\t\treturn this._cachedId\n\t\t}\n\n\t\tif (this.startDate === null) {\n\t\t\tthis._cachedId = encodeURIComponent(this.uid)\n\t\t\treturn this._cachedId\n\t\t}\n\n\t\tthis._cachedId = [\n\t\t\tencodeURIComponent(this.uid),\n\t\t\tencodeURIComponent(this.getReferenceRecurrenceId().unixTime.toString()),\n\t\t].join('###')\n\n\t\treturn this._cachedId\n\t}\n\n\t/**\n\t * Gets the UID property\n\t *\n\t * @returns {String|null}\n\t */\n\tget uid() {\n\t\treturn this.getFirstPropertyFirstValue('UID')\n\t}\n\n\t/**\n\t * Sets the UID property and the UID property of all related exceptions\n\t *\n\t * @param {String} uid The new UID\n\t */\n\tset uid(uid) {\n\t\tthis._recurrenceManager.updateUID(uid)\n\t}\n\n\t/**\n\t * Gets the start date of the event\n\t *\n\t * @returns {DateTimeValue}\n\t */\n\tget startDate() {\n\t\treturn this.getFirstPropertyFirstValue('dtstart')\n\t}\n\n\t/**\n\t * Sets the start date of the event\n\t *\n\t * @param {DateTimeValue} start The new start-date to set\n\t */\n\tset startDate(start) {\n\t\tconst oldStartDate = this.startDate\n\t\tthis.updatePropertyWithValue('dtstart', start)\n\n\t\tif (this.isMasterItem()) {\n\t\t\tthis._recurrenceManager.updateStartDateOfMasterItem(start, oldStartDate)\n\t\t}\n\t}\n\n\t/**\n\t * Checks whether this item is part of a recurring set\n\t *\n\t * @returns {boolean}\n\t */\n\tisPartOfRecurrenceSet() {\n\t\treturn this.masterItem.isRecurring()\n\t}\n\n\t/**\n\t * Checks whether this component is recurring\n\t *\n\t * @returns {boolean}\n\t */\n\tisRecurring() {\n\t\treturn this.hasProperty('RRULE') || this.hasProperty('RDATE')\n\t}\n\n\t/**\n\t * Checks whether this component is a recurrence-exception\n\t *\n\t * @returns {boolean}\n\t */\n\tisRecurrenceException() {\n\t\treturn this.hasProperty('RECURRENCE-ID')\n\t}\n\n\t/**\n\t * Checks wether this component is a recurrence-exception\n\t * and whether it's modifying the future\n\t *\n\t * @returns {boolean}\n\t */\n\tmodifiesFuture() {\n\t\tif (!this.isRecurrenceException()) {\n\t\t\treturn false\n\t\t}\n\n\t\tconst property = this.getFirstProperty('RECURRENCE-ID')\n\t\treturn property.getParameterFirstValue('RANGE') === 'THISANDFUTURE'\n\t}\n\n\t/**\n\t * Creates an occurrence at the given time\n\t *\n\t * This is an internal function for calendar-js, used by the recurrence-manager\n\t * Do not call from outside\n\t *\n\t * @param {DateTimeValue} recurrenceId The recurrence-Id of the forked item\n\t * @param {DurationValue=} startDiff to be used when The start-diff (used for RECURRENCE-ID;RANGE=THISANDFUTURE)\n\t * @returns {AbstractRecurringComponent}\n\t */\n\tforkItem(recurrenceId, startDiff = null) {\n\t\tconst occurrence = this.clone()\n\n\t\toccurrence.recurrenceManager = this.recurrenceManager\n\t\toccurrence.primaryItem = this\n\n\t\t// Exact match for master item or recurrence-exception\n\t\tif (occurrence.getReferenceRecurrenceId().compare(recurrenceId) === 0) {\n\t\t\toccurrence.isExactForkOfPrimary = true\n\t\t}\n\n\t\tif (!occurrence.hasProperty('DTSTART')) {\n\t\t\tthrow new TypeError('Can\\'t fork item without a DTSTART')\n\t\t}\n\n\t\tif (occurrence.getFirstPropertyFirstValue('DTSTART').timezoneId !== recurrenceId.timezoneId) {\n\t\t\tconst originalTimezone = occurrence.getFirstPropertyFirstValue('DTSTART').getICALTimezone()\n\t\t\trecurrenceId = recurrenceId.getInICALTimezone(originalTimezone)\n\t\t}\n\n\t\toccurrence.originalRecurrenceId = recurrenceId.clone()\n\n\t\tconst dtStartValue = occurrence.getFirstPropertyFirstValue('DTSTART')\n\n\t\tlet period = null\n\t\tif (this._recurrenceManager.hasRecurrenceDate(false, recurrenceId)) {\n\t\t\tconst recurrenceDate = this._recurrenceManager.getRecurrenceDate(false, recurrenceId)\n\t\t\tif (recurrenceDate instanceof PeriodValue) {\n\t\t\t\tperiod = recurrenceDate\n\t\t\t}\n\t\t}\n\n\t\tlet duration\n\t\tif (occurrence.hasProperty('DTEND')) {\n\t\t\tconst dtEndValue = occurrence.getFirstPropertyFirstValue('DTEND')\n\t\t\tduration = dtEndValue.subtractDateWithTimezone(dtStartValue)\n\t\t} else if (occurrence.hasProperty('DUE')) {\n\t\t\tconst dueValue = occurrence.getFirstPropertyFirstValue('DUE')\n\t\t\tduration = dueValue.subtractDateWithTimezone(dtStartValue)\n\t\t}\n\n\t\tif (!(occurrence.isRecurrenceException() && occurrence.isExactForkOfPrimary)) {\n\t\t\toccurrence.updatePropertyWithValue('DTSTART', recurrenceId.clone())\n\n\t\t\tif (startDiff) {\n\t\t\t\toccurrence.startDate.addDuration(startDiff)\n\t\t\t}\n\n\t\t\tif (occurrence.hasProperty('DTEND')) {\n\t\t\t\tconst dtEnd = occurrence.startDate.clone()\n\t\t\t\tdtEnd.addDuration(duration)\n\t\t\t\toccurrence.updatePropertyWithValue('DTEND', dtEnd)\n\t\t\t} else if (occurrence.hasProperty('DUE')) {\n\t\t\t\tconst due = occurrence.startDate.clone()\n\t\t\t\tdue.addDuration(duration)\n\t\t\t\toccurrence.updatePropertyWithValue('DUE', due)\n\t\t\t}\n\n\t\t\tif (period) {\n\t\t\t\toccurrence.deleteAllProperties('DTEND')\n\t\t\t\toccurrence.deleteAllProperties('DURATION')\n\n\t\t\t\toccurrence.updatePropertyWithValue('DTEND', period.end.clone())\n\t\t\t}\n\t\t}\n\n\t\toccurrence.resetDirty()\n\n\t\treturn occurrence\n\t}\n\n\t/**\n\t * Checks whether it's possible to create a recurrence exception for this event\n\t * It is possible\n\t *\n\t * @returns {boolean}\n\t */\n\tcanCreateRecurrenceExceptions() {\n\t\tlet primaryIsRecurring = false\n\t\tif (this.primaryItem && this.primaryItem.isRecurring()) {\n\t\t\tprimaryIsRecurring = true\n\t\t}\n\t\treturn this.isRecurring() || this.modifiesFuture() || (!this.isRecurring() && primaryIsRecurring)\n\t}\n\n\t/**\n\t * creates a recurrence exception based on this event\n\t * If the parameter thisAndAllFuture is set to true,\n\t * it will apply changes to this and all future occurrences\n\t *\n\t * @param {boolean} thisAndAllFuture Whether to create an exception for this and all future\n\t * @returns {AbstractRecurringComponent[]} the AbstractRecurringComponent of the future events.\n\t * In case you set `thisAndAllFuture` to true, this will be an\n\t * AbstractRecurringComponent inside a entirely new calendar component\n\t */\n\tcreateRecurrenceException(thisAndAllFuture = false) {\n\t\tif (!this.canCreateRecurrenceExceptions()) {\n\t\t\tthrow new Error('Can\\'t create recurrence-exceptions for non-recurring items')\n\t\t}\n\n\t\tconst previousPrimaryItem = this.primaryItem\n\n\t\t/**\n\t\t * The overall support for RANGE=THISANDFUTURE is really bad.\n\t\t * Instead, we have to create a new event/journal/task and\n\t\t * set an until date on the old one.\n\t\t *\n\t\t * Also see:\n\t\t * - https://github.com/nextcloud/calendar/issues/7#issuecomment-292574813\n\t\t * - https://github.com/nextcloud/calendar/issues/7#issuecomment-299169143\n\t\t *\n\t\t * Right now, this replaces all future occurrence modifications,\n\t\t * including recurrence-exceptions, RDATES and EXDATES.\n\t\t * This is also how other CUAs handle it, but i would be happy\n\t\t * to put that up for discussion.\n\t\t *\n\t\t * Keeping future RDates + their recurrence-exceptions would be rather easy.\n\t\t * Updating recurrence-exceptions, that are based off normal recurrence rules,\n\t\t * could be very expensive.\n\t\t */\n\t\tif (thisAndAllFuture) {\n\t\t\tif (this.isExactForkOfPrimary) {\n\t\t\t\t// master item\n\t\t\t\tif (this.primaryItem.isMasterItem()) {\n\t\t\t\t\tthis._overridePrimaryItem()\n\t\t\t\t\treturn [this, this]\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.removeThisOccurrence(true)\n\t\t\tthis.recurrenceManager = new RecurrenceManager(this)\n\t\t\tthis._originalRecurrenceId = null\n\n\t\t\tthis.primaryItem = this\n\t\t\tthis.updatePropertyWithValue('UID', uuid())\n\t\t\tthis._cachedId = null\n\n\t\t\tthis.addRelation('SIBLING', previousPrimaryItem.uid)\n\t\t\tpreviousPrimaryItem.addRelation('SIBLING', this.uid)\n\n\t\t\t// delete to make sure all parameters are gone\n\t\t\tthis.deleteAllProperties('RECURRENCE-ID')\n\t\t\tthis.deleteAllProperties('RDATE')\n\t\t\tthis.deleteAllProperties('EXDATE')\n\t\t\tthis.updatePropertyWithValue('CREATED', DateTimeValue.fromJSDate(dateFactory(), true))\n\t\t\tthis.updatePropertyWithValue('DTSTAMP', DateTimeValue.fromJSDate(dateFactory(), true))\n\t\t\tthis.updatePropertyWithValue('LAST-MODIFIED', DateTimeValue.fromJSDate(dateFactory(), true))\n\t\t\tthis.updatePropertyWithValue('SEQUENCE', 0)\n\t\t\tthis._significantChange = false\n\t\t\tthis._dirty = false\n\n\t\t\tthis.root = this.root.constructor.fromEmpty()\n\t\t\tthis.root.addComponent(this)\n\t\t\tthis.parent = this.root\n\n\t\t\t// this is a completely new event, we should set the RSVP of all attendees to true,\n\t\t\t// so that they receive an invitation to the new event, not only the cancellation of the old one\n\t\t\tfor (const attendee of this.getAttendeeIterator()) {\n\t\t\t\tattendee.rsvp = true\n\t\t\t}\n\t\t} else {\n\t\t\t// delete to make sure all parameters are gone\n\t\t\tthis.deleteAllProperties('RECURRENCE-ID')\n\t\t\tthis.recurrenceId = this.getReferenceRecurrenceId().clone()\n\t\t\tthis.root.addComponent(this)\n\t\t\tthis.recurrenceManager.relateRecurrenceException(this)\n\t\t\tthis.primaryItem = this\n\n\t\t\tthis.deleteAllProperties('RDATE')\n\t\t\tthis.deleteAllProperties('RRULE')\n\t\t\tthis.deleteAllProperties('EXDATE')\n\t\t\tthis.updatePropertyWithValue('CREATED', DateTimeValue.fromJSDate(dateFactory(), true))\n\t\t\tthis.updatePropertyWithValue('DTSTAMP', DateTimeValue.fromJSDate(dateFactory(), true))\n\t\t\tthis.updatePropertyWithValue('LAST-MODIFIED', DateTimeValue.fromJSDate(dateFactory(), true))\n\t\t\tthis.updatePropertyWithValue('SEQUENCE', 0)\n\n\t\t\tif (this.recurrenceManager.hasRecurrenceDate(false, this.getReferenceRecurrenceId())) {\n\t\t\t\tconst recurDate = this.recurrenceManager.getRecurrenceDate(false, this.getReferenceRecurrenceId())\n\t\t\t\tif (recurDate instanceof PeriodValue) {\n\t\t\t\t\tconst valueDateTimeRecurDate = recurDate.start\n\t\t\t\t\tthis.recurrenceManager.removeRecurrenceDate(false, recurDate)\n\t\t\t\t\tthis.recurrenceManager.addRecurrenceDate(false, valueDateTimeRecurDate)\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.originalRecurrenceId = null\n\t\t}\n\n\t\treturn [previousPrimaryItem, this]\n\t}\n\n\t/**\n\t * Deletes this occurrence from the series of recurring events\n\t * If the parameter thisAndAllFuture is set to true,\n\t * it will remove this and all future occurrences\n\t *\n\t * @param {Boolean} thisAndAllFuture Whether to create an exception for this and all future\n\t * @throws EmptyRecurrenceSetError Thrown, when deleting an occurrence results in no more events\n\t * @returns {Boolean} true if this deleted the last occurrence in set, false if there are occurrences left\n\t */\n\tremoveThisOccurrence(thisAndAllFuture = false) {\n\t\tif (!this.isPartOfRecurrenceSet()) {\n\t\t\t// When deleting an object, that's not part of a recurring set,\n\t\t\t// the calendar-document would be empty.\n\t\t\treturn true\n\t\t}\n\n\t\tif (thisAndAllFuture) {\n\t\t\t// To get the UNTIL date, just deduct one second.\n\t\t\t// That's also how macOS does it, so this should be fairly\n\t\t\t// well supported among all clients\n\t\t\tconst recurrenceId = this.getReferenceRecurrenceId().clone()\n\n\t\t\tconst until = recurrenceId.getInTimezone(Timezone.utc)\n\t\t\tuntil.addDuration(DurationValue.fromSeconds(-1))\n\n\t\t\tfor (const recurValue of this.recurrenceManager.getRecurrenceRuleIterator()) {\n\t\t\t\trecurValue.until = until.clone()\n\t\t\t}\n\n\t\t\tfor (const recurDate of this.recurrenceManager.getRecurrenceDateIterator()) {\n\t\t\t\tlet valueToCheck = recurDate\n\t\t\t\tif (recurDate instanceof PeriodValue) {\n\t\t\t\t\tvalueToCheck = valueToCheck.start\n\t\t\t\t}\n\n\t\t\t\tif (recurrenceId.compare(valueToCheck) <= 0) {\n\t\t\t\t\tthis.recurrenceManager.removeRecurrenceDate(false, recurDate)\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor (const exceptionDate of this.recurrenceManager.getRecurrenceDateIterator(true)) {\n\t\t\t\tif (recurrenceId.compare(exceptionDate) <= 0) {\n\t\t\t\t\tthis.recurrenceManager.removeRecurrenceDate(true, exceptionDate)\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor (const exception of this.recurrenceManager.getRecurrenceExceptionList()) {\n\t\t\t\tif (recurrenceId.compare(exception.recurrenceId) <= 0) {\n\t\t\t\t\tthis.root.deleteComponent(exception)\n\t\t\t\t\tthis.recurrenceManager.removeRecurrenceException(exception)\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\t// Make sure we don't leave orphaned recurrence-exceptions\n\t\t\tif (this.isRecurrenceException() && !this.modifiesFuture()) {\n\t\t\t\tthis.root.deleteComponent(this)\n\t\t\t\tthis.recurrenceManager.removeRecurrenceException(this)\n\t\t\t}\n\n\t\t\t// If this is based on a recurrence-date, simply delete it\n\t\t\t// otherwise add an exception-date\n\t\t\tif (this.recurrenceManager.hasRecurrenceDate(false, this.getReferenceRecurrenceId())) {\n\t\t\t\tconst recurDate = this.recurrenceManager.getRecurrenceDate(false, this.getReferenceRecurrenceId())\n\t\t\t\tthis.recurrenceManager.removeRecurrenceDate(false, recurDate)\n\t\t\t} else {\n\t\t\t\tthis.recurrenceManager.addRecurrenceDate(true, this.getReferenceRecurrenceId().clone())\n\t\t\t}\n\t\t}\n\n\t\treturn this.recurrenceManager.isEmptyRecurrenceSet()\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tclone() {\n\t\tconst comp = super.clone()\n\t\tcomp.resetDirty()\n\n\t\treturn comp\n\t}\n\n\t/**\n\t * Adds a new attendee\n\t *\n\t * @param {AttendeeProperty} attendee The attendee property to add\n\t * @private\n\t * @returns {boolean}\n\t */\n\t_addAttendee(attendee) {\n\t\t// Check for different Attendee objects with the same uri\n\t\tfor (const a of this.getAttendeeIterator()) {\n\t\t\tif (a.email === attendee.email) {\n\t\t\t\treturn false\n\t\t\t}\n\t\t}\n\n\t\tthis.addProperty(attendee)\n\t\treturn true\n\t}\n\n\t/**\n\t * Adds a new attendee based on their name and email-address\n\t *\n\t * @param {String} name The name of the attendee to add\n\t * @param {String} email The email-address of the attendee to add\n\t * @returns {boolean}\n\t */\n\taddAttendeeFromNameAndEMail(name, email) {\n\t\tconst attendeeProperty = AttendeeProperty.fromNameAndEMail(name, email)\n\t\treturn this._addAttendee(attendeeProperty)\n\t}\n\n\t/**\n\t * Adds a new attendee based on their properties\n\t *\n\t * @param {String} name The name of the attendee to add\n\t * @param {String} email The email-address of the attendee to add\n\t * @param {String} role The role of the attendee to add\n\t * @param {String} userType The type of attendee to add\n\t * @param {Boolean} rsvp Whether or not to request a response from the attendee\n\t * @returns {boolean}\n\t */\n\taddAttendeeFromNameEMailRoleUserTypeAndRSVP(name, email, role, userType, rsvp) {\n\t\tconst attendeeProperty = AttendeeProperty.fromNameEMailRoleUserTypeAndRSVP(name, email, role, userType, rsvp, false)\n\t\treturn this._addAttendee(attendeeProperty)\n\t}\n\n\t/**\n\t * Sets the organiser property from common-name and email address\n\t *\n\t * @param {String} name The name of the organizer\n\t * @param {String} email The email-address of the organizer\n\t */\n\tsetOrganizerFromNameAndEMail(name, email) {\n\t\tthis.deleteAllProperties('ORGANIZER')\n\t\tthis.addProperty(AttendeeProperty.fromNameAndEMail(name, email, true))\n\t}\n\n\t/**\n\t * Adds a new attachment from raw data\n\t *\n\t * @param {String} data The data of the attachment\n\t * @param {String} formatType The mime-type of the attachment\n\t */\n\taddAttachmentFromData(data, formatType = null) {\n\t\tthis.addProperty(AttachmentProperty.fromData(data, formatType))\n\t}\n\n\t/**\n\t * Adds a new attachment from a link\n\t *\n\t * @param {String} uri The URI of the attachment\n\t * @param {String} formatType The mime-type of the attachment\n\t */\n\taddAttachmentFromLink(uri, formatType = null) {\n\t\tthis.addProperty(AttachmentProperty.fromLink(uri, formatType))\n\t}\n\n\t/**\n\t * Adds a new contact\n\t *\n\t * @url https://tools.ietf.org/html/rfc5545#section-3.8.4.2\n\t *\n\t * @param {String} contact The textual contact description to add\n\t */\n\taddContact(contact) {\n\t\tthis.addProperty(new TextProperty('CONTACT', contact))\n\t}\n\n\t/**\n\t * Adds a new comment\n\t *\n\t * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.4\n\t *\n\t * @param {String} comment The comment to add\n\t */\n\taddComment(comment) {\n\t\tthis.addProperty(new TextProperty('COMMENT', comment))\n\t}\n\n\t/**\n\t * Adds a new image from raw data\n\t *\n\t * @param {String} data Data of the image to add\n\t * @param {String=} display What display-type the image is optimized for\n\t * @param {String=} formatType The mime-type of the image\n\t */\n\taddImageFromData(data, display = null, formatType = null) {\n\t\tthis.addProperty(ImageProperty.fromData(data, display, formatType))\n\t}\n\n\t/**\n\t * Adds a new image from a link\n\t *\n\t * @param {String} uri The URI of the image to add\n\t * @param {String=} display What display-type the image is optimized for\n\t * @param {String=} formatType The mime-type of the image\n\t */\n\taddImageFromLink(uri, display = null, formatType = null) {\n\t\tthis.addProperty(ImageProperty.fromLink(uri, display, formatType))\n\t}\n\n\t/**\n\t * Creates a new RELATED-TO property based on a relation-type and id\n\t * and adds it to this object\n\t *\n\t * @param {String} relType The type of relation to add\n\t * @param {String} relId The id of the related calendar-document\n\t */\n\taddRelation(relType, relId) {\n\t\tthis.addProperty(RelationProperty.fromRelTypeAndId(relType, relId))\n\t}\n\n\t/**\n\t * Creates a new REQUEST-STATUS property based on code and message\n\t * and adds it to this object\n\t *\n\t * @param {Number} code The status-code of the request status\n\t * @param {String} message The message of the request status\n\t */\n\taddRequestStatus(code, message) {\n\t\tthis.addProperty(RequestStatusProperty.fromCodeAndMessage(code, message))\n\t}\n\n\t/**\n\t * Adds a new absolute alarm based on action and trigger time\n\t *\n\t * @param {String} action The type of alarm Action\n\t * @param {DateTimeValue} alarmTime The trigger time of the alarm\n\t * @returns {AlarmComponent}\n\t */\n\taddAbsoluteAlarm(action, alarmTime) {\n\t\tconst alarmComp = new AlarmComponent('VALARM', [\n\t\t\t['action', action],\n\t\t\tTriggerProperty.fromAbsolute(alarmTime),\n\t\t])\n\n\t\tthis.addComponent(alarmComp)\n\t\treturn alarmComp\n\t}\n\n\t/**\n\t * Adds a new relative alarm based on action, trigger time and relativeTo parameter\n\t *\n\t * @param {String} action The type of alarm Action\n\t * @param {DurationValue} alarmOffset The trigger time of the alarm\n\t * @param {Boolean=} relatedToStart Whether or not the alarm is related to the event's start\n\t * @returns {AlarmComponent}\n\t */\n\taddRelativeAlarm(action, alarmOffset, relatedToStart = true) {\n\t\tconst alarmComp = new AlarmComponent('VALARM', [\n\t\t\t['action', action],\n\t\t\tTriggerProperty.fromRelativeAndRelated(alarmOffset, relatedToStart),\n\t\t])\n\n\t\tthis.addComponent(alarmComp)\n\t\treturn alarmComp\n\t}\n\n\t/**\n\t * Marks a certain property as edited\n\t *\n\t * @param {String} propertyName The name of the property\n\t */\n\tmarkPropertyAsDirty(propertyName) {\n\t\tthis.markDirty()\n\n\t\t// Properties that must be considered a significant change\n\t\t// according to RFC 5546 Section 2.1.4\n\t\tconst props = [\n\t\t\t'DTSTART',\n\t\t\t'DTEND',\n\t\t\t'DURATION',\n\t\t\t'RRULE',\n\t\t\t'RDATE',\n\t\t\t'EXDATE',\n\t\t\t'STATUS',\n\t\t\t...getConfig('property-list-significant-change', []),\n\t\t]\n\n\t\tif (props.includes(uc(propertyName))) {\n\t\t\tthis.markChangesAsSignificant()\n\t\t}\n\t}\n\n\t/**\n\t * Marks a certain component as edited\n\t *\n\t * @param {String} componentName The name of the component\n\t */\n\tmarkSubComponentAsDirty(componentName) {\n\t\tthis.markDirty()\n\n\t\tif (getConfig('component-list-significant-change', []).includes(componentName)) {\n\t\t\tthis.markChangesAsSignificant()\n\t\t}\n\t}\n\n\t/**\n\t * Returns whether or not this component is dirty\n\t *\n\t * @returns {boolean}\n\t */\n\tisDirty() {\n\t\treturn this._dirty || this._significantChange\n\t}\n\n\t/**\n\t * Marks this object as dirty\n\t */\n\tmarkDirty() {\n\t\tthis._dirty = true\n\t}\n\n\t/**\n\t * Marks changes as significant. Can be called by the program using this lib\n\t */\n\tmarkChangesAsSignificant() {\n\t\tthis._significantChange = true\n\t}\n\n\t/**\n\t * Updates the event after modifications.\n\t *\n\t * @returns {boolean} true if last-modified was updated\n\t */\n\tundirtify() {\n\t\tif (!this.isDirty()) {\n\t\t\treturn false\n\t\t}\n\n\t\tif (!this.hasProperty('SEQUENCE')) {\n\t\t\tthis.sequence = 0\n\t\t}\n\n\t\tthis.updatePropertyWithValue('DTSTAMP', DateTimeValue.fromJSDate(dateFactory(), true))\n\t\tthis.updatePropertyWithValue('LAST-MODIFIED', DateTimeValue.fromJSDate(dateFactory(), true))\n\t\tif (this._significantChange) {\n\t\t\tthis.sequence++\n\t\t}\n\n\t\tthis.resetDirty()\n\n\t\treturn true\n\t}\n\n\t/**\n\t * Resets the dirty indicators without updating DTSTAMP or LAST-MODIFIED\n\t */\n\tresetDirty() {\n\t\tthis._dirty = false\n\t\tthis._significantChange = false\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tupdatePropertyWithValue(propertyName, value) {\n\t\tsuper.updatePropertyWithValue(propertyName, value)\n\n\t\tif (uc(propertyName) === 'UID') {\n\t\t\tthis._cachedId = null\n\t\t}\n\n\t\tthis.markPropertyAsDirty(propertyName)\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\taddProperty(property) {\n\t\tthis.markPropertyAsDirty(property.name)\n\t\tproperty.subscribe(() => this.markPropertyAsDirty(property.name))\n\t\treturn super.addProperty(property)\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tdeleteProperty(property) {\n\t\tthis.markPropertyAsDirty(property.name)\n\t\treturn super.deleteProperty(property)\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tdeleteAllProperties(propertyName) {\n\t\tthis.markPropertyAsDirty(propertyName)\n\t\treturn super.deleteAllProperties(propertyName)\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\taddComponent(component) {\n\t\tthis.markSubComponentAsDirty(component.name)\n\t\tcomponent.subscribe(() => this.markSubComponentAsDirty(component.name))\n\t\treturn super.addComponent(component)\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tdeleteComponent(component) {\n\t\tthis.markSubComponentAsDirty(component.name)\n\t\treturn super.deleteComponent(component)\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tdeleteAllComponents(componentName) {\n\t\tthis.markSubComponentAsDirty(componentName)\n\t\treturn super.deleteAllComponents(componentName)\n\t}\n\n\t/**\n\t * Gets a recurrence-id that has to be used to refer to this event.\n\t * This is used for recurrence-management\n\t *\n\t * @returns {DateTimeValue}\n\t */\n\tgetReferenceRecurrenceId() {\n\t\tif (this.originalRecurrenceId) {\n\t\t\treturn this.originalRecurrenceId\n\t\t} else if (this.recurrenceId) {\n\t\t\treturn this.recurrenceId\n\t\t} else {\n\t\t\treturn this.startDate\n\t\t}\n\t}\n\n\t/**\n\t * Overrides the master item with this one\n\t *\n\t * @private\n\t */\n\t_overridePrimaryItem() {\n\t\tconst oldStartDate = this.primaryItem.startDate\n\n\t\tfor (const property of this.primaryItem.getPropertyIterator()) {\n\t\t\tthis.primaryItem.deleteProperty(property)\n\t\t}\n\n\t\tfor (const property of this.getPropertyIterator()) {\n\t\t\tthis.primaryItem.addProperty(property)\n\t\t}\n\n\t\tthis.recurrenceManager.resetCache()\n\t\tif (this.startDate.compare(oldStartDate) !== 0) {\n\t\t\tthis.recurrenceManager.updateStartDateOfMasterItem(this.startDate, oldStartDate)\n\t\t}\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tstatic _getConstructorForComponentName(componentName) {\n\t\treturn getConstructorForComponentName(componentName)\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tstatic fromICALJs(...args) {\n\t\tconst comp = super.fromICALJs(...args)\n\t\tcomp.resetDirty()\n\n\t\treturn comp\n\t}\n\n}\n\n/**\n * Date-Time stamp of this object.\n * It has different meaning, based on whether or not a method is defined\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.7.2\n *\n * @name EventComponent#stampTime\n * @type {String}\n */\nadvertiseSingleOccurrenceProperty(AbstractRecurringComponent.prototype, {\n\tname: 'stampTime',\n\tiCalendarName: 'DTSTAMP',\n})\n\n/**\n * Recurrence-ID of this object, used for recurrence-exceptions\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.4.4\n *\n * @name EventComponent#recurrenceId\n * @type {String}\n */\nadvertiseSingleOccurrenceProperty(AbstractRecurringComponent.prototype, {\n\tname: 'recurrenceId',\n\tiCalendarName: 'RECURRENCE-ID',\n})\n\n/**\n * Special color for this event / journal / task\n *\n * @url https://tools.ietf.org/html/rfc7986#section-5.9\n *\n * @name EventComponent#color\n * @type {String}\n */\nadvertiseSingleOccurrenceProperty(AbstractRecurringComponent.prototype, 'color')\n\n/**\n * Creation Time of this event / journal / task\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.7.1\n *\n * @name EventComponent#creationTime\n * @type {String}\n */\nadvertiseSingleOccurrenceProperty(AbstractRecurringComponent.prototype, {\n\tname: 'creationTime',\n\tiCalendarName: 'CREATED',\n})\n\n/**\n * The time this event / journal / task\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.7.3\n *\n * @name EventComponent#modificationTime\n * @type {String}\n */\nadvertiseSingleOccurrenceProperty(AbstractRecurringComponent.prototype, {\n\tname: 'modificationTime',\n\tiCalendarName: 'LAST-MODIFIED',\n})\n\n/**\n * Organizer of this event / journal / task\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.4.3\n *\n * @name EventComponent#organizer\n * @type {String}\n */\nadvertiseSingleOccurrenceProperty(AbstractRecurringComponent.prototype, 'organizer')\n\n/**\n * Revision of this this event / journal / task\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.7.4\n *\n * @name EventComponent#sequence\n * @type {String}\n */\nadvertiseSingleOccurrenceProperty(AbstractRecurringComponent.prototype, 'sequence')\n\n/**\n * Status of this event / journal / task\n * This indicates whether an event is tentative / confirmed / cancelled\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.11\n *\n * @name EventComponent#status\n * @type {String}\n */\nadvertiseSingleOccurrenceProperty(AbstractRecurringComponent.prototype, 'status')\n\n/**\n * URL of a more dynamic rendition of this event / journal / task\n * DO NOT use this to simply point to a website merely related.\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.4.6\n *\n * @name EventComponent#url\n * @type {String}\n */\nadvertiseSingleOccurrenceProperty(AbstractRecurringComponent.prototype, 'url')\n\n/**\n * Title of this event / journal / task\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.12\n *\n * @name EventComponent#title\n * @type {String}\n */\nadvertiseSingleOccurrenceProperty(AbstractRecurringComponent.prototype, {\n\tname: 'title',\n\tiCalendarName: 'SUMMARY',\n})\n\n/**\n * Access class of this event / journal / task\n * This determines what other users can see when sharing\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.3\n *\n * @name EventComponent#accessClass\n * @type {String}\n */\nadvertiseSingleOccurrenceProperty(AbstractRecurringComponent.prototype, {\n\tname: 'accessClass',\n\tiCalendarName: 'class',\n\tallowedValues: ['PUBLIC', 'PRIVATE', 'CONFIDENTIAL'],\n\tdefaultValue: 'PUBLIC',\n\tunknownValue: 'PRIVATE',\n})\n\n/**\n * Returns an iterator over all categories\n * If the parameter lang is given, it will only\n * return an iterator for Categories matching that language\n *\n * @name AbstractRecurringComponent#getCategoryIterator\n * @function\n * @param {String=} lang\n * @returns {IterableIterator<String>}\n */\n\n/**\n * Returns a list of all categories\n * If the parameter lang is given, it will only\n * return an iterator for Categories matching that language\n *\n * @name AbstractRecurringComponent#getCategoryList\n * @function\n * @param {String=} lang\n * @returns {String[]}\n */\n\n/**\n * Adds a new category\n *\n * @name AbstractRecurringComponent#addCategory\n * @function\n * @param {String} category\n * @param {String=} lang\n */\n\n/**\n * Removes a category\n *\n * @name AbstractRecurringComponent#removeCategory\n * @function\n * @param {String} category\n * @param {String=} lang\n */\n\n/**\n * Clear all categories of a given language\n *\n * @name AbstractRecurringComponent#clearAllCategories\n * @function\n */\nadvertiseMultiValueStringPropertySeparatedByLang(AbstractRecurringComponent.prototype, {\n\tname: 'category',\n\tpluralName: 'categories',\n\tiCalendarName: 'CATEGORIES',\n})\n\n/**\n * Returns an iterator over all attendees\n *\n * @name AbstractRecurringComponent#getAttendeeIterator\n * @function\n * @returns {IterableIterator<AttendeeProperty>}\n */\n\n/**\n * Gets a list of all attendees\n *\n * @name AbstractRecurringComponent#getAttendeeList\n * @function\n * @returns {AttachmentProperty[]}\n */\n\n/**\n * Removes an attendee from this event / journal / task\n *\n * @name AbstractRecurringComponent#removeAttendee\n * @function\n * @param {AttendeeProperty} attendee\n */\n\n/**\n * Removes all attendees from this event / journal / task\n *\n * @name AbstractRecurringComponent#clearAllAttendees\n * @function\n */\nadvertiseMultipleOccurrenceProperty(AbstractRecurringComponent.prototype, {\n\tname: 'attendee',\n})\n\n/**\n * Returns an iterator over all attachments\n *\n * @name AbstractRecurringComponent#getAttachmentIterator\n * @function\n * @returns {IterableIterator<AttachmentProperty>}\n */\n\n/**\n * Gets a list of all attachments\n *\n * @name AbstractRecurringComponent#getAttachmentList\n * @function\n * @returns {AttachmentProperty[]}\n */\n\n/**\n * Removes one attachment from this event / journal / task\n *\n * @name AbstractRecurringComponent#removeAttachment\n * @function\n * @param {AttachmentProperty} attachment\n */\n\n/**\n * Removes all attachments from this event / journal / task\n *\n * @name AbstractRecurringComponent#clearAllAttachments\n * @function\n */\nadvertiseMultipleOccurrenceProperty(AbstractRecurringComponent.prototype, {\n\tname: 'attachment',\n\tiCalendarName: 'ATTACH',\n})\n\n/**\n * Returns an iterator over all relation properties\n *\n * @name AbstractRecurringComponent#getRelationIterator\n * @function\n * @returns {IterableIterator<RelationProperty>}\n */\n\n/**\n * Returns a list of all relation properties\n *\n * @name AbstractRecurringComponent#getRelationList\n * @function\n * @returns {RelationProperty[]}\n */\n\n/**\n * Removes a relation from this event / journal / task\n *\n * @name AbstractRecurringComponent#removeRelation\n * @function\n * @param {RelationProperty} relation\n */\n\n/**\n * Removes all relations from this event / journal / task\n *\n * @name AbstractRecurringComponent#clearAllRelations\n * @function\n */\nadvertiseMultipleOccurrenceProperty(AbstractRecurringComponent.prototype, {\n\tname: 'relation',\n\tiCalendarName: 'RELATED-TO',\n})\n\n/**\n * Returns an iterator over all comments in this event / journal / task\n *\n * @name AbstractRecurringComponent#getCommentIterator\n * @function\n * @returns {IterableIterator<TextProperty>}\n */\n\n/**\n * Returns a list of all comments in this event / journal / task\n *\n * @name AbstractRecurringComponent#getCommentList\n * @function\n * @returns {TextProperty[]}\n */\n\n/**\n * Removes a comment from this event / journal / task\n *\n * @name AbstractRecurringComponent#removeComment\n * @function\n * @param {TextProperty} comment\n */\n\n/**\n * Removes all comments from this event / journal / task\n *\n * @name AbstractRecurringComponent#clearAllComments\n * @function\n */\nadvertiseMultipleOccurrenceProperty(AbstractRecurringComponent.prototype, 'comment')\n\n/**\n * Returns an iterator over all contacts referenced in this event / journal / task\n *\n * @name AbstractRecurringComponent#getContactIterator\n * @function\n * @returns {IterableIterator<TextProperty>}\n */\n\n/**\n * Returns a list of all contacts referenced in this event / journal / task\n *\n * @name AbstractRecurringComponent#getContactList\n * @function\n * @returns {TextProperty[]}\n */\n\n/**\n * Removes one contact from this event / journal / task\n *\n * @name AbstractRecurringComponent#removeContact\n * @function\n * @param {TextProperty} contact\n */\n\n/**\n * Removes all contacts from this event / journal / task\n *\n * @name AbstractRecurringComponent#clearAllContacts\n * @function\n */\nadvertiseMultipleOccurrenceProperty(AbstractRecurringComponent.prototype, 'contact')\n\n/**\n * Returns an iterator over all image properties\n *\n * @name AbstractRecurringComponent#getImageIterator\n * @function\n * @returns {IterableIterator<ImageProperty>}\n */\n\n/**\n * Returns a list of all image properties\n *\n * @name AbstractRecurringComponent#getImageList\n * @function\n * @returns {ImageProperty[]}\n */\n\n/**\n * Removes one image from this event / journal / task\n *\n * @name AbstractRecurringComponent#removeImage\n * @function\n * @param {ImageProperty} image\n */\n\n/**\n * Removes all images from this event / journal / task\n *\n * @name AbstractRecurringComponent#clearAllImages\n * @function\n */\nadvertiseMultipleOccurrenceProperty(AbstractRecurringComponent.prototype, 'image')\n\n/**\n * Returns an iterator over all request status\n *\n * @name AbstractRecurringComponent#getRequestStatusIterator\n * @function\n * @returns {IterableIterator<RequestStatusProperty>}\n */\n\n/**\n * Returns a list of all request status\n *\n * @name AbstractRecurringComponent#getRequestStatusList\n * @function\n * @returns {RequestStatusProperty[]}\n */\n\n/**\n * Removes one request status from this event / journal / task\n *\n * @name AbstractRecurringComponent#removeRequestStatus\n * @function\n * @param {RequestStatusProperty} requestStatus\n */\n\n/**\n * Removes all request status from this event / journal / task\n *\n * @name AbstractRecurringComponent#clearAllRequestStatus\n * @function\n */\nadvertiseMultipleOccurrenceProperty(AbstractRecurringComponent.prototype, {\n\tname: 'requestStatus',\n\tpluralName: 'requestStatus',\n\tiCalendarName: 'REQUEST-STATUS',\n})\n\n/**\n * Returns an iterator of all alarms\n *\n * @name AbstractRecurringComponent#getAlarmIterator\n * @function\n * @returns {IterableIterator<AlarmComponent>}\n */\n\n/**\n * Returns a list of all alarms\n *\n * @name AbstractRecurringComponent#getAlarmList\n * @function\n * @returns {AlarmComponent[]}\n */\n\n/**\n * Removes an alarm from this event / journal / task\n *\n * @name AbstractRecurringComponent#removeAlarm\n * @function\n * @param {AlarmComponent} alarm\n */\n\n/**\n * Removes all alarms from this event / journal / task\n *\n * @name AbstractRecurringComponent#clearAllAlarms\n * @function\n */\nadvertiseComponent(AbstractRecurringComponent.prototype, 'alarm')\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\n/**\n * Gets kind of birthday event\n * returns \"BDAY\", \"DEATHDATE\", \"ANNIVERSARY\"\n * or null if this is not a birthday event\n *\n * @param {EventComponent} eventComponent The eventComponent of the birthday event\n * @returns {null|string}\n */\nexport function getTypeOfBirthdayEvent(eventComponent) {\n\treturn eventComponent.getFirstPropertyFirstValue('X-NEXTCLOUD-BC-FIELD-TYPE')\n}\n\n/**\n * Gets icon for the birthday type\n *\n * @param {EventComponent} eventComponent The eventComponent of the birthday event\n * @returns {string|null}\n */\nexport function getIconForBirthday(eventComponent) {\n\tconst birthdayType = getTypeOfBirthdayEvent(eventComponent)\n\tswitch (birthdayType) {\n\tcase 'BDAY':\n\t\treturn ''\n\n\tcase 'DEATHDATE':\n\t\treturn ''\n\n\tcase 'ANNIVERSARY':\n\t\treturn ''\n\n\tdefault:\n\t\treturn null\n\t}\n}\n\n/**\n * Returns the age of the birthday person or null of no birth-year given\n *\n * @param {EventComponent} eventComponent The eventComponent of the birthday event\n * @param {number} yearOfOccurrence The year to calculate the age for\n * @returns {null|number}\n */\nexport function getAgeOfBirthday(eventComponent, yearOfOccurrence) {\n\tif (!eventComponent.hasProperty('X-NEXTCLOUD-BC-YEAR')) {\n\t\treturn null\n\t}\n\n\tconst yearOfBirth = eventComponent.getFirstPropertyFirstValue('X-NEXTCLOUD-BC-YEAR')\n\treturn parseInt(yearOfOccurrence, 10) - parseInt(yearOfBirth, 10)\n}\n\n/**\n * Returns the name of the birthday person or null if not set\n *\n * @param {EventComponent} eventComponent The eventComponent of the birthday event\n * @returns {null|string}\n */\nexport function getNameForBirthday(eventComponent) {\n\treturn eventComponent.getFirstPropertyFirstValue('X-NEXTCLOUD-BC-NAME')\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport AbstractRecurringComponent from './abstractRecurringComponent.js'\nimport {\n\tadvertiseMultipleOccurrenceProperty,\n\tadvertiseMultiValueStringPropertySeparatedByLang,\n\tadvertiseSingleOccurrenceProperty,\n} from '../abstractComponent.js'\nimport {\n\tgetAgeOfBirthday,\n\tgetIconForBirthday,\n\tgetTypeOfBirthdayEvent,\n} from '../../helpers/birthdayHelper.js'\nimport DurationValue from '../../values/durationValue.js'\nimport GeoProperty from '../../properties/geoProperty.js'\nimport ConferenceProperty from '../../properties/conferenceProperty.js'\n\n/**\n * @class EventComponent\n * @classdesc\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.6.1\n */\nexport default class EventComponent extends AbstractRecurringComponent {\n\n\t/**\n\t * Returns whether this event is an all-day event\n\t *\n\t * @returns {boolean}\n\t */\n\tisAllDay() {\n\t\treturn this.startDate.isDate && this.endDate.isDate\n\t}\n\n\t/**\n\t * Checks whether it's possible to switch from date-time to date or vise-versa\n\t *\n\t * @returns {boolean}\n\t */\n\tcanModifyAllDay() {\n\t\treturn !this.recurrenceManager.masterItem.isRecurring()\n\t}\n\n\t/**\n\t * Gets the calculated end-date of the event\n\t *\n\t * Quote from RFC 5545 3.6.1:\n\t * The \"DTSTART\" property for a \"VEVENT\" specifies the inclusive\n\t * start of the event.  For recurring events, it also specifies the\n\t * very first instance in the recurrence set.  The \"DTEND\" property\n\t * for a \"VEVENT\" calendar component specifies the non-inclusive end\n\t * of the event.  For cases where a \"VEVENT\" calendar component\n\t * specifies a \"DTSTART\" property with a DATE value type but no\n\t * \"DTEND\" nor \"DURATION\" property, the event's duration is taken to\n\t * be one day.  For cases where a \"VEVENT\" calendar component\n\t * specifies a \"DTSTART\" property with a DATE-TIME value type but no\n\t * \"DTEND\" property, the event ends on the same calendar date and\n\t * time of day specified by the \"DTSTART\" property.\n\t *\n\t * @returns {DateTimeValue}\n\t */\n\tget endDate() {\n\t\tif (this.hasProperty('dtend')) {\n\t\t\treturn this.getFirstPropertyFirstValue('dtend')\n\t\t}\n\n\t\tconst dtend = this.startDate.clone()\n\n\t\tif (this.hasProperty('duration')) {\n\t\t\tdtend.addDuration(this.getFirstPropertyFirstValue('duration'))\n\t\t} else if (this.startDate.isDate) {\n\t\t\tdtend.addDuration(DurationValue.fromSeconds(60 * 60 * 24))\n\t\t} // There is nothing to do when this event is not allday\n\n\t\treturn dtend\n\t}\n\n\t/**\n\t * Sets the end time of the event\n\t *\n\t * @param {DateTimeValue} end The end of the event\n\t */\n\tset endDate(end) {\n\t\tthis.deleteAllProperties('duration')\n\t\tthis.updatePropertyWithValue('dtend', end)\n\t}\n\n\t/**\n\t * Gets the calculated duration of the event\n\t *\n\t * @returns {DurationValue}\n\t */\n\tget duration() {\n\t\tif (this.hasProperty('duration')) {\n\t\t\treturn this.getFirstPropertyFirstValue('duration')\n\t\t}\n\n\t\treturn this.startDate.subtractDateWithTimezone(this.endDate)\n\t}\n\n\t/**\n\t * Sets the calculated duration of the event\n\t *\n\t * @param {DurationValue} duration The duration of the event\n\t */\n\tset duration(duration) {\n\t\tthis.deleteAllProperties('dtend')\n\t\tthis.updatePropertyWithValue('duration', duration)\n\t}\n\n\t/**\n\t * Sets the geographical position based on latitude and longitude\n\t *\n\t * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.6\n\t *\n\t * @param {Number} lat - latitude\n\t * @param {Number} long - longitude\n\t */\n\tsetGeographicalPositionFromLatitudeAndLongitude(lat, long) {\n\t\tthis.deleteAllProperties('GEO')\n\t\tthis.addProperty(GeoProperty.fromPosition(lat, long))\n\t}\n\n\t/**\n\t * Adds a new conference property based on URI, label and features\n\t *\n\t * @url https://tools.ietf.org/html/rfc7986#section-5.11\n\t *\n\t * @param {String} uri The URI of the conference system\n\t * @param {String=} label The label for the conference system\n\t * @param {String[]=} features The features of the conference system\n\t */\n\taddConference(uri, label = null, features = null) {\n\t\tthis._modify()\n\t\tthis.addProperty(ConferenceProperty.fromURILabelAndFeatures(uri, label, features))\n\t}\n\n\t/**\n\t * Adds a duration to the start of the event\n\t *\n\t * @param {DurationValue} duration The duration to add\n\t */\n\taddDurationToStart(duration) {\n\t\tthis.startDate.addDuration(duration)\n\t}\n\n\t/**\n\t * Adds a duration to the end of the event\n\t *\n\t * @param {DurationValue} duration The duration to add\n\t */\n\taddDurationToEnd(duration) {\n\t\tconst endDate = this.endDate\n\t\tendDate.addDuration(duration)\n\n\t\tthis.endDate = endDate\n\t}\n\n\t/**\n\t * Shifts the entire event by the given duration\n\t *\n\t * @param {DurationValue} delta The duration to shift event by\n\t * @param {Boolean} allDay Whether the updated event should be all-day or not\n\t * @param {Timezone} defaultTimezone The default timezone if moving from all-day to timed event\n\t * @param {DurationValue} defaultAllDayDuration The default all-day duration if moving from timed to all-day\n\t * @param {DurationValue} defaultTimedDuration The default timed duration if moving from all-day to timed\n\t */\n\tshiftByDuration(delta, allDay, defaultTimezone, defaultAllDayDuration, defaultTimedDuration) {\n\t\tconst currentAllDay = this.isAllDay()\n\n\t\tif (currentAllDay !== allDay && !this.canModifyAllDay()) {\n\t\t\tthrow new TypeError('Can\\'t modify all-day of this event')\n\t\t}\n\n\t\tthis.startDate.isDate = allDay\n\t\tthis.startDate.addDuration(delta)\n\n\t\t// If this event was moved from the all-day area into the time-grid,\n\t\t// then we have to add a timezone and the default duration\n\t\tif (currentAllDay && !allDay) {\n\t\t\tthis.startDate.replaceTimezone(defaultTimezone)\n\n\t\t\tthis.endDate = this.startDate.clone()\n\t\t\tthis.endDate.addDuration(defaultTimedDuration)\n\t\t}\n\n\t\t// If this event was moved from the time-grid into the all-day area,\n\t\t// then we have to change the default duration\n\t\tif (!currentAllDay && allDay) {\n\t\t\tthis.endDate = this.startDate.clone()\n\t\t\tthis.endDate.addDuration(defaultAllDayDuration)\n\t\t}\n\n\t\t// If this event was only moved inside the time-grid or only inside\n\t\t// the all-day area, then we only have to adjust the end-date\n\t\tif (currentAllDay === allDay) {\n\t\t\tconst endDate = this.endDate\n\t\t\tendDate.addDuration(delta)\n\t\t\tthis.endDate = endDate\n\t\t}\n\t}\n\n\t/**\n\t * Checks if this is a birthday event\n\t *\n\t * @returns {boolean}\n\t */\n\tisBirthdayEvent() {\n\t\treturn getTypeOfBirthdayEvent(this) === 'BDAY'\n\t}\n\n\t/**\n\t * Gets the icon to the birthday event\n\t *\n\t * @returns {string}\n\t */\n\tgetIconForBirthdayEvent() {\n\t\treturn getIconForBirthday(this)\n\t}\n\n\t/**\n\t * Calculates the age of the birthday\n\t *\n\t * @returns {number}\n\t */\n\tgetAgeForBirthdayEvent() {\n\t\treturn getAgeOfBirthday(this, this.startDate.year)\n\t}\n\n\t/**\n\t * Serializes the entire series to ICS\n\t *\n\t * @returns {string}\n\t */\n\ttoICSEntireSeries() {\n\t\treturn this.root.toICS()\n\t}\n\n\t/**\n\t * Serializes exactly this recurrence to ICS\n\t * It removes all recurrence information\n\t *\n\t * @returns {string}\n\t */\n\ttoICSThisOccurrence() {\n\t\tconst clone = this.clone()\n\n\t\tclone.deleteAllProperties('RRULE')\n\t\tclone.deleteAllProperties('EXRULE')\n\t\tclone.deleteAllProperties('RDATE')\n\t\tclone.deleteAllProperties('EXDATE')\n\t\tclone.deleteAllProperties('RECURRENCE-ID')\n\n\t\tclone.root = clone.root.constructor.fromEmpty()\n\t\tclone.parent = clone.root\n\t\tclone.root.addComponent(clone)\n\n\t\treturn clone.root.toICS()\n\t}\n\n\t/**\n\t * Checks if this event is in a given time-frame\n\t *\n\t * @param {DateTimeValue} start Start of time-range to check\n\t * @param {DateTimeValue} end End of time-range to check\n\t * @returns {boolean}\n\t */\n\tisInTimeFrame(start, end) {\n\t\treturn start.compare(this.endDate) <= 0 && end.compare(this.startDate) >= 0\n\t}\n\n}\n\n/**\n * Time-transparency of this event.\n * If set to TRANSPARENT, this event will be ignored for FREE/BUSY calculations.\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.2.7\n *\n * @name EventComponent#timeTransparency\n * @type {String}\n */\nadvertiseSingleOccurrenceProperty(EventComponent.prototype, {\n\tname: 'timeTransparency',\n\tiCalendarName: 'TRANSP',\n\tallowedValues: ['OPAQUE', 'TRANSPARENT'],\n\tdefaultValue: 'OPAQUE',\n})\n\n/**\n * Description of this event.\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.5\n *\n * @name EventComponent#description\n * @type {String}\n */\nadvertiseSingleOccurrenceProperty(EventComponent.prototype, 'description')\n\n/**\n * Geographical position of this event\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.6\n *\n * @name EventComponent#geographicalPosition\n * @type {String}\n */\nadvertiseSingleOccurrenceProperty(EventComponent.prototype, {\n\tname: 'geographicalPosition',\n\tiCalendarName: 'GEO',\n})\n\n/**\n * Location that this event takes place in\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.7\n *\n * @name EventComponent#location\n * @type {String}\n */\nadvertiseSingleOccurrenceProperty(EventComponent.prototype, 'location')\n\n/**\n * Priority of this event\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.9\n *\n * @name EventComponent#priority\n * @type Number\n */\nadvertiseSingleOccurrenceProperty(EventComponent.prototype, {\n\tname: 'priority',\n\tallowedValues: Array(9).keys(),\n\tdefaultValue: 0,\n\tunknownValue: 0,\n})\n\n/**\n * Returns an iterator over all resources\n * If the parameter lang is given, it will only\n * return an iterator for Resources matching that language\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.10\n *\n * @name EventComponent#getResourceIterator\n * @function\n * @param {String=} lang\n * @returns {IterableIterator<String>}\n */\n\n/**\n * Returns a list of all resources\n * If the parameter lang is given, it will only\n * return an iterator for resources matching that language\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.10\n *\n * @name EventComponent#getResourceList\n * @function\n * @param {String=} lang\n * @returns {String[]}\n */\n\n/**\n * Adds a resource\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.10\n *\n * @name EventComponent#addResource\n * @function\n * @param {String} resource\n * @param {String=} lang\n */\n\n/**\n * Removes a resource\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.10\n *\n * @name EventComponent#removeResource\n * @function\n * @param {String} resource\n * @param {String=} lang\n */\n\n/**\n * Removes all resources from this event\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.10\n *\n * @name EventComponent#clearAllResources\n * @function\n * @param {String=} lang\n */\nadvertiseMultiValueStringPropertySeparatedByLang(EventComponent.prototype, {\n\tname: 'resource',\n\tiCalendarName: 'RESOURCES',\n})\n\n/**\n * Gets an iterator over all conference properties\n *\n * @url https://tools.ietf.org/html/rfc7986#section-5.11\n *\n * @name EventComponent#getConferenceIterator\n * @function\n * @returns {IterableIterator<ConferenceProperty>}\n */\n\n/**\n * Gets a list of all conference properties\n *\n * @url https://tools.ietf.org/html/rfc7986#section-5.11\n *\n * @name EventComponent#getConferenceList\n * @function\n * @returns {ConferenceProperty[]}\n */\n\n/**\n * Removes a conference from this event\n *\n * @url https://tools.ietf.org/html/rfc7986#section-5.11\n *\n * @name EventComponent#removeConference\n * @function\n * @param {ConferenceProperty} conference\n */\n\n/**\n * Removes all conferences from this event\n *\n * @url https://tools.ietf.org/html/rfc7986#section-5.11\n *\n * @name EventComponent#clearAllConferences\n * @function\n */\nadvertiseMultipleOccurrenceProperty(EventComponent.prototype, 'conference')\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport AbstractComponent, {\n\tadvertiseMultipleOccurrenceProperty,\n\tadvertiseSingleOccurrenceProperty,\n} from '../abstractComponent.js'\nimport Timezone from '../../timezones/timezone.js'\nimport AttendeeProperty from '../../properties/attendeeProperty.js'\n\n/**\n * @class FreeBusyComponent\n * @classdesc\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.6.4\n */\nexport default class FreeBusyComponent extends AbstractComponent {\n\n\t/**\n\t * Gets the start-date of the FreeBusy component\n\t *\n\t * @returns {DateTimeValue}\n\t */\n\tget startDate() {\n\t\treturn this.getFirstPropertyFirstValue('DTSTART')\n\t}\n\n\t/**\n\t * Sets the start-date of the FreeBusy component\n\t *\n\t * @param {DateTimeValue} startDate The start of the queried time-range\n\t */\n\tset startDate(startDate) {\n\t\tthis._modify()\n\t\tthis.updatePropertyWithValue('DTSTART', startDate.getInTimezone(Timezone.utc))\n\t}\n\n\t/**\n\t * Gets the end-date of the FreeBusy component\n\t *\n\t * @returns {DateTimeValue}\n\t */\n\tget endDate() {\n\t\treturn this.getFirstPropertyFirstValue('DTEND')\n\t}\n\n\t/**\n\t * Sets the start-date of the FreeBusy component\n\t *\n\t * @param {DateTimeValue} endDate The end of the queried time-range\n\t */\n\tset endDate(endDate) {\n\t\tthis._modify()\n\t\tthis.updatePropertyWithValue('DTEND', endDate.getInTimezone(Timezone.utc))\n\t}\n\n\t/**\n\t * Gets an iterator over all FreeBusyProperties\n\t */\n\t* getFreeBusyIterator() {\n\t\tyield * this.getPropertyIterator('FREEBUSY')\n\t}\n\n\t/**\n\t * Adds a new attendee based on their name and email-address\n\t *\n\t * @url https://tools.ietf.org/html/rfc5545#section-3.8.4.1\n\t *\n\t * @param {String} name The name of the attendee to add\n\t * @param {String} email The email-address of the attendee to add\n\t */\n\taddAttendeeFromNameAndEMail(name, email) {\n\t\tthis._modify()\n\t\tthis.addProperty(AttendeeProperty.fromNameAndEMail(name, email))\n\t}\n\n\t/**\n\t * Sets the organiser property from common-name and email address\n\t *\n\t * @url https://tools.ietf.org/html/rfc5545#section-3.8.4.3\n\t *\n\t * @param {String} name The name of the organizer\n\t * @param {String} email The email-address of the organizer\n\t */\n\tsetOrganizerFromNameAndEMail(name, email) {\n\t\tthis._modify()\n\t\tthis.deleteAllProperties('ORGANIZER')\n\t\tthis.addProperty(AttendeeProperty.fromNameAndEMail(name, email, true))\n\t}\n\n}\n\n/**\n * The organizer of this FreeBusy component\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.4.3\n *\n * @name FreeBusyComponent#organizer\n * @type {AttendeeProperty}\n */\nadvertiseSingleOccurrenceProperty(FreeBusyComponent.prototype, 'organizer')\n\n/**\n * The UID of this FreeBusy component\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.4.7\n *\n * @name FreeBusyComponent#organizer\n * @type {AttendeeProperty}\n */\nadvertiseSingleOccurrenceProperty(FreeBusyComponent.prototype, 'uid')\n\n/**\n * Returns an iterator of all attendees\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.4.1\n *\n * @name FreeBusyComponent#getAttendeeIterator\n * @function\n * @returns {IterableIterator<AttendeeProperty>}\n */\n\n/**\n * Returns a list of all attendees\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.4.1\n *\n * @name FreeBusyComponent#getAttendeeList\n * @function\n * @returns {AttendeeProperty[]}\n */\n\n/**\n * Removes an attendee\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.4.1\n *\n * @name FreeBusyComponent#removeAttendee\n * @function\n * @param {AttendeeProperty} attendee\n */\n\n/**\n * Removes all attendees\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.4.1\n *\n * @name FreeBusyComponent#clearAllAttendees\n * @function\n */\nadvertiseMultipleOccurrenceProperty(FreeBusyComponent.prototype, 'attendee')\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport AbstractRecurringComponent from './abstractRecurringComponent.js'\nimport { advertiseMultipleOccurrenceProperty } from '../abstractComponent.js'\nimport TextProperty from '../../properties/textProperty.js'\n\n/**\n * @class JournalComponent\n * @classdesc\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.6.3\n */\nexport default class JournalComponent extends AbstractRecurringComponent {\n\n\t/**\n\t * Adds a new description property\n\t *\n\t * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.5\n\t *\n\t * @param {String} description The description text\n\t */\n\taddDescription(description) {\n\t\tthis.addProperty(new TextProperty('DESCRIPTION', description))\n\t}\n\n}\n\n/**\n * Gets an iterator over all description properties\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.5\n *\n * @name JournalComponent#getDescriptionIterator\n * @function\n * @returns {IterableIterator<ConferenceProperty>}\n */\n\n/**\n * Gets a list of all description properties\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.5\n *\n * @name JournalComponent#getDescriptionList\n * @function\n * @returns {ConferenceProperty[]}\n */\n\n/**\n * Removes a description from this event\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.5\n *\n * @name JournalComponent#removeDescription\n * @function\n * @param {ConferenceProperty} conference\n */\n\n/**\n * Removes all descriptions from this event\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.5\n *\n * @name JournalComponent#clearAllDescriptions\n * @function\n */\nadvertiseMultipleOccurrenceProperty(JournalComponent.prototype, 'description')\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport AbstractRecurringComponent from './abstractRecurringComponent.js'\nimport {\n\tadvertiseMultipleOccurrenceProperty,\n\tadvertiseMultiValueStringPropertySeparatedByLang,\n\tadvertiseSingleOccurrenceProperty,\n} from '../abstractComponent.js'\nimport ConferenceProperty from '../../properties/conferenceProperty.js'\nimport GeoProperty from '../../properties/geoProperty.js'\n\n/**\n * @class ToDoComponent\n * @classdesc\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.6.2\n */\nexport default class ToDoComponent extends AbstractRecurringComponent {\n\n\t/**\n\t * Returns whether this event is an all-day event\n\t *\n\t * @returns {boolean}\n\t */\n\tisAllDay() {\n\t\tconst propertiesToCheck = ['DTSTART', 'DUE']\n\t\tfor (const propertyToCheck of propertiesToCheck) {\n\t\t\tif (this.hasProperty(propertyToCheck)) {\n\t\t\t\treturn this.getFirstPropertyFirstValue(propertyToCheck).isDate\n\t\t\t}\n\t\t}\n\n\t\t// If a task is not associated with any date, it is defined to\n\t\t// occur on any successive date until it is completed.\n\t\t// We are treating it as all-day in that case.\n\t\treturn true\n\t}\n\n\t/**\n\t * Checks whether it's possible to switch from date-time to date or vise-versa\n\t *\n\t * @returns {boolean}\n\t */\n\tcanModifyAllDay() {\n\t\tif (!this.hasProperty('dtstart') && !this.hasProperty('due')) {\n\t\t\treturn false\n\t\t}\n\n\t\treturn !this.recurrenceManager.masterItem.isRecurring()\n\t}\n\n\t/**\n\t * Gets the calculated end-date of the task\n\t *\n\t * If there is a due-date, we will just return that.\n\t * If there is a start-date and a duration, we will\n\t * calculate the end-date based on that.\n\t *\n\t * If there is neither a due-date nor a combination\n\t * of start-date and duration, we just return null\n\t *\n\t * @returns {DateTimeValue|null}\n\t */\n\tget endDate() {\n\t\tif (this.hasProperty('due')) {\n\t\t\treturn this.getFirstPropertyFirstValue('due')\n\t\t}\n\n\t\tif (!this.hasProperty('dtstart') || !this.hasProperty('duration')) {\n\t\t\treturn null\n\t\t}\n\n\t\tconst endDate = this.startDate.clone()\n\t\tendDate.addDuration(this.getFirstPropertyFirstValue('duration'))\n\t\treturn endDate\n\t}\n\n\t/**\n\t * Shifts the entire task by the given duration\n\t *\n\t * @param {DurationValue} delta The duration to shift event by\n\t * @param {Boolean} allDay Whether the updated event should be all-day or not\n\t * @param {Timezone} defaultTimezone The default timezone if moving from all-day to timed event\n\t * @param {DurationValue} defaultAllDayDuration The default all-day duration if moving from timed to all-day\n\t * @param {DurationValue} defaultTimedDuration The default timed duration if moving from all-day to timed\n\t */\n\tshiftByDuration(delta, allDay, defaultTimezone, defaultAllDayDuration, defaultTimedDuration) {\n\t\tconst currentAllDay = this.isAllDay()\n\n\t\tif (!this.hasProperty('dtstart') && !this.hasProperty('due')) {\n\t\t\tthrow new TypeError('This task does not have a start-date nor due-date')\n\t\t}\n\n\t\tif (currentAllDay !== allDay && !this.canModifyAllDay()) {\n\t\t\tthrow new TypeError('Can\\'t modify all-day of this todo')\n\t\t}\n\n\t\t// If this task has a start-date, update it\n\t\t// This is especially important, if you shift\n\t\t// the task by a negative duration, because\n\t\t// dtstart always has to be prior to the due date\n\t\tif (this.hasProperty('dtstart')) {\n\t\t\tthis.startDate.isDate = allDay\n\t\t\tthis.startDate.addDuration(delta)\n\n\t\t\tif (currentAllDay && !allDay) {\n\t\t\t\tthis.startDate.replaceTimezone(defaultTimezone)\n\t\t\t}\n\t\t}\n\n\t\tif (this.hasProperty('due')) {\n\t\t\tthis.dueTime.isDate = allDay\n\t\t\tthis.dueTime.addDuration(delta)\n\n\t\t\tif (currentAllDay && !allDay) {\n\t\t\t\tthis.dueTime.replaceTimezone(defaultTimezone)\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Checks if this event is in a given time-frame\n\t *\n\t * @param {DateTimeValue} start Start of time-range to check\n\t * @param {DateTimeValue} end End of time-range to check\n\t * @returns {boolean}\n\t */\n\tisInTimeFrame(start, end) {\n\t\tif (!this.hasProperty('dtstart') && !this.hasProperty('due')) {\n\t\t\treturn true\n\t\t}\n\n\t\tif (!this.hasProperty('dtstart') && this.hasProperty('due')) {\n\t\t\treturn start.compare(this.endDate) <= 0\n\t\t}\n\n\t\treturn start.compare(this.endDate) <= 0 && end.compare(this.startDate) >= 0\n\t}\n\n\t/**\n\t * Gets the geographical position property\n\t *\n\t * @returns {GeoProperty}\n\t */\n\tget geographicalPosition() {\n\t\treturn this.getFirstProperty('GEO')\n\t}\n\n\t/**\n\t * Sets the geographical position based on latitude and longitude\n\t *\n\t * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.6\n\t *\n\t * @param {Number} lat - latitude\n\t * @param {Number} long - longitude\n\t */\n\tsetGeographicalPositionFromLatitudeAndLongitude(lat, long) {\n\t\tthis.deleteAllProperties('GEO')\n\t\tthis.addProperty(GeoProperty.fromPosition(lat, long))\n\t}\n\n\t/**\n\t * Adds a new conference property based on URI, label and features\n\t *\n\t * @url https://tools.ietf.org/html/rfc7986#section-5.11\n\t *\n\t * @param {String} uri The URI of the conference\n\t * @param {String=} label The label of the conference\n\t * @param {String[]=} features Supported features of conference-system\n\t */\n\taddConference(uri, label = null, features = null) {\n\t\tthis.addProperty(ConferenceProperty.fromURILabelAndFeatures(uri, label, features))\n\t}\n\n}\n\n/**\n * The time when a task was completed\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.2.1\n *\n * @name ToDoComponent#completedTime\n * @type {DateTimeValue}\n */\nadvertiseSingleOccurrenceProperty(ToDoComponent.prototype, {\n\tname: 'completedTime',\n\tiCalendarName: 'COMPLETED',\n})\n\n/**\n * The time when a task is due\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.2.3\n *\n * @name ToDoComponent#dueTime\n * @type {DateTimeValue}\n */\nadvertiseSingleOccurrenceProperty(ToDoComponent.prototype, {\n\tname: 'dueTime',\n\tiCalendarName: 'DUE',\n})\n\n/**\n * The time when a task was completed\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.2.5\n *\n * @name ToDoComponent#duration\n * @type {DurationValue}\n */\nadvertiseSingleOccurrenceProperty(ToDoComponent.prototype, {\n\tname: 'duration',\n})\n\n/**\n * The percentage a task was already fulfilled\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.8\n *\n * @name ToDoComponent#percent\n * @type {Number}\n */\nadvertiseSingleOccurrenceProperty(ToDoComponent.prototype, {\n\tname: 'percent',\n\tiCalendarName: 'PERCENT-COMPLETE',\n})\n\n/**\n * Description of this task.\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.5\n *\n * @name ToDoComponent#description\n * @type {String}\n */\nadvertiseSingleOccurrenceProperty(ToDoComponent.prototype, 'description')\n\n/**\n * Location of this task.\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.7\n *\n * @name ToDoComponent#location\n * @type {String}\n */\nadvertiseSingleOccurrenceProperty(ToDoComponent.prototype, 'location')\n\n/**\n * Priority of this task.\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.9\n *\n * @name ToDoComponent#priority\n * @type {String}\n */\nadvertiseSingleOccurrenceProperty(ToDoComponent.prototype, {\n\tname: 'priority',\n\tallowedValues: Array.from(Array(10).keys()),\n\tdefaultValue: 0,\n\tunknownValue: 0,\n})\n\n/**\n * Returns an iterator over all resources\n * If the parameter lang is given, it will only\n * return an iterator for Resources matching that language\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.10\n *\n * @name ToDoComponent#getResourceIterator\n * @function\n * @param {String=} lang\n * @returns {IterableIterator<String>}\n */\n\n/**\n * Returns a list of all resources\n * If the parameter lang is given, it will only\n * return an iterator for resources matching that language\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.10\n *\n * @name ToDoComponent#getResourceList\n * @function\n * @param {String=} lang\n * @returns {String[]}\n */\n\n/**\n * Adds a resource\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.10\n *\n * @name ToDoComponent#addResource\n * @function\n * @param {String} resource\n * @param {String=} lang\n */\n\n/**\n * Removes a resource\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.10\n *\n * @name ToDoComponent#removeResource\n * @function\n * @param {String} resource\n * @param {String=} lang\n */\n\n/**\n * Removes all resources from this task\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.8.1.10\n *\n * @name ToDoComponent#clearAllResources\n * @function\n * @param {String=} lang\n */\nadvertiseMultiValueStringPropertySeparatedByLang(ToDoComponent.prototype, {\n\tname: 'resource',\n\tiCalendarName: 'RESOURCES',\n})\n\n/**\n * Gets an iterator over all conference properties\n *\n * @url https://tools.ietf.org/html/rfc7986#section-5.11\n *\n * @name ToDoComponent#getConferenceIterator\n * @function\n * @returns {IterableIterator<ConferenceProperty>}\n */\n\n/**\n * Gets a list of all conference properties\n *\n * @url https://tools.ietf.org/html/rfc7986#section-5.11\n *\n * @name ToDoComponent#getConferenceList\n * @function\n * @returns {ConferenceProperty[]}\n */\n\n/**\n * Removes a conference from this event\n *\n * @url https://tools.ietf.org/html/rfc7986#section-5.11\n *\n * @name ToDoComponent#removeConference\n * @function\n * @param {ConferenceProperty} conference\n */\n\n/**\n * Removes all conferences from this event\n *\n * @url https://tools.ietf.org/html/rfc7986#section-5.11\n *\n * @name ToDoComponent#clearAllConferences\n * @function\n */\nadvertiseMultipleOccurrenceProperty(ToDoComponent.prototype, 'conference')\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport AbstractComponent from '../abstractComponent.js'\nimport EventComponent from './eventComponent.js'\nimport FreeBusyComponent from './freeBusyComponent.js'\nimport JournalComponent from './journalComponent.js'\nimport TimezoneComponent from './timezoneComponent.js'\nimport ToDoComponent from './toDoComponent.js'\nimport { uc } from '../../helpers/stringHelper.js'\n\n/**\n * Gets the constructor for a component name\n * This will only return a constructor for components,\n * that can be used in the root of a calendar-document\n *\n * @param {String} compName Name of the component to get constructor for\n * @returns {AbstractComponent|ToDoComponent|JournalComponent|FreeBusyComponent|TimezoneComponent|EventComponent}\n */\nexport function getConstructorForComponentName(compName) {\n\tswitch (uc(compName)) {\n\tcase 'VEVENT':\n\t\treturn EventComponent\n\n\tcase 'VFREEBUSY':\n\t\treturn FreeBusyComponent\n\n\tcase 'VJOURNAL':\n\t\treturn JournalComponent\n\n\tcase 'VTIMEZONE':\n\t\treturn TimezoneComponent\n\n\tcase 'VTODO':\n\t\treturn ToDoComponent\n\n\tdefault:\n\t\treturn AbstractComponent\n\t}\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport AbstractComponent, {\n\tadvertiseSingleOccurrenceProperty,\n} from './abstractComponent.js'\nimport { getConstructorForComponentName } from './root'\nimport { getConfig } from '../config.js'\nimport ICAL from 'ical.js'\n\n/**\n * This class represents one VCALENDAR block\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.4\n */\nexport default class CalendarComponent extends AbstractComponent {\n\n\t/**\n\t * Constructor\n\t *\n\t * @inheritDoc\n\t */\n\tconstructor(name = 'VCALENDAR', properties = [], components = []) {\n\t\tsuper(name, properties, components)\n\t\tthis.root = this\n\t\tthis.parent = null\n\t}\n\n\t/**\n\t * Gets an iterator over all VTIMEZONE components\n\t */\n\t* getTimezoneIterator() {\n\t\tyield * this.getComponentIterator('vtimezone')\n\t}\n\n\t/**\n\t * Gets an iterator over all VObject components\n\t */\n\t* getVObjectIterator() {\n\t\tyield * this.getEventIterator()\n\t\tyield * this.getJournalIterator()\n\t\tyield * this.getTodoIterator()\n\t}\n\n\t/**\n\t * Gets an iterator over all VEVENT components\n\t */\n\t* getEventIterator() {\n\t\tyield * this.getComponentIterator('vevent')\n\t}\n\n\t/**\n\t * Gets an iterator over all VFREEBUSY components\n\t */\n\t* getFreebusyIterator() {\n\t\tyield * this.getComponentIterator('vfreebusy')\n\t}\n\n\t/**\n\t * Gets an iterator over all VJOURNAL components\n\t */\n\t* getJournalIterator() {\n\t\tyield * this.getComponentIterator('vjournal')\n\t}\n\n\t/**\n\t * Gets an iterator over all VTODO components\n\t */\n\t* getTodoIterator() {\n\t\tyield * this.getComponentIterator('vtodo')\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tstatic _getConstructorForComponentName(componentName) {\n\t\treturn getConstructorForComponentName(componentName)\n\t}\n\n\t/**\n\t * Converts this calendar component into text/calendar\n\t *\n\t * @param {boolean} cleanUpTimezones Whether or not to clean up timezone data\n\t * @returns {string}\n\t */\n\ttoICS(cleanUpTimezones = true) {\n\t\tfor (const vObject of this.getVObjectIterator()) {\n\t\t\tvObject.undirtify()\n\t\t}\n\n\t\tconst icalRoot = this.toICALJs()\n\t\tif (cleanUpTimezones) {\n\t\t\tICAL.helpers.updateTimezones(icalRoot)\n\t\t}\n\t\treturn icalRoot.toString()\n\t}\n\n\t/**\n\t * Creates a new empty calendar-component\n\t *\n\t * @param {[String][]=} additionalProps Additional props to add to empty calendar-document\n\t * @returns {CalendarComponent}\n\t */\n\tstatic fromEmpty(additionalProps = []) {\n\t\treturn new this('VCALENDAR', [\n\t\t\t['prodid', getConfig('PRODID', '-//IDN georgehrke.com//calendar-js//EN')],\n\t\t\t['calscale', 'GREGORIAN'],\n\t\t\t['version', '2.0'],\n\t\t].concat(additionalProps))\n\t}\n\n\t/**\n\t * Creates a new calendar-component with a method\n\t *\n\t * @param {string} method The method for the calendar-document\n\t * @returns {CalendarComponent}\n\t */\n\tstatic fromMethod(method) {\n\t\treturn this.fromEmpty([['method', method]])\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tstatic fromICALJs(icalValue) {\n\t\tconst comp = super.fromICALJs(icalValue)\n\t\tcomp.root = comp\n\n\t\treturn comp\n\t}\n\n}\n\n/**\n * ProductId representing the software that created this calendar-document\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.7.3\n *\n * @name CalendarComponent#productId\n * @type {String}\n */\nadvertiseSingleOccurrenceProperty(CalendarComponent.prototype, {\n\tname: 'productId',\n\tiCalendarName: 'PRODID',\n})\n\n/**\n * iCalendar version of this calendar-document\n * minver and maxver parameters are not supported, since they\n * are virtually used by no calendaring-software\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.7.4\n *\n * @name CalendarComponent#version\n * @type {String}\n */\n\nadvertiseSingleOccurrenceProperty(CalendarComponent.prototype, {\n\tname: 'version',\n})\n\n/**\n * Calendar-scale used in this calendar-document\n * The default and only supported calendar-scale is GREGORIAN.\n * There is an iCalendar-extension about non-gregorian RRULES,\n * but that is not supported by calendar-js at the moment\n * @see https://tools.ietf.org/html/rfc7529\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.7.1\n *\n * @name CalendarComponent#calendarScale\n * @type {String}\n * @default \"GREGORIAN\"\n */\nadvertiseSingleOccurrenceProperty(CalendarComponent.prototype, {\n\tname: 'calendarScale',\n\tiCalendarName: 'CALSCALE',\n\tdefaultValue: 'GREGORIAN',\n})\n\n/**\n * Method of this calendar-document when being used in an iTIP message\n * Please see https://tools.ietf.org/html/rfc5546#section-3.2 for more information\n *\n * @url https://tools.ietf.org/html/rfc5545#section-3.7.2\n *\n * @name CalendarComponent#method\n * @type {String}\n */\nadvertiseSingleOccurrenceProperty(CalendarComponent.prototype, {\n\tname: 'method',\n})\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\n/**\n * @class AbstractRepairStep\n * @classdesc A repair step is used to fix calendar-data before it is parsed\n */\nexport default class AbstractRepairStep {\n\n\t/**\n\t * @constructor\n\t */\n\tconstructor() {\n\t\tif (new.target === AbstractRepairStep) {\n\t\t\tthrow new TypeError('Cannot instantiate abstract class AbstractRepairStep')\n\t\t}\n\t}\n\n\t/**\n\t * @param {String} input String representation of the data to repair\n\t */\n\trepair(input) {\n\t\tthrow new TypeError('Abstract method not implemented by subclass')\n\t}\n\n\t/**\n\t * @returns {number}\n\t */\n\tstatic priority() {\n\t\treturn 0\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport AbstractRepairStep from '../abstractRepairStep.js'\nimport { v4 as uuid } from 'uuid'\n\n/**\n * @class ICalendarAddMissingUIDRepairStep\n */\nexport default class ICalendarAddMissingUIDRepairStep extends AbstractRepairStep {\n\n\t/**\n\t * Please see the corresponding test file for an example of broken calendar-data\n\t *\n\t * @inheritDoc\n\t */\n\trepair(ics) {\n\t\treturn ics\n\t\t\t.replace(/^BEGIN:(VEVENT|VTODO|VJOURNAL)$(((?!^END:(VEVENT|VTODO|VJOURNAL)$)(?!^UID.*$)(.|\\n))*)^END:(VEVENT|VTODO|VJOURNAL)$\\n/gm, (match, vobjectName, vObjectBlock) => {\n\t\t\t\treturn 'BEGIN:' + vobjectName + '\\r\\n'\n\t\t\t\t\t+ 'UID:' + uuid()\n\t\t\t\t\t+ vObjectBlock\n\t\t\t\t\t+ 'END:' + vobjectName + '\\r\\n'\n\t\t\t})\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport AbstractRepairStep from '../abstractRepairStep.js'\n\n/**\n * @class ICalendarAddMissingValueDateDoubleColonRepairStep\n */\nexport default class ICalendarAddMissingValueDateDoubleColonRepairStep extends AbstractRepairStep {\n\n\t/**\n\t * Please see the corresponding test file for an example of broken calendar-data\n\t *\n\t * @inheritDoc\n\t */\n\trepair(ics) {\n\t\treturn ics\n\t\t\t.replace(/^(DTSTART|DTEND)(.*):([0-9]{8})T(::)$/gm, (match, propName, parameters, date) => {\n\t\t\t\treturn propName + ';VALUE=DATE:' + date\n\t\t\t})\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport AbstractRepairStep from '../abstractRepairStep.js'\n\n/**\n * @class ICalendarAddMissingValueDateRepairStep\n */\nexport default class ICalendarAddMissingValueDateRepairStep extends AbstractRepairStep {\n\n\t/**\n\t * Please see the corresponding test file for an example of broken calendar-data\n\t *\n\t * @inheritDoc\n\t */\n\trepair(ics) {\n\t\treturn ics\n\t\t\t.replace(/^(DTSTART|DTEND)(((?!VALUE=DATE).)*):([0-9]{8})$/gm, (match, propName, parameters, _, date) => {\n\t\t\t\treturn propName + parameters + ';VALUE=DATE:' + date\n\t\t\t})\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport AbstractRepairStep from '../abstractRepairStep.js'\n\n/**\n * @class ICalendarEmptyTriggerRepairStep\n * @classdesc This repair step fixes malformed TRIGGER properties\n */\nexport default class ICalendarEmptyTriggerRepairStep extends AbstractRepairStep {\n\n\t/**\n\t * Please see the corresponding test file for an example of broken calendar-data\n\t *\n\t * @inheritDoc\n\t */\n\trepair(ics) {\n\t\treturn ics\n\t\t\t.replace(/^TRIGGER:P$/gm, 'TRIGGER:P0D')\n\t\t\t.replace(/^TRIGGER:-P$/gm, 'TRIGGER:P0D')\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2020 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport AbstractRepairStep from '../abstractRepairStep.js'\n\nexport default class ICalendarIllegalCreatedRepairStep extends AbstractRepairStep {\n\n\t/**\n\t * Please see the corresponding test file for an example of broken calendar-data\n\t *\n\t * @inheritDoc\n\t */\n\trepair(ics) {\n\t\treturn ics\n\t\t\t.replace(/^CREATED:00001231T000000Z$/gm, 'CREATED:19700101T000000Z')\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport AbstractRepairStep from '../abstractRepairStep.js'\nimport { uc } from '../../../helpers/stringHelper.js'\n\n/**\n * @class ICalendarMultipleVCalendarBlocksRepairStep\n * @classdesc This repair step merges multiple BEGIN:VCALENDAR...END:VCALENDAR blocks\n */\nexport default class ICalendarMultipleVCalendarBlocksRepairStep extends AbstractRepairStep {\n\n\t/**\n\t * Please see the corresponding test file for an example of broken calendar-data\n\t *\n\t * @inheritDoc\n\t */\n\trepair(ics) {\n\t\tlet containsProdId = false\n\t\tlet containsVersion = false\n\t\tlet containsCalscale = false\n\t\tconst includedTimezones = new Set()\n\n\t\treturn ics\n\t\t\t.replace(/^END:VCALENDAR$(((?!^BEGIN:)(.|\\n))*)^BEGIN:VCALENDAR$\\n/gm, '')\n\t\t\t.replace(/^PRODID:(.*)$\\n/gm, (match) => {\n\t\t\t\tif (containsProdId) {\n\t\t\t\t\treturn ''\n\t\t\t\t}\n\n\t\t\t\tcontainsProdId = true\n\t\t\t\treturn match\n\t\t\t})\n\t\t\t.replace(/^VERSION:(.*)$\\n/gm, (match) => {\n\t\t\t\tif (containsVersion) {\n\t\t\t\t\treturn ''\n\t\t\t\t}\n\n\t\t\t\tcontainsVersion = true\n\t\t\t\treturn match\n\t\t\t})\n\t\t\t.replace(/^CALSCALE:(.*)$\\n/gm, (match) => {\n\t\t\t\tif (containsCalscale) {\n\t\t\t\t\treturn ''\n\t\t\t\t}\n\n\t\t\t\tcontainsCalscale = true\n\t\t\t\treturn match\n\t\t\t})\n\t\t\t.replace(/^BEGIN:VTIMEZONE$(((?!^END:VTIMEZONE$)(.|\\n))*)^END:VTIMEZONE$\\n/gm, (match) => {\n\t\t\t\tconst tzidMatcher = match.match(/^TZID:(.*)$/gm)\n\n\t\t\t\t// If this Timezone definition contains no TZID for some reason,\n\t\t\t\t// just remove it, because we can't use it anyway\n\t\t\t\tif (tzidMatcher === null) {\n\t\t\t\t\treturn ''\n\t\t\t\t}\n\n\t\t\t\tconst tzid = uc(tzidMatcher[0].slice(5))\n\t\t\t\tif (includedTimezones.has(tzid)) {\n\t\t\t\t\t// If we already included this timezone, just skip\n\t\t\t\t\treturn ''\n\t\t\t\t}\n\n\t\t\t\tincludedTimezones.add(tzid)\n\t\t\t\treturn match\n\t\t\t})\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport AbstractRepairStep from '../abstractRepairStep.js'\n\n/**\n * @class ICalendarRemoveXNCGroupIdRepairStep\n * @classdesc This repair step removes the X-NC-GroupID parameter used in previous versions of Nextcloud\n */\nexport default class ICalendarRemoveXNCGroupIdRepairStep extends AbstractRepairStep {\n\n\t/**\n\t * Please see the corresponding test file for an example of broken calendar-data\n\t *\n\t * @inheritDoc\n\t */\n\trepair(ics) {\n\t\treturn ics\n\t\t\t.replace(/(^.*)(;X-NC-GROUP-ID=\\d+)(:.*$)/gm, '$1$3')\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport ICalendarAddMissingUIDRepairStep from './icalendarAddMissingUIDRepairStep.js'\nimport ICalendarAddMissingValueDateDoubleColonRepairStep from './icalendarAddMissingValueDateDoubleColonRepairStep.js'\nimport ICalendarAddMissingValueDateRepairStep from './icalendarAddMissingValueDateRepairStep.js'\nimport ICalendarEmptyTriggerRepairStep from './icalendarEmptyTriggerRepairStep.js'\nimport ICalendarIllegalCreatedRepairStep from './icalendarIllegalCreatedRepairStep.js'\nimport ICalendarMultipleVCalendarBlocksRepairStep from './icalendarMultipleVCalendarBlocksRepairStep.js'\nimport ICalendarRemoveXNCGroupIdRepairStep from './icalendarRemoveXNCGroupIdRepairStep.js'\n\n/**\n * Get an iterator over all repair steps for iCalendar documents\n */\nexport function * getRepairSteps() {\n\tyield ICalendarAddMissingUIDRepairStep\n\tyield ICalendarAddMissingValueDateDoubleColonRepairStep\n\tyield ICalendarAddMissingValueDateRepairStep\n\tyield ICalendarEmptyTriggerRepairStep\n\tyield ICalendarIllegalCreatedRepairStep\n\tyield ICalendarMultipleVCalendarBlocksRepairStep\n\tyield ICalendarRemoveXNCGroupIdRepairStep\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport Timezone from './timezone.js'\nimport tzData from '../../resources/timezones/zones.json'\n\n/**\n * @class TimezoneManager\n */\nexport class TimezoneManager {\n\n\t/**\n\t * Constructor\n\t */\n\tconstructor() {\n\t\t/**\n\t\t * Map of aliases\n\t\t * Alias name => timezoneId\n\t\t *\n\t\t * @type {Map<String, String>}\n\t\t */\n\t\tthis._aliases = new Map()\n\n\t\t/**\n\t\t * Map of Timezones\n\t\t * timezoneId => Timezone\n\t\t *\n\t\t * @type {Map<String, Timezone>}\n\t\t * @private\n\t\t */\n\t\tthis._timezones = new Map()\n\t}\n\n\t/**\n\t * Gets a timezone for the given id\n\t *\n\t * @param {String} timezoneId The id of the timezone\n\t * @returns {Timezone|null}\n\t */\n\tgetTimezoneForId(timezoneId) {\n\t\treturn this._getTimezoneForIdRec(timezoneId, 0)\n\t}\n\n\t_getTimezoneForIdRec(timezoneId, level) {\n\t\tif (this._timezones.has(timezoneId)) {\n\t\t\treturn this._timezones.get(timezoneId)\n\t\t}\n\n\t\tif (level >= 20) {\n\t\t\t// too much recursion\n\t\t\tconsole.error('TimezoneManager.getTimezoneForIdRec() exceeds recursion limits')\n\t\t\treturn null\n\t\t}\n\n\t\tif (this._aliases.has(timezoneId)) {\n\t\t\tconst resolvedTimezoneId = this._aliases.get(timezoneId)\n\t\t\t// can be a recursive alias:\n\t\t\treturn this._getTimezoneForIdRec(resolvedTimezoneId, level + 1)\n\t\t}\n\n\t\treturn null\n\t}\n\n\t/**\n\t * Checks if there is a timezone for the given id stored in this manager\n\t *\n\t * @param {String} timezoneId The id of the timezone\n\t * @returns {boolean}\n\t */\n\thasTimezoneForId(timezoneId) {\n\t\treturn this._timezones.has(timezoneId) || this._aliases.has(timezoneId)\n\t}\n\n\t/**\n\t * Checks if the given timezone id is an alias\n\t *\n\t * @param {String} timezoneId The id of the timezone\n\t * @returns {boolean}\n\t */\n\tisAlias(timezoneId) {\n\t\treturn !this._timezones.has(timezoneId) && this._aliases.has(timezoneId)\n\t}\n\n\t/**\n\t * Lists all timezones\n\t *\n\t * @param {Boolean=} includeAliases Whether or not to include aliases\n\t * @returns {String[]}\n\t */\n\tlistAllTimezones(includeAliases = false) {\n\t\tconst timezones = Array.from(this._timezones.keys())\n\n\t\tif (includeAliases) {\n\t\t\treturn timezones.concat(Array.from(this._aliases.keys()))\n\t\t}\n\n\t\treturn timezones\n\t}\n\n\t/**\n\t * Registers a timezone\n\t *\n\t * @param {Timezone} timezone The timezone-object to register\n\t */\n\tregisterTimezone(timezone) {\n\t\tthis._timezones.set(timezone.timezoneId, timezone)\n\t}\n\n\tregisterDefaultTimezones() {\n\t\tconsole.debug(`@nextcloud/calendar-js app is using version ${tzData.version} of the timezone database`)\n\n\t\tfor (const tzid in tzData.zones) {\n\t\t\tif (Object.prototype.hasOwnProperty.call(tzData.zones, [tzid])) {\n\t\t\t\tconst ics = [\n\t\t\t\t\t'BEGIN:VTIMEZONE',\n\t\t\t\t\t'TZID:' + tzid,\n\t\t\t\t\t...tzData.zones[tzid].ics,\n\t\t\t\t\t'END:VTIMEZONE',\n\t\t\t\t].join('\\r\\n')\n\t\t\t\tthis.registerTimezoneFromICS(tzid, ics)\n\t\t\t}\n\t\t}\n\n\t\tfor (const tzid in tzData.aliases) {\n\t\t\tif (Object.prototype.hasOwnProperty.call(tzData.aliases, [tzid])) {\n\t\t\t\tthis.registerAlias(tzid, tzData.aliases[tzid].aliasTo)\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Registers a timezone based on ics data\n\t *\n\t * @param {String} timezoneId The id of the timezone\n\t * @param {String} ics The iCalendar timezone definition\n\t */\n\tregisterTimezoneFromICS(timezoneId, ics) {\n\t\tconst timezone = new Timezone(timezoneId, ics)\n\t\tthis.registerTimezone(timezone)\n\t}\n\n\t/**\n\t * Registers a new timezone-alias\n\t *\n\t * @param {String} aliasName The timezone-id of the alias\n\t * @param {String} timezoneId The timezone-id to resolve the alias to\n\t */\n\tregisterAlias(aliasName, timezoneId) {\n\t\tthis._aliases.set(aliasName, timezoneId)\n\t}\n\n\t/**\n\t * Unregisters a timezone\n\t *\n\t * @param {String} timezoneId Unregisters a timezone by Id\n\t */\n\tunregisterTimezones(timezoneId) {\n\t\tthis._timezones.delete(timezoneId)\n\t}\n\n\t/**\n\t * Unregisters a timezone-alias\n\t *\n\t * @param {String} aliasName The alias to unregister\n\t */\n\tunregisterAlias(aliasName) {\n\t\tthis._aliases.delete(aliasName)\n\t}\n\n\t/**\n\t * Clear all timezones\n \t */\n\tclearAllTimezones() {\n\t\tthis._aliases = new Map()\n\t\tthis._timezones = new Map()\n\n\t\ttimezoneManager.registerTimezone(Timezone.utc)\n\t\ttimezoneManager.registerTimezone(Timezone.floating)\n\t\ttimezoneManager.registerAlias('GMT', Timezone.utc.timezoneId)\n\t\ttimezoneManager.registerAlias('Z', Timezone.utc.timezoneId)\n\t}\n\n}\n\nconst timezoneManager = new TimezoneManager()\ntimezoneManager.clearAllTimezones()\n\n/**\n * Gets the default instance of the timezone manager\n *\n * @returns {TimezoneManager}\n */\nexport function getTimezoneManager() {\n\treturn timezoneManager\n}\n\n/**\n *\n * @param {String} tzName Name of the timezone to check\n * @returns {boolean}\n */\nexport function isOlsonTimezone(tzName) {\n\tconst hasSlash = tzName.indexOf('/') !== -1\n\tconst hasSpace = tzName.indexOf(' ') !== -1\n\tconst startsWithETC = tzName.startsWith('Etc')\n\tconst startsWithUS = tzName.startsWith('US/')\n\n\treturn hasSlash && !hasSpace && !startsWithETC && !startsWithUS\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport AbstractParser from './abstractParser.js'\nimport CalendarComponent from '../components/calendarComponent.js'\nimport { getRepairSteps } from './repairsteps/icalendar'\nimport { uc } from '../helpers/stringHelper.js'\nimport { getConstructorForComponentName } from '../components/root'\nimport { getTimezoneManager } from '../timezones/timezoneManager.js'\nimport Timezone from '../timezones/timezone.js'\nimport RecurrenceManager from '../recurrence/recurrenceManager.js'\nimport DateTimeValue from '../values/dateTimeValue.js'\nimport ICAL from 'ical.js'\n\n/**\n * @class ICalendarParser\n * @classdesc\n */\nexport default class ICalendarParser extends AbstractParser {\n\n\t/**\n\t * @inheritDoc\n\t */\n\tconstructor(...args) {\n\t\tsuper(...args)\n\n\t\t/**\n\t\t * The raw text/calendar data\n\t\t *\n\t\t * @type {String}\n\t\t * @protected\n\t\t */\n\t\tthis._rawData = null\n\n\t\t/**\n\t\t * The CalendarComponent representing the raw data\n\t\t *\n\t\t * @type {CalendarComponent}\n\t\t * @protected\n\t\t */\n\t\tthis._calendarComponent = null\n\n\t\t/**\n\t\t * A flag whether this calendar-data contains vevents\n\t\t *\n\t\t * @type {boolean}\n\t\t * @private\n\t\t */\n\t\tthis._containsVEvents = false\n\n\t\t/**\n\t\t * A flag whether this calendar-data contains vjournals\n\t\t *\n\t\t * @type {boolean}\n\t\t * @private\n\t\t */\n\t\tthis._containsVJournals = false\n\n\t\t/**\n\t\t * A flag whether this calendar-data contains vtodos\n\t\t *\n\t\t * @type {boolean}\n\t\t * @private\n\t\t */\n\t\tthis._containsVTodos = false\n\n\t\t/**\n\t\t * A flag whether this calendar-data contains vfreebusy\n\t\t *\n\t\t * @type {boolean}\n\t\t * @private\n\t\t */\n\t\tthis._containsVFreeBusy = false\n\n\t\t/**\n\t\t * A map containing all VObjects.\n\t\t * The key of this map is the UID\n\t\t * The value an array of all VObjects with that particular UID\n\t\t *\n\t\t * @type {Map<String, AbstractRecurringComponent[]>}\n\t\t * @private\n\t\t */\n\t\tthis._items = new Map()\n\n\t\t/**\n\t\t * Items that are no recurrence-exceptions\n\t\t * The key of this map is the UID\n\t\t *\n\t\t * @type {Map<String, AbstractRecurringComponent>}\n\t\t * @private\n\t\t */\n\t\tthis._masterItems = new Map()\n\n\t\t/**\n\t\t * Items that are recurrence exceptions\n\t\t *\n\t\t * @type {Map<String, AbstractRecurringComponent[]>}\n\t\t * @private\n\t\t */\n\t\tthis._recurrenceExceptionItems = new Map()\n\n\t\t/**\n\t\t * Some recurrence-exceptions come without a master item\n\t\t * In that case we need to forge a master item\n\t\t *\n\t\t * @type {Map<String, AbstractRecurringComponent>}\n\t\t * @private\n\t\t */\n\t\tthis._forgedMasterItems = new Map()\n\n\t\t/**\n\t\t * A list of timezone-components found in the calendar-data\n\t\t *\n\t\t * @type {Map<String, Timezone>}\n\t\t * @private\n\t\t */\n\t\tthis._timezones = new Map()\n\n\t\t/**\n\t\t * A set of required timezones for each UID\n\t\t *\n\t\t * @type {Map<String, Set<String>>}\n\t\t * @private\n\t\t */\n\t\tthis._requiredTimezones = new Map()\n\n\t\t/**\n\t\t * Instance of the default timezone-manager\n\t\t *\n\t\t * @type {TimezoneManager}\n\t\t * @private\n\t\t */\n\t\tthis._defaultTimezoneManager = getTimezoneManager()\n\t}\n\n\t/**\n\t * Parses the actual calendar-data\n\t *\n\t * @param {String} ics The icalendar data to parse\n\t */\n\tparse(ics) {\n\t\tthis._rawData = ics\n\n\t\tthis._applyRepairSteps()\n\n\t\t// If a timezone is not inside our TimezoneManager at the time of parsing\n\t\t// the internal zone will be marked as floating inside ICAL.Time\n\t\t// so before we start any actual parsing, we need to extract all timezones\n\t\t// and add them to the TimezoneManager\n\t\tthis._extractTimezones()\n\t\tthis._registerTimezones()\n\n\t\tthis._createCalendarComponent()\n\n\t\tif (this._getOption('extractGlobalProperties', false)) {\n\t\t\tthis._extractProperties()\n\t\t}\n\n\t\tthis._processVObjects()\n\n\t\tif (this._getOption('processFreeBusy', false)) {\n\t\t\tthis._processVFreeBusy()\n\t\t}\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\t* getItemIterator() {\n\t\tfor (const itemList of this._items.values()) {\n\t\t\tconst calendarComp = CalendarComponent.fromEmpty()\n\n\t\t\tif (this._getOption('includeTimezones', false)) {\n\t\t\t\tthis._addRequiredTimezonesToCalendarComp(calendarComp, itemList[0].uid)\n\t\t\t}\n\n\t\t\t// Preserve the original product id, just in case we need special handling for certain clients later on ...\n\t\t\tif (this._calendarComponent.hasProperty('PRODID')) {\n\t\t\t\tcalendarComp.deleteAllProperties('PRODID')\n\t\t\t\tcalendarComp.addProperty(this._calendarComponent.getFirstProperty('PRODID').clone())\n\t\t\t}\n\n\t\t\tif (this._getOption('preserveMethod', false)) {\n\t\t\t\tif (this._calendarComponent.hasProperty('METHOD')) {\n\t\t\t\t\tcalendarComp.deleteAllProperties('METHOD')\n\t\t\t\t\tcalendarComp.addProperty(this._calendarComponent.getFirstProperty('METHOD').clone())\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor (const item of itemList) {\n\t\t\t\tcalendarComp.addComponent(item)\n\t\t\t}\n\n\t\t\tyield calendarComp\n\t\t}\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tcontainsVEvents() {\n\t\treturn this._containsVEvents\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tcontainsVJournals() {\n\t\treturn this._containsVJournals\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tcontainsVTodos() {\n\t\treturn this._containsVTodos\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tcontainsVFreeBusy() {\n\t\treturn this._containsVFreeBusy\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tgetItemCount() {\n\t\treturn Array.from(this._items.keys()).length\n\t}\n\n\t/**\n\t * Applies all registered repair steps\n\t *\n\t * @private\n\t */\n\t_applyRepairSteps() {\n\t\tfor (const RepairStep of getRepairSteps()) {\n\t\t\tconst step = new RepairStep()\n\t\t\tthis._rawData = step.repair(this._rawData)\n\t\t}\n\t}\n\n\t/**\n\t * Creates a calendar component based upon the repaired data\n\t *\n\t * @private\n\t */\n\t_createCalendarComponent() {\n\t\tconst jCal = ICAL.parse(this._rawData)\n\t\tconst icalComp = new ICAL.Component(jCal)\n\t\tthis._calendarComponent = CalendarComponent.fromICALJs(icalComp)\n\t}\n\n\t/**\n\t * extracts properties\n\t *\n\t * @protected\n\t */\n\t_extractProperties() {\n\t\tthis._extractPropertyAndPutResultIntoVariable(['name', 'x-wr-calname'], '_name')\n\t\tthis._extractPropertyAndPutResultIntoVariable(['color', 'x-apple-calendar-color'], '_color')\n\t\tthis._extractPropertyAndPutResultIntoVariable(['source'], '_sourceURL')\n\t\tthis._extractPropertyAndPutResultIntoVariable(['refresh-interval', 'x-published-ttl'], '_refreshInterval')\n\t\tthis._extractPropertyAndPutResultIntoVariable(['x-wr-timezone'], '_calendarTimezone')\n\t}\n\n\t/**\n\t * Extract a property and writes it into a class property\n\t * names must be an array, it will use the value of the fist\n\t * propertyname it can find\n\t *\n\t * @param {String[]} names The names of the properties to check\n\t * @param {String} variableName The variable name to save it under\n\t * @private\n\t */\n\t_extractPropertyAndPutResultIntoVariable(names, variableName) {\n\t\tfor (const name of names) {\n\t\t\tif (this._calendarComponent.hasProperty(name)) {\n\t\t\t\tthis[variableName] = this._calendarComponent.getFirstPropertyFirstValue(name)\n\t\t\t\treturn\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Extracts timezones from the calendar component\n\t *\n\t * @protected\n\t */\n\t_extractTimezones() {\n\t\tconst matches = this._rawData.match(/^BEGIN:VTIMEZONE$(((?!^END:VTIMEZONE$)(.|\\n))*)^END:VTIMEZONE$\\n/gm)\n\n\t\tif (!matches) {\n\t\t\treturn\n\t\t}\n\n\t\tfor (const match of matches) {\n\t\t\tconst tzidMatcher = match.match(/^TZID:(.*)$/gm)\n\t\t\tif (!tzidMatcher) {\n\t\t\t\tcontinue\n\t\t\t}\n\n\t\t\tconst tzid = tzidMatcher[0].slice(5)\n\t\t\tconst timezone = new Timezone(tzid, match)\n\t\t\tthis._timezones.set(tzid, timezone)\n\t\t}\n\t}\n\n\t/**\n\t * Registers unknown timezones into our timezone-manager\n\t *\n\t * @protected\n\t */\n\t_registerTimezones() {\n\t\tfor (const [tzid, timezone] of this._timezones) {\n\t\t\tif (!this._defaultTimezoneManager.hasTimezoneForId(tzid)) {\n\t\t\t\tthis._defaultTimezoneManager.registerTimezone(timezone)\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Processes the parsed vobjects\n\t *\n\t * @protected\n\t */\n\t_processVObjects() {\n\t\tfor (const vObject of this._calendarComponent.getVObjectIterator()) {\n\t\t\tthis._addItem(vObject)\n\t\t\tthis._markCompTypeAsSeen(vObject.name)\n\t\t\tif (vObject.isRecurrenceException()) {\n\t\t\t\tthis._addRecurrenceException(vObject)\n\t\t\t} else {\n\t\t\t\tvObject.recurrenceManager = new RecurrenceManager(vObject)\n\t\t\t\tthis._masterItems.set(vObject.uid, vObject)\n\t\t\t}\n\n\t\t\tfor (const propertyToCheck of vObject.getPropertyIterator()) {\n\t\t\t\tfor (const value of propertyToCheck.getValueIterator()) {\n\t\t\t\t\tif (value instanceof DateTimeValue && value.timezoneId) {\n\t\t\t\t\t\tthis._addRequiredTimezone(vObject.uid, value.timezoneId)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// TRIGGER is supposed to be stored in UTC only,\n\t\t\t// but not all clients stick to this\n\t\t\tfor (const alarm of vObject.getAlarmIterator()) {\n\t\t\t\tfor (const propertyToCheck of alarm.getPropertyIterator()) {\n\t\t\t\t\tfor (const value of propertyToCheck.getValueIterator()) {\n\t\t\t\t\t\tif (value instanceof DateTimeValue && value.timezoneId) {\n\t\t\t\t\t\t\tthis._addRequiredTimezone(vObject.uid, value.timezoneId)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (this._getOption('removeRSVPForAttendees', false)) {\n\t\t\t\tfor (const attendee of vObject.getAttendeeIterator()) {\n\t\t\t\t\tattendee.deleteParameter('RSVP')\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor (const recurrenceExceptionList of this._recurrenceExceptionItems.values()) {\n\t\t\tfor (const recurrenceException of recurrenceExceptionList) {\n\n\t\t\t\t// Check if there is a master item for this recurrence exception\n\t\t\t\t// otherwise we have to forge one\n\t\t\t\tif (!this._masterItems.has(recurrenceException.uid)) {\n\t\t\t\t\tconst constructor = getConstructorForComponentName(recurrenceException.name)\n\t\t\t\t\tconst forgedMaster = new constructor(recurrenceException.name, [\n\t\t\t\t\t\t['UID', recurrenceException.uid],\n\t\t\t\t\t\t['DTSTAMP', recurrenceException.stampTime.clone()],\n\t\t\t\t\t\t['DTSTART', recurrenceException.recurrenceId.clone()],\n\t\t\t\t\t])\n\n\t\t\t\t\tforgedMaster.recurrenceManager = new RecurrenceManager(forgedMaster)\n\n\t\t\t\t\tthis._forgedMasterItems.set(recurrenceException.uid, forgedMaster)\n\t\t\t\t\tthis._masterItems.set(recurrenceException.uid, forgedMaster)\n\t\t\t\t\tthis._addItem(forgedMaster)\n\t\t\t\t} else {\n\t\t\t\t\tconst master = this._masterItems.get(recurrenceException.uid)\n\n\t\t\t\t\t// This should usually not be the case,\n\t\t\t\t\t// only if the calendar-data is seriously broken.\n\t\t\t\t\t// Let's try to handle it anyway by adding it to\n\t\t\t\t\t// forgedMasterItems, we will simply add RDATEs\n\t\t\t\t\t// in the next step to make it recur\n\t\t\t\t\tif (!master.isRecurring()) {\n\t\t\t\t\t\tthis._forgedMasterItems.set(master.uid, master)\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (this._forgedMasterItems.has(recurrenceException.uid)) {\n\t\t\t\t\tconst forgedMaster = this._forgedMasterItems.get(recurrenceException.uid)\n\t\t\t\t\tforgedMaster.recurrenceManager.addRecurrenceDate(false, recurrenceException.recurrenceId.clone())\n\t\t\t\t}\n\n\t\t\t\tconst masterItem = this._masterItems.get(recurrenceException.uid)\n\t\t\t\tmasterItem.recurrenceManager.relateRecurrenceException(recurrenceException)\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Process FreeBusy components\n\t *\n\t * @private\n\t */\n\t_processVFreeBusy() {\n\t\tfor (const vObject of this._calendarComponent.getFreebusyIterator()) {\n\t\t\tthis._addItem(vObject)\n\t\t\tthis._markCompTypeAsSeen(vObject.name)\n\n\t\t\tfor (const propertyToCheck of vObject.getPropertyIterator()) {\n\t\t\t\tfor (const value of propertyToCheck.getValueIterator()) {\n\t\t\t\t\tif (value instanceof DateTimeValue && value.timezoneId) {\n\t\t\t\t\t\tthis._addRequiredTimezone(vObject.uid, value.timezoneId)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t *\n\t * @param {AbstractRecurringComponent} item The recurrence-item to register\n\t * @private\n\t */\n\t_addRecurrenceException(item) {\n\t\tif (this._recurrenceExceptionItems.has(item.uid)) {\n\t\t\tconst arr = this._recurrenceExceptionItems.get(item.uid)\n\t\t\tarr.push(item)\n\t\t} else {\n\t\t\tthis._recurrenceExceptionItems.set(item.uid, [item])\n\t\t}\n\t}\n\n\t/**\n\t *\n\t * @param {AbstractRecurringComponent} item The item to register\n\t * @private\n\t */\n\t_addItem(item) {\n\t\tif (this._items.has(item.uid)) {\n\t\t\tconst arr = this._items.get(item.uid)\n\t\t\tarr.push(item)\n\t\t} else {\n\t\t\tthis._items.set(item.uid, [item])\n\t\t}\n\t}\n\n\t/**\n\t *\n\t * @param {String} uid The uid of the calendar-object\n\t * @param {String} timezoneId The timezoneId required by the object\n\t * @private\n\t */\n\t_addRequiredTimezone(uid, timezoneId) {\n\t\tif (timezoneId === 'UTC' || timezoneId === 'floating' || timezoneId === 'GMT' || timezoneId === 'Z') {\n\t\t\treturn\n\t\t}\n\n\t\tif (this._requiredTimezones.has(uid)) {\n\t\t\tthis._requiredTimezones.get(uid).add(timezoneId)\n\t\t} else {\n\t\t\tconst set = new Set([timezoneId])\n\t\t\tthis._requiredTimezones.set(uid, set)\n\t\t}\n\t}\n\n\t/**\n\t *\n\t * @param {CalendarComponent} calendarComp The calendar-component to add timezones to\n\t * @param {String} uid The UID of the calendar-object\n\t * @private\n\t */\n\t_addRequiredTimezonesToCalendarComp(calendarComp, uid) {\n\t\tif (!this._requiredTimezones.has(uid)) {\n\t\t\treturn\n\t\t}\n\n\t\tfor (const requiredTimezone of this._requiredTimezones.get(uid)) {\n\t\t\tif (!this._defaultTimezoneManager.hasTimezoneForId(requiredTimezone)) {\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tconst timezone = this._defaultTimezoneManager.getTimezoneForId(requiredTimezone)\n\t\t\t// Is this an alias?\n\t\t\tif (timezone.timezoneId !== requiredTimezone) {\n\t\t\t\tthis._replaceTimezoneWithAnotherOne(calendarComp, requiredTimezone, timezone.timezoneId)\n\t\t\t}\n\n\t\t\tconst timezoneComponent = timezone.toTimezoneComponent()\n\t\t\tcalendarComp.addComponent(timezoneComponent)\n\t\t}\n\t}\n\n\t/**\n\t * Replaces all occurrences of searchTimezone with replaceTimezone\n\t *\n\t * @param {CalendarComponent} calendarComponent The calendar-component to replace a timezone in\n\t * @param {String} searchTimezone The timezone to replace\n\t * @param {String} replaceTimezone The replacement timezone\n\t * @private\n\t */\n\t_replaceTimezoneWithAnotherOne(calendarComponent, searchTimezone, replaceTimezone) {\n\t\tfor (const vObject of this._calendarComponent.getVObjectIterator()) {\n\t\t\tfor (const propertyToCheck of vObject.getPropertyIterator()) {\n\t\t\t\tfor (const value of propertyToCheck.getValueIterator()) {\n\t\t\t\t\tif (!(value instanceof DateTimeValue)) {\n\t\t\t\t\t\tcontinue\n\t\t\t\t\t}\n\n\t\t\t\t\tif (value.timezoneId === searchTimezone) {\n\t\t\t\t\t\tvalue.silentlyReplaceTimezone(replaceTimezone)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// TRIGGER is supposed to be stored in UTC only,\n\t\t\t// but not all clients stick to this\n\t\t\tfor (const alarm of vObject.getAlarmIterator()) {\n\t\t\t\tfor (const propertyToCheck of alarm.getPropertyIterator()) {\n\t\t\t\t\tfor (const value of propertyToCheck.getValueIterator()) {\n\t\t\t\t\t\tif (!(value instanceof DateTimeValue)) {\n\t\t\t\t\t\t\tcontinue\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (value.timezoneId === searchTimezone) {\n\t\t\t\t\t\t\tvalue.silentlyReplaceTimezone(replaceTimezone)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Marks a certain component type as seen.\n\t * This is used for\n\t * containsVEvents()\n\t * containsVJournals()\n\t * containsVTodos()\n\t *\n\t * @param {String} compName The name of the visited component\n\t * @private\n\t */\n\t_markCompTypeAsSeen(compName) {\n\t\tswitch (uc(compName)) {\n\t\tcase 'VEVENT':\n\t\t\tthis._containsVEvents = true\n\t\t\tbreak\n\n\t\tcase 'VJOURNAL':\n\t\t\tthis._containsVJournals = true\n\t\t\tbreak\n\n\t\tcase 'VTODO':\n\t\t\tthis._containsVTodos = true\n\t\t\tbreak\n\n\t\tcase 'VFREEBUSY':\n\t\t\tthis._containsVFreeBusy = true\n\t\t\tbreak\n\t\t}\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tstatic getMimeTypes() {\n\t\treturn ['text/calendar']\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport ICalendarParser from './icalendarParser.js'\n\n/**\n * @class ParserManager\n * @classdesc\n */\nexport default class ParserManager {\n\n\t/**\n\t * Constructor\n\t */\n\tconstructor() {\n\n\t\t/**\n\t\t * List of supported parsers\n\t\t *\n\t\t * @type {Function[]}\n\t\t */\n\t\tthis._parsers = []\n\t}\n\n\t/**\n\t * Get a list of all supported file-types\n\t *\n\t * @returns {String[]}\n\t */\n\tgetAllSupportedFileTypes() {\n\t\treturn this._parsers.reduce(\n\t\t\t(allFileTypes, parser) => allFileTypes.concat(parser.getMimeTypes()),\n\t\t\t[])\n\t}\n\n\t/**\n\t * Get an instance of a parser for one specific file-type\n\t *\n\t * @param {String} fileType The mime-type to get a parser for\n\t * @param {Object=} options Options destructuring object\n\t * @param {Boolean=} options.extractGlobalProperties Whether or not to preserve properties from the VCALENDAR component (defaults to false)\n\t * @param {Boolean=} options.removeRSVPForAttendees Whether or not to remove RSVP from attendees (defaults to false)\n\t * @param {Boolean=} options.includeTimezones Whether or not to include timezones (defaults to false)\n\t * @param {Boolean=} options.preserveMethod Whether or not to preserve the iCalendar method (defaults to false)\n\t * @param {Boolean=} options.processFreeBusy Whether or not to process VFreeBusy components (defaults to false)\n\t *\n\t * @returns {AbstractParser}\n\t */\n\tgetParserForFileType(fileType, options) {\n\t\tconst Parser = this._parsers.find(\n\t\t\t(parser) => parser.getMimeTypes().includes(fileType))\n\n\t\tif (!Parser) {\n\t\t\tthrow new TypeError('Unknown file-type.')\n\t\t}\n\n\t\treturn new Parser(options)\n\t}\n\n\t/**\n\t * Registers a parser\n\t *\n\t * @param {Function} parser The parser to register\n\t */\n\tregisterParser(parser) {\n\t\tthis._parsers.push(parser)\n\t}\n\n}\n\n/**\n * Gets an instance of the ParserManager with all default parsers\n *\n * @returns {ParserManager}\n */\nexport function getParserManager() {\n\tconst parserManager = new ParserManager()\n\n\t// We only support iCalendar for now.\n\t// JSON calendar and CSV will be supported soon,\n\t// but require some more work\n\n\tparserManager.registerParser(ICalendarParser)\n\t// parserManager.registerParser(JCalendarParser)\n\t// parserManager.registerParser(CSVParser)\n\n\treturn parserManager\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\n/**\n * @class TimezoneAdapter\n * @classdesc Connecting ICAL.TimezoneService with our TimezoneManager\n */\nexport default class TimezoneAdapter {\n\n\t/**\n\t * Constructor\n\t *\n\t * @param {TimezoneManager} timezoneManager The timezone-manager to wrap\n\t */\n\tconstructor(timezoneManager) {\n\n\t\t/**\n\t\t * TimezoneManager object\n\t\t *\n\t\t * @type {TimezoneManager}\n\t\t * @private\n\t\t */\n\t\tthis._timezoneManager = timezoneManager\n\t}\n\n\t/**\n\t * @param {string} timezoneId The id of the timezone\n\t * @returns {boolean}\n\t */\n\thas(timezoneId) {\n\t\treturn this._timezoneManager.hasTimezoneForId(timezoneId)\n\t}\n\n\t/**\n\t * @param {String} timezoneId The id of the timezone\n\t * @returns {ICAL.Timezone|undefined}\n\t */\n\tget(timezoneId) {\n\t\tconst timezone = this._timezoneManager.getTimezoneForId(timezoneId)\n\t\tif (!timezone) {\n\t\t\treturn undefined\n\t\t}\n\n\t\treturn timezone.toICALTimezone()\n\t}\n\n\t/**\n\t * @throws TypeError\n\t */\n\tregister() {\n\t\tthrow new TypeError('Not allowed to register new timezone')\n\t}\n\n\t/**\n\t * @throws TypeError\n\t */\n\tremove() {\n\t\tthrow new TypeError('Not allowed to remove timezone')\n\t}\n\n\t/**\n\t * @throws TypeError\n\t */\n\treset() {\n\t\tthrow new TypeError('Not allowed to reset TimezoneService')\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nexport default class IllegalValueError extends Error {}\n","/**\n * @copyright Copyright (c) 2021 Christoph Wurst\n *\n * @author Christoph Wurst <christoph@winzerhof-wurst.at>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\n/**\n *\n * @param {string[]} timezoneList List of Olsen timezones\n * @param {Array} additionalTimezones List of additional timezones\n * @param {String} globalTimezoneName The localized name of the \"Global\" timezones\n * @returns {[]}\n */\nexport function getSortedTimezoneList(timezoneList = [], additionalTimezones = [], globalTimezoneName = 'Global') {\n\tconst sortedByContinent = {}\n\tconst sortedList = []\n\n\tfor (const timezoneId of timezoneList) {\n\t\tconst components = timezoneId.split('/')\n\t\tlet [continent, name] = [components.shift(), components.join('/')]\n\t\tif (!name) {\n\t\t\tname = continent\n\t\t\tcontinent = globalTimezoneName\n\t\t}\n\n\t\tsortedByContinent[continent] = sortedByContinent[continent] || {\n\t\t\tcontinent,\n\t\t\tregions: [],\n\t\t}\n\n\t\tsortedByContinent[continent].regions.push({\n\t\t\tlabel: getReadableTimezoneName(name),\n\t\t\tcities: [],\n\t\t\ttimezoneId,\n\t\t})\n\t}\n\n\tfor (const additionalTimezone of additionalTimezones) {\n\t\tconst { continent, label, timezoneId } = additionalTimezone\n\n\t\tsortedByContinent[continent] = sortedByContinent[continent] || {\n\t\t\tcontinent,\n\t\t\tregions: [],\n\t\t}\n\n\t\tsortedByContinent[continent].regions.push({\n\t\t\tlabel,\n\t\t\tcities: [],\n\t\t\ttimezoneId,\n\t\t})\n\t}\n\n\tfor (const continent in sortedByContinent) {\n\t\tif (!Object.prototype.hasOwnProperty.call(sortedByContinent, continent)) {\n\t\t\tcontinue\n\t\t}\n\n\t\tsortedByContinent[continent].regions.sort((a, b) => {\n\t\t\tif (a.label < b.label) {\n\t\t\t\treturn -1\n\t\t\t}\n\n\t\t\treturn 1\n\t\t})\n\t\tsortedList.push(sortedByContinent[continent])\n\t}\n\n\t// Sort continents by name\n\tsortedList.sort((a, b) => {\n\t\tif (a.continent < b.continent) {\n\t\t\treturn -1\n\t\t}\n\n\t\treturn 1\n\t})\n\n\treturn sortedList\n}\n\n/**\n * Get human-readable name for timezoneId\n *\n * @param {string} timezoneId TimezoneId to turn human-readable\n * @returns {string}\n */\nexport function getReadableTimezoneName(timezoneId) {\n\treturn timezoneId\n\t\t.split('_')\n\t\t.join(' ')\n\t\t.replace('St ', 'St. ')\n\t\t.split('/')\n\t\t.join(' - ')\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <georg-nextcloud@ehrke.email>\n *\n * @author Richard Steinmetz <richard@steinmetz.cloud>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport { getParserManager } from './parsers/parserManager.js'\nimport TimezoneAdapter from './timezones/timezoneAdapter.js'\nimport { getTimezoneManager } from './timezones/timezoneManager.js'\nimport { v4 as uuid } from 'uuid'\nimport DateTimeValue from './values/dateTimeValue.js'\nimport { dateFactory } from './factories/dateFactory.js'\nimport CalendarComponent from './components/calendarComponent.js'\nimport EventComponent from './components/root/eventComponent.js'\nimport RecurrenceManager from './recurrence/recurrenceManager.js'\nimport FreeBusyComponent from './components/root/freeBusyComponent.js'\nimport ICAL from 'ical.js'\n\nif (!(ICAL.TimezoneService instanceof TimezoneAdapter)) {\n\tICAL.TimezoneService = new TimezoneAdapter(getTimezoneManager())\n}\n\n/**\n * parses a single ICS and returns an iterator over all occurrences\n * in a given timeframe\n *\n * @param {String} ics The calendar-data to parse\n * @param {DateTimeValue} start The start of the queried time-range\n * @param {DateTimeValue} end The end of the queried time-range\n */\nexport function * parseICSAndGetAllOccurrencesBetween(ics, start, end) {\n\tconst parserManager = getParserManager()\n\tconst icsParser = parserManager.getParserForFileType('text/calendar')\n\ticsParser.parse(ics)\n\n\tconst objectIterator = icsParser.getItemIterator()\n\tconst calendarComp = objectIterator.next().value\n\tif (calendarComp === undefined) {\n\t\treturn\n\t}\n\n\tconst vObjectIterator = calendarComp.getVObjectIterator()\n\tconst firstVObject = vObjectIterator.next().value\n\tif (firstVObject === undefined) {\n\t\treturn\n\t}\n\n\tyield * firstVObject.recurrenceManager.getAllOccurrencesBetweenIterator(start, end)\n}\n\n/**\n * Creates a new event\n *\n * @param {DateTimeValue} start Start-time of the new event\n * @param {DateTimeValue} end End-time of the new event\n * @returns {CalendarComponent}\n */\nexport function createEvent(start, end) {\n\tconst calendar = CalendarComponent.fromEmpty()\n\tconst eventComponent = new EventComponent('VEVENT')\n\n\teventComponent.updatePropertyWithValue('CREATED', DateTimeValue.fromJSDate(dateFactory(), true))\n\teventComponent.updatePropertyWithValue('DTSTAMP', DateTimeValue.fromJSDate(dateFactory(), true))\n\teventComponent.updatePropertyWithValue('LAST-MODIFIED', DateTimeValue.fromJSDate(dateFactory(), true))\n\teventComponent.updatePropertyWithValue('SEQUENCE', 0)\n\teventComponent.updatePropertyWithValue('UID', uuid())\n\teventComponent.updatePropertyWithValue('DTSTART', start)\n\teventComponent.updatePropertyWithValue('DTEND', end)\n\n\tcalendar.addComponent(eventComponent)\n\teventComponent.recurrenceManager = new RecurrenceManager(eventComponent)\n\n\treturn calendar\n}\n\n/**\n * Creates a FreeBusy Request to be used on the scheduling outbox\n *\n * @param {DateTimeValue} start The start of the queried time-range\n * @param {DateTimeValue} end The end of the queried time-range\n * @param {AttendeeProperty} organizer The organizer querying information\n * @param {AttendeeProperty[]}attendees The list of attendees to query information for\n * @returns {CalendarComponent}\n */\nexport function createFreeBusyRequest(start, end, organizer, attendees) {\n\tconst calendar = CalendarComponent.fromMethod('REQUEST')\n\tconst freeBusyComponent = new FreeBusyComponent('VFREEBUSY')\n\n\tfreeBusyComponent.updatePropertyWithValue('DTSTAMP', DateTimeValue.fromJSDate(dateFactory(), true))\n\tfreeBusyComponent.updatePropertyWithValue('UID', uuid())\n\tfreeBusyComponent.updatePropertyWithValue('DTSTART', start.clone().getInUTC())\n\tfreeBusyComponent.updatePropertyWithValue('DTEND', end.clone().getInUTC())\n\tfreeBusyComponent.addProperty(organizer.clone())\n\n\tfor (const attendee of attendees) {\n\t\tconst clonedAttendee = attendee.clone()\n\t\tclonedAttendee.deleteParameter('ROLE')\n\t\tclonedAttendee.deleteParameter('CUTYPE')\n\t\tclonedAttendee.deleteParameter('RSVP')\n\t\tclonedAttendee.deleteParameter('PARTSTAT')\n\t\tclonedAttendee.deleteParameter('REQUEST-STATUS')\n\t\tclonedAttendee.deleteParameter('LANGUAGE')\n\n\t\tfreeBusyComponent.addProperty(clonedAttendee)\n\t}\n\n\tcalendar.addComponent(freeBusyComponent)\n\treturn calendar\n}\n\nexport { setConfig } from './config.js'\nexport { getParserManager }\nexport { getTimezoneManager, isOlsonTimezone } from './timezones/timezoneManager.js'\nexport * from './components'\nexport * from './errors'\nexport * from './parameters'\nexport * from './parsers'\nexport * from './properties'\nexport * from './recurrence'\nexport * from './timezones'\nexport * from './values'\n"],"names":["AbstractParser","constructor","options","new","target","TypeError","_options","Object","assign","_name","_color","_sourceURL","_refreshInterval","_calendarTimezone","_errors","getName","getColor","offersWebcalFeed","getSourceURL","getRefreshInterval","getCalendarTimezone","parse","data","getItemIterator","getAllItems","Array","from","containsVEvents","containsVJournals","containsVTodos","containsVFreeBusy","hasErrors","length","getErrorList","slice","getItemCount","_getOption","name","defaultValue","prototype","hasOwnProperty","call","getMimeTypes","ModificationNotAllowedError","Error","lockableTrait","baseClass","args","_mutable","isLocked","lock","unlock","_modify","_modifyContent","ExpectedICalJSError","lc","str","toLowerCase","uc","toUpperCase","ucFirst","charAt","startStringWith","startWith","startsWith","GLOBAL_CONFIG","Map","setConfig","key","value","set","getConfig","get","createComponent","componentName","ICAL","Component","createProperty","propertyName","Property","observerTrait","_subscribers","subscribe","handler","push","unsubscribe","index","indexOf","splice","_notifySubscribers","Parameter","_value","getFirstValue","isMultiValue","getValueIterator","Symbol","iterator","isArray","clone","parameter","AbstractValue","icalValue","_innerValue","toICALJs","BinaryValue","rawValue","decodeValue","decodedValue","setEncodedValue","fromRawValue","fromICALJs","icalBinary","Binary","fromDecodedValue","DurationValue","weeks","days","hours","minutes","seconds","isNegative","totalSeconds","toSeconds","fromSeconds","compare","otherDuration","addDuration","normalize","subtractDuration","icalDuration","Duration","fromData","DateTimeValue","year","month","day","hour","minute","second","timezoneId","zone","tzid","timezone","isDate","unixTime","toUnixTime","jsDate","toJSDate","duration","subtractDateWithoutTimezone","other","subtractDate","subtractDateWithTimezone","subtractDateTz","compareDateOnlyInGivenTimezone","compareDateOnlyTz","toICALTimezone","getInTimezone","clonedICALTime","convertToZone","getICALTimezone","getInICALTimezone","getInUTC","Timezone","utcTimezone","silentlyReplaceTimezone","Time","replaceTimezone","utcOffset","isFloatingTime","fromJSDate","useUTC","undefined","SUNDAY","MONDAY","TUESDAY","WEDNESDAY","THURSDAY","FRIDAY","SATURDAY","DEFAULT_WEEK_START","PeriodValue","_start","start","_end","_duration","end","getEnd","getDuration","fromDataWithEnd","icalPeriod","Period","fromDataWithDuration","ALLOWED_FREQ","RecurValue","until","_until","interval","parseInt","weekStart","wkst","count","frequency","freq","includes","setToInfinite","isFinite","isByCount","addComponent","setComponent","parts","removeComponent","getComponent","isRuleValid","icalRecur","Recur","UTCOffsetValue","factor","icalUTCOffset","UtcOffset","UnknownICALTypeError","getConstructorForICALType","icaltype","parameters","root","parent","_parameters","_root","_parent","_setParametersFromConstructor","addValue","hasValue","removeValue","setParameter","getParameter","parameterName","getParametersIterator","values","getParameterFirstValue","hasParameter","has","deleteParameter","delete","updateParameterIfExist","isDecoratedValue","_cloneValue","map","val","forEach","icalProperty","isDecorated","getValues","paramNames","keys","toJSON","paramName","setValues","setValue","firstValue","AttachmentProperty","formatType","fmtType","uri","encoding","binaryValue","property","fromLink","AttendeeProperty","role","allowed","userType","rsvp","commonName","participationStatus","vobjectType","VEVENT","VJOURNAL","VTODO","language","email","isOrganizer","fromNameAndEMail","fromNameEMailRoleUserTypeAndRSVP","design","icalendar","conference","defaultType","param","feature","valueType","multiValue","ConferenceProperty","getFeatureIterator","listAllFeatures","addFeature","featureToAdd","hasFeature","removeFeature","clearAllFeatures","label","fromURILabelAndFeatures","features","FreeBusyProperty","type","fromPeriodAndType","period","GeoProperty","latitude","lat","parseFloat","longitude","long","fromPosition","ImageProperty","display","RelationProperty","relationType","relatedId","fromRelTypeAndId","relType","relId","RequestStatusProperty","statusCode","toString","Math","floor","statusMessage","exceptionData","isPending","isSuccessful","isClientError","isSchedulingError","fromCodeAndMessage","code","message","SUCCESS","SUCCESS_FALLBACK","SUCCESS_PROP_IGNORED","SUCCESS_PROPPARAM_IGNORED","SUCCESS_NONSTANDARD_PROP_IGNORED","SUCCESS_NONSTANDARD_PROPPARAM_IGNORED","SUCCESS_COMP_IGNORED","SUCCESS_FORWARDED","SUCCESS_REPEATING_IGNORED","SUCCESS_TRUNCATED_END","SUCCESS_REPEATING_VTODO_IGNORED","SUCCESS_UNBOUND_RRULE_CLIPPED","CLIENT_INVALID_PROPNAME","CLIENT_INVALID_PROPVALUE","CLIENT_INVALID_PROPPARAM","CLIENT_INVALID_PROPPARAMVALUE","CLIENT_INVALUD_CALENDAR_COMP_SEQ","CLIENT_INVALID_DATE_TIME","CLIENT_INVALID_RRULE","CLIENT_INVALID_CU","CLIENT_NO_AUTHORITY","CLIENT_UNSUPPORTED_VERSION","CLIENT_TOO_LARGE","CLIENT_REQUIRED_COMP_OR_PROP_MISSING","CLIENT_UNKNOWN_COMP_OR_PROP","CLIENT_UNSUPPORTED_COMP_OR_PROP","CLIENT_UNSUPPORTED_CAPABILITY","SCHEDULING_EVENT_CONFLICT","SERVER_REQUEST_NOT_SUPPORTED","SERVER_SERVICE_UNAVAILABLE","SERVER_INVALID_CALENDAR_SERVICE","SERVER_NO_SCHEDULING_FOR_USER","TextProperty","alternateText","altRep","TriggerProperty","related","isRelative","fromAbsolute","alarmTime","fromRelativeAndRelated","alarmOffset","relatedToStart","getConstructorForPropertyName","propName","AbstractComponent","properties","components","_properties","_components","_setPropertiesFromConstructor","_setComponentsFromConstructor","getPropertyIterator","component","getComponentIterator","getFirstProperty","getFirstPropertyFirstValue","updatePropertyWithValue","newProperty","addProperty","hasProperty","_getAllOfPropertyByLang","lang","_getFirstOfPropertyByLang","next","arr","deleteProperty","deleteAllProperties","getFirstComponent","hasComponent","deleteComponent","deleteAllComponents","newComponent","icalProp","getAllProperties","icalComp","getAllSubcomponents","_getConstructorForComponentName","prop","comp","addSubcomponent","advertiseSingleOccurrenceProperty","advertiseValueOnly","getDefaultOncePropConfig","defineProperty","iCalendarName","allowedValues","unknownValue","advertiseMultipleOccurrenceProperty","getDefaultMultiplePropConfig","pluralName","advertiseMultiValueStringPropertySeparatedByLang","languageParameter","advertiseComponent","getDefaultMultipleCompConfig","dateFactory","Date","RecurringWithoutDtStartError","RecurrenceManager","masterItem","_masterItem","_recurrenceExceptionItems","_rangeRecurrenceExceptionItemsIndex","_rangeRecurrenceExceptionItemsDiffCache","_rangeRecurrenceExceptionItems","getRecurrenceExceptionIterator","getRecurrenceExceptionList","hasRecurrenceExceptionForId","recurrenceId","getRecurrenceException","hasRangeRecurrenceExceptionForId","getRangeRecurrenceExceptionForId","helpers","binsearchInsert","a","b","getRangeRecurrenceExceptionDiff","recurrenceException","originalRecurrenceId","originalModifiedStart","startDate","difference","relateRecurrenceException","recurrenceExceptionItem","_getRecurrenceIdKey","modifiesFuture","recurrenceManager","removeRecurrenceException","removeRecurrenceExceptionByRecurrenceId","getRecurrenceRuleIterator","getRecurrenceRuleList","addRecurrenceRule","recurrenceRule","resetCache","removeRecurrenceRule","clearAllRecurrenceRules","getRecurrenceDateIterator","_getPropertiesForRecurrenceDate","listAllRecurrenceDates","addRecurrenceDate","_getValueTypeByValue","first","propertyValue","markPropertyAsDirty","_getPropertyNameByIsNegative","hasRecurrenceDate","getRecurrenceDate","valueToCheck","removeRecurrenceDate","allValues","clearAllRecurrenceDates","every","rule","isEmptyRecurrenceSet","_getRecurExpansionObject","getOccurrenceAtExactly","isRecurring","getReferenceRecurrenceId","icalRecurrenceId","_getOccurrenceAtRecurrenceId","getClosestOccurrence","previous","dateTimeValue","getAllOccurrencesBetweenIterator","queriedTimeRangeStart","queriedTimeRangeEnd","isInTimeFrame","queriedICALJsTimeRangeStart","queriedICALJsTimeRangeEnd","recurrenceIdKeys","maximumRecurrenceId","max","apply","occurrence","compareDate","endDate","isRecurrenceException","size","getAllOccurrencesBetween","updateUID","newUID","updateStartDateOfMasterItem","newStartDate","oldStartDate","exdate","rrule","canCreateRecurrenceExceptions","forkItem","rangeRecurrenceException","dtstart","last","ruleIterators","ruleDateInc","ruleDates","ruleDate","exDates","complete","ruleValue","rDateValue","exDateValue","exDateInc","exDate","RecurExpansion","TimezoneComponent","toTimezone","ics","_timezoneId","_ics","_initialized","offsetForArray","_initialize","time","timestampToArray","ms","fromUnixTime","local","toTimezoneComponent","jCal","utc","floating","localTimezone","AlarmComponent","addAttendeeFromNameAndEMail","attendeeProperty","trigger","setTriggerFromAbsolute","triggerProperty","setTriggerFromRelative","getConstructorForComponentName","compName","AbstractRecurringComponent","_primaryItem","_isExactForkOfPrimary","_originalRecurrenceId","_recurrenceManager","_dirty","_significantChange","_cachedId","primaryItem","isExactForkOfPrimary","isMasterItem","id","encodeURIComponent","uid","join","isPartOfRecurrenceSet","startDiff","originalTimezone","dtStartValue","recurrenceDate","dtEndValue","dueValue","dtEnd","due","resetDirty","primaryIsRecurring","createRecurrenceException","thisAndAllFuture","previousPrimaryItem","_overridePrimaryItem","removeThisOccurrence","uuid","addRelation","fromEmpty","attendee","getAttendeeIterator","recurDate","valueDateTimeRecurDate","recurValue","exceptionDate","exception","_addAttendee","addAttendeeFromNameEMailRoleUserTypeAndRSVP","setOrganizerFromNameAndEMail","addAttachmentFromData","addAttachmentFromLink","addContact","contact","addComment","comment","addImageFromData","addImageFromLink","addRequestStatus","addAbsoluteAlarm","action","alarmComp","addRelativeAlarm","markDirty","props","markChangesAsSignificant","markSubComponentAsDirty","isDirty","undirtify","sequence","getTypeOfBirthdayEvent","eventComponent","getIconForBirthday","birthdayType","getAgeOfBirthday","yearOfOccurrence","yearOfBirth","EventComponent","isAllDay","canModifyAllDay","dtend","setGeographicalPositionFromLatitudeAndLongitude","addConference","addDurationToStart","addDurationToEnd","shiftByDuration","delta","allDay","defaultTimezone","defaultAllDayDuration","defaultTimedDuration","currentAllDay","isBirthdayEvent","getIconForBirthdayEvent","getAgeForBirthdayEvent","toICSEntireSeries","toICS","toICSThisOccurrence","FreeBusyComponent","getFreeBusyIterator","JournalComponent","addDescription","description","ToDoComponent","propertiesToCheck","propertyToCheck","dueTime","geographicalPosition","CalendarComponent","getTimezoneIterator","getVObjectIterator","getEventIterator","getJournalIterator","getTodoIterator","getFreebusyIterator","cleanUpTimezones","vObject","icalRoot","updateTimezones","additionalProps","concat","fromMethod","method","AbstractRepairStep","repair","input","priority","ICalendarAddMissingUIDRepairStep","replace","match","vobjectName","vObjectBlock","ICalendarAddMissingValueDateDoubleColonRepairStep","date","ICalendarAddMissingValueDateRepairStep","_","ICalendarEmptyTriggerRepairStep","ICalendarIllegalCreatedRepairStep","ICalendarMultipleVCalendarBlocksRepairStep","containsProdId","containsVersion","containsCalscale","includedTimezones","Set","tzidMatcher","add","ICalendarRemoveXNCGroupIdRepairStep","getRepairSteps","TimezoneManager","_aliases","_timezones","getTimezoneForId","_getTimezoneForIdRec","level","console","error","resolvedTimezoneId","hasTimezoneForId","isAlias","listAllTimezones","includeAliases","timezones","registerTimezone","registerDefaultTimezones","debug","tzData","version","zones","registerTimezoneFromICS","aliases","registerAlias","aliasTo","aliasName","unregisterTimezones","unregisterAlias","clearAllTimezones","timezoneManager","getTimezoneManager","isOlsonTimezone","tzName","hasSlash","hasSpace","startsWithETC","startsWithUS","ICalendarParser","_rawData","_calendarComponent","_containsVEvents","_containsVJournals","_containsVTodos","_containsVFreeBusy","_items","_masterItems","_forgedMasterItems","_requiredTimezones","_defaultTimezoneManager","_applyRepairSteps","_extractTimezones","_registerTimezones","_createCalendarComponent","_extractProperties","_processVObjects","_processVFreeBusy","itemList","calendarComp","_addRequiredTimezonesToCalendarComp","item","RepairStep","step","_extractPropertyAndPutResultIntoVariable","names","variableName","matches","_addItem","_markCompTypeAsSeen","_addRecurrenceException","_addRequiredTimezone","alarm","getAlarmIterator","recurrenceExceptionList","forgedMaster","stampTime","master","requiredTimezone","_replaceTimezoneWithAnotherOne","timezoneComponent","calendarComponent","searchTimezone","ParserManager","_parsers","getAllSupportedFileTypes","reduce","allFileTypes","parser","getParserForFileType","fileType","Parser","find","registerParser","getParserManager","parserManager","TimezoneAdapter","_timezoneManager","register","remove","reset","IllegalValueError","getSortedTimezoneList","timezoneList","additionalTimezones","globalTimezoneName","sortedByContinent","sortedList","split","continent","shift","regions","getReadableTimezoneName","cities","additionalTimezone","sort","TimezoneService","parseICSAndGetAllOccurrencesBetween","icsParser","objectIterator","vObjectIterator","firstVObject","createEvent","calendar","createFreeBusyRequest","organizer","attendees","freeBusyComponent","clonedAttendee"],"mappings":"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A;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAMS,aAAa,GAAG,IAAIC,GAAJ,EAAtB,CAAA;AAEA;AACA;AACA;AACA;AACA;AACA;;AACO,SAASC,SAAT,CAAmBC,GAAnB,EAAwBC,KAAxB,EAA+B;AACrCJ,EAAAA,aAAa,CAACK,GAAd,CAAkBF,GAAlB,EAAuBC,KAAvB,CAAA,CAAA;AACA,CAAA;AAYD;AACA;AACA;AACA;AACA;AACA;AACA;;AACO,SAASE,SAAT,CAAmBH,GAAnB,EAAwB9B,YAAxB,EAAsC;AAC5C,EAAA,OAAO2B,aAAa,CAACO,GAAd,CAAkBJ,GAAlB,KAA0B9B,YAAjC,CAAA;AACA;;ACxDD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAMA;AACA;AACA;AACA;AACA;AACA;;AACO,SAASmC,eAAT,CAAyBC,aAAzB,EAAwC;EAC9C,OAAO,IAAIC,IAAI,CAACC,SAAT,CAAmBrB,EAAE,CAACmB,aAAD,CAArB,CAAP,CAAA;AACA,CAAA;AAED;AACA;AACA;AACA;AACA;AACA;;AACO,SAASG,cAAT,CAAwBC,YAAxB,EAAsC;EAC5C,OAAO,IAAIH,IAAI,CAACI,QAAT,CAAkBxB,EAAE,CAACuB,YAAD,CAApB,CAAP,CAAA;AACA;;AC5CD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEe,SAASE,aAAT,CAAuBlC,SAAvB,EAAkC;AAEhD;AACD;AACA;EACC,OAAO,cAAcA,SAAd,CAAwB;AAE9B;AACF;AACA;IACE7C,WAAW,CAAC,GAAG8C,IAAJ,EAAU;AACpB,MAAA,KAAA,CAAM,GAAGA,IAAT,CAAA,CAAA;AAEA;AACH;AACA;AACA;AACA;AACA;;MACG,IAAKkC,CAAAA,YAAL,GAAoB,EAA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CA;AACA;AACA;AACA;;AACAyX,iCAAiC,CAAC4I,cAAc,CAACrgB,SAAhB,EAA2B,aAA3B,CAAjC,CAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACAyX,iCAAiC,CAAC4I,cAAc,CAACrgB,SAAhB,EAA2B,SAA3B,CAAjC,CAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACAyX,iCAAiC,CAAC4I,cAAc,CAACrgB,SAAhB,EAA2B,UAA3B,CAAjC,CAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACAyX,iCAAiC,CAAC4I,cAAc,CAACrgB,SAAhB,EAA2B,QAA3B,CAAjC,CAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACAyX,iCAAiC,CAAC4I,cAAc,CAACrgB,SAAhB,EAA2B;AAC3DF,EAAAA,IAAI,EAAE,YADqD;AAE3D+X,EAAAA,aAAa,EAAE,QAAA;AAF4C,CAA3B,CAAjC,CAAA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACAG,mCAAmC,CAACqI,cAAc,CAACrgB,SAAhB,EAA2B,UAA3B,CAAnC;;AC7MA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACO,SAAS4gB,gCAAT,CAAwCC,QAAxC,EAAkD;EACxD,QAAQ1f,EAAE,CAAC0f,QAAD,CAAV;AACA,IAAA,KAAK,QAAL;AACC,MAAA,OAAOR,cAAP,CAAA;;AAED,IAAA;AACC,MAAA,OAAOhL,iBAAP,CAAA;AALD,GAAA;AAOA;;ACzCD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA0BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACe,MAAMyL,0BAAN,SAAyCzL,iBAAzC,CAA2D;AAEzE;AACD;AACA;EACC3X,WAAW,CAAC,GAAG8C,IAAJ,EAAU;AACpB,IAAA,KAAA,CAAM,GAAGA,IAAT,CAAA,CAAA;AAEA;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;IACE,IAAKugB,CAAAA,YAAL,GAAoB,IAApB,CAAA;AAEA;AACF;AACA;AACA;AACA;AACA;AACA;;IACE,IAAKC,CAAAA,qBAAL,GAA6B,KAA7B,CAAA;AAEA;AACF;AACA;AACA;AACA;AACA;AACA;;IACE,IAAKC,CAAAA,qBAAL,GAA6B,IAA7B,CAAA;AAEA;AACF;AACA;AACA;AACA;AACA;AACA;AACA;;IACE,IAAKC,CAAAA,kBAAL,GAA0B,IAA1B,CAAA;AAEA;AACF;AACA;AACA;AACA;AACA;AACA;AACA;;IACE,IAAKC,CAAAA,MAAL,GAAc,KAAd,CAAA;AAEA;AACF;AACA;AACA;AACA;AACA;AACA;AACA;;IACE,IAAKC,CAAAA,kBAAL,GAA0B,KAA1B,CAAA;AAEA;AACF;AACA;AACA;AACA;AACA;;IACE,IAAKC,CAAAA,SAAL,GAAiB,IAAjB,CAAA;AACA,GAAA;AAED;AACD;AACA;AACA;AACA;;;AACgB,EAAA,IAAXC,WAAW,GAAG;AACjB,IAAA,OAAO,KAAKP,YAAZ,CAAA;AACA,GAAA;AAED;AACD;AACA;AACA;AACA;;;EACgB,IAAXO,WAAW,CAACA,WAAD,EAAc;AAC5B,IAAA,IAAA,CAAKzgB,OAAL,EAAA,CAAA;;IACA,IAAKkgB,CAAAA,YAAL,GAAoBO,WAApB,CAAA;AACA,GAAA;AAED;AACD;AACA;AACA;AACA;AACA;;;AACyB,EAAA,IAApBC,oBAAoB,GAAG;AAC1B,IAAA,OAAO,KAAKP,qBAAZ,CAAA;AACA,GAAA;AAED;AAC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;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AACAG,mCAAmC,CAAC8I,0BAA0B,CAAC9gB,SAA5B,EAAuC;AACzEF,EAAAA,IAAI,EAAE,UAAA;AADmE,CAAvC,CAAnC,CAAA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AACAkY,mCAAmC,CAAC8I,0BAA0B,CAAC9gB,SAA5B,EAAuC;AACzEF,EAAAA,IAAI,EAAE,YADmE;AAEzE+X,EAAAA,aAAa,EAAE,QAAA;AAF0D,CAAvC,CAAnC,CAAA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AACAG,mCAAmC,CAAC8I,0BAA0B,CAAC9gB,SAA5B,EAAuC;AACzEF,EAAAA,IAAI,EAAE,UADmE;AAEzE+X,EAAAA,aAAa,EAAE,YAAA;AAF0D,CAAvC,CAAnC,CAAA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AACAG,mCAAmC,CAAC8I,0BAA0B,CAAC9gB,SAA5B,EAAuC,SAAvC,CAAnC,CAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AACAgY,mCAAmC,CAAC8I,0BAA0B,CAAC9gB,SAA5B,EAAuC,SAAvC,CAAnC,CAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA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ACA;;AACAyX,iCAAiC,CAAC4N,cAAc,CAACrlB,SAAhB,EAA2B;AAC3DF,EAAAA,IAAI,EAAE,UADqD;AAE3DgY,EAAAA,aAAa,EAAE5Y,KAAK,CAAC,CAAD,CAAL,CAASoO,IAAT,EAF4C;AAG3DvN,EAAAA,YAAY,EAAE,CAH6C;AAI3DgY,EAAAA,YAAY,EAAE,CAAA;AAJ6C,CAA3B,CAAjC,CAAA;AAOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACAI,gDAAgD,CAACkN,cAAc,CAACrlB,SAAhB,EAA2B;AAC1EF,EAAAA,IAAI,EAAE,UADoE;AAE1E+X,EAAAA,aAAa,EAAE,WAAA;AAF2D,CAA3B,CAAhD,CAAA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACAG,mCAAmC,CAACqN,cAAc,CAACrlB,SAAhB,EAA2B,YAA3B,CAAnC;;ACxcA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAQA;AACA;AACA;AACA;AACA;AACA;;AACe,MAAM0mB,iBAAN,SAAgCrR,iBAAhC,CAAkD;AAEhE;AACD;AACA;AACA;AACA;AACc,EAAA,IAAT2E,SAAS,GAAG;AACf,IAAA,OAAO,IAAKhE,CAAAA,0BAAL,CAAgC,SAAhC,CAAP,CAAA;AACA,GAAA;AAED;AACD;AACA;AACA;AACA;;;EACc,IAATgE,SAAS,CAACA,SAAD,EAAY;AACxB,IAAA,IAAA,CAAKnZ,OAAL,EAAA,CAAA;;IACA,IAAKoV,CAAAA,uBAAL,CAA6B,SAA7B,EAAwC+D,SAAS,CAAC1S,aAAV,CAAwBM,QAAQ,CAACsY,GAAjC,CAAxC,CAAA,CAAA;AACA,GAAA;AAED;AACD;AACA;AACA;AACA;;;AACY,EAAA,IAAP3C,OAAO,GAAG;AACb,IAAA,OAAO,IAAKvH,CAAAA,0BAAL,CAAgC,OAAhC,CAAP,CAAA;AACA,GAAA;AAED;AACD;AACA;AACA;AACA;;;EACY,IAAPuH,OAAO,CAACA,OAAD,EAAU;AACpB,IAAA,IAAA,CAAK1c,OAAL,EAAA,CAAA;;IACA,IAAKoV,CAAAA,uBAAL,CAA6B,OAA7B,EAAsCsH,OAAO,CAACjW,aAAR,CAAsBM,QAAQ,CAACsY,GAA/B,CAAtC,CAAA,CAAA;AACA,GAAA;AAED;AACD;AACA;;;AACsB,EAAA,CAAnByG,mBAAmB,GAAG;AACvB,IAAA,OAAQ,IAAK/Q,CAAAA,mBAAL,CAAyB,UAAzB,CAAR,CAAA;AACA,GAAA;AAED;AACD;AACA;AACA;AACA;AACA;AACA;AACA;;;AACC0K,EAAAA,2BAA2B,CAACxgB,IAAD,EAAOkP,KAAP,EAAc;AACxC,IAAA,IAAA,CAAKnO,OAAL,EAAA,CAAA;;IACA,IAAKsV,CAAAA,WAAL,CAAiB/H,gBAAgB,CAACc,gBAAjB,CAAkCpP,IAAlC,EAAwCkP,KAAxC,CAAjB,CAAA,CAAA;AACA,GAAA;AAED;AACD;AACA;AACA;AACA;AACA;AACA;AACA;;;AACCyU,EAAAA,4BAA4B,CAAC3jB,IAAD,EAAOkP,KAAP,EAAc;AACzC,IAAA,IAAA,CAAKnO,OAAL,EAAA,CAAA;;IACA,IAAK8V,CAAAA,mBAAL,CAAyB,WAAzB,CAAA,CAAA;IACA,IAAKR,CAAAA,WAAL,CAAiB/H,gBAAgB,CAACc,gBAAjB,CAAkCpP,IAAlC,EAAwCkP,KAAxC,EAA+C,IAA/C,CAAjB,CAAA,CAAA;AACA,GAAA;;AAxE+D,CAAA;AA4EjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACAyI,iCAAiC,CAACiP,iBAAiB,CAAC1mB,SAAnB,EAA8B,WAA9B,CAAjC,CAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACAyX,iCAAiC,CAACiP,iBAAiB,CAAC1mB,SAAnB,EAA8B,KAA9B,CAAjC,CAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACAgY,mCAAmC,CAAC0O,iBAAiB,CAAC1mB,SAAnB,EAA8B,UAA9B,CAAnC;;ACxKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAKA;AACA;AACA;AACA;AACA;AACA;;AACe,MAAM4mB,gBAAN,SAA+B9F,0BAA/B,CAA0D;AAExE;AACD;AACA;AACA;AACA;AACA;AACA;EACC+F,cAAc,CAACC,WAAD,EAAc;IAC3B,IAAK3Q,CAAAA,WAAL,CAAiB,IAAI3B,YAAJ,CAAiB,aAAjB,EAAgCsS,WAAhC,CAAjB,CAAA,CAAA;AACA,GAAA;;AAXuE,CAAA;AAezE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA9O,mCAAmC,CAAC4O,gBAAgB,CAAC5mB,SAAlB,EAA6B,aAA7B,CAAnC;;ACpFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAUA;AACA;AACA;AACA;AACA;AACA;;AACe,MAAM+mB,aAAN,SAA4BjG,0BAA5B,CAAuD;AAErE;AACD;AACA;AACA;AACA;AA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AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACAI,gDAAgD,CAAC4O,aAAa,CAAC/mB,SAAf,EAA0B;AACzEF,EAAAA,IAAI,EAAE,UADmE;AAEzE+X,EAAAA,aAAa,EAAE,WAAA;AAF0D,CAA1B,CAAhD,CAAA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACAG,mCAAmC,CAAC+O,aAAa,CAAC/mB,SAAf,EAA0B,YAA1B,CAAnC;;AC7XA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AASA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACO,SAAS4gB,8BAAT,CAAwCC,QAAxC,EAAkD;EACxD,QAAQ1f,EAAE,CAAC0f,QAAD,CAAV;AACA,IAAA,KAAK,QAAL;AACC,MAAA,OAAOwE,cAAP,CAAA;;AAED,IAAA,KAAK,WAAL;AACC,MAAA,OAAOqB,iBAAP,CAAA;;AAED,IAAA,KAAK,UAAL;AACC,MAAA,OAAOE,gBAAP,CAAA;;AAED,IAAA,KAAK,WAAL;AACC,MAAA,OAAOzH,iBAAP,CAAA;;AAED,IAAA,KAAK,OAAL;AACC,MAAA,OAAO4H,aAAP,CAAA;;AAED,IAAA;AACC,MAAA,OAAO1R,iBAAP,CAAA;AAjBD,GAAA;AAmBA;;ACzDD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAQA;AACA;AACA;AACA;AACA;;AACe,MAAM+R,iBAAN,SAAgC/R,iBAAhC,CAAkD;AAEhE;AACD;AACA;AACA;AACA;AACC3X,EAAAA,WAAW,CAACoC,IAAI,GAAG,WAAR,EAAqBwV,UAAU,GAAG,EAAlC,EAAsCC,UAAU,GAAG,EAAnD,EAAuD;AACjE,IAAA,KAAA,CAAMzV,IAAN,EAAYwV,UAAZ,EAAwBC,UAAxB,CAAA,CAAA;IACA,IAAK9J,CAAAA,IAAL,GAAY,IAAZ,CAAA;IACA,IAAKC,CAAAA,MAAL,GAAc,IAAd,CAAA;AACA,GAAA;AAED;AACD;AACA;;;AACsB,EAAA,CAAnB2b,mBAAmB,GAAG;AACvB,IAAA,OAAQ,IAAKvR,CAAAA,oBAAL,CAA0B,WAA1B,CAAR,CAAA;AACA,GAAA;AAED;AACD;AACA;;;AACqB,EAAA,CAAlBwR,kBAAkB,GAAG;IACtB,OAAQ,IAAA,CAAKC,gBAAL,EAAR,CAAA;IACA,OAAQ,IAAA,CAAKC,kBAAL,EAAR,CAAA;IACA,OAAQ,IAAA,CAAKC,eAAL,EAAR,CAAA;AACA,GAAA;AAED;AACD;AACA;;;AACmB,EAAA,CAAhBF,gBAAgB,GAAG;AACpB,IAAA,OAAQ,IAAKzR,CAAAA,oBAAL,CAA0B,QAA1B,CAAR,CAAA;AACA,GAAA;AAED;AACD;AACA;;;AACsB,EAAA,CAAnB4R,mBAAmB,GAAG;AACvB,IAAA,OAAQ,IAAK5R,CAAAA,oBAAL,CAA0B,WAA1B,CAAR,CAAA;AACA,GAAA;AAED;AACD;AACA;;;AACqB,EAAA,CAAlB0R,kBAAkB,GAAG;AACtB,IAAA,OAAQ,IAAK1R,CAAAA,oBAAL,CAA0B,UAA1B,CAAR,CAAA;AACA,GAAA;AAED;AACD;AACA;;;AACkB,EAAA,CAAf2R,eAAe,GAAG;AACnB,IAAA,OAAQ,IAAK3R,CAAAA,oBAAL,CAA0B,OAA1B,CAAR,CAAA;AACA,GAAA;AAED;AACD;AACA;;;EACuC,OAA/BuB,+BAA+B,CAAClV,aAAD,EAAgB;IACrD,OAAOye,8BAA8B,CAACze,aAAD,CAArC,CAAA;AACA,GAAA;AAED;AACD;AACA;AACA;AACA;AACA;;;AACCqkB,EAAAA,KAAK,CAACmB,gBAAgB,GAAG,IAApB,EAA0B;AAC9B,IAAA,KAAK,MAAMC,OAAX,IAAsB,IAAKN,CAAAA,kBAAL,EAAtB,EAAiD;AAChDM,MAAAA,OAAO,CAAChD,SAAR,EAAA,CAAA;AACA,KAAA;;AAED,IAAA,MAAMiD,QAAQ,GAAG,IAAK7jB,CAAAA,QAAL,EAAjB,CAAA;;AACA,IAAA,IAAI2jB,gBAAJ,EAAsB;AACrBvlB,MAAAA,IAAI,CAACoX,OAAL,CAAasO,eAAb,CAA6BD,QAA7B,CAAA,CAAA;AACA,KAAA;;IACD,OAAOA,QAAQ,CAACjW,QAAT,EAAP,CAAA;AACA,GAAA;AAED;AACD;AACA;AACA;AACA;AACA;;;AACiB,EAAA,OAATmR,SAAS,CAACgF,eAAe,GAAG,EAAnB,EAAuB;AACtC,IAAA,OAAO,IAAI,IAAJ,CAAS,WAAT,EAAsB,CAC5B,CAAC,QAAD,EAAW/lB,SAAS,CAAC,QAAD,EAAW,wCAAX,CAApB,CAD4B,EAE5B,CAAC,UAAD,EAAa,WAAb,CAF4B,EAG5B,CAAC,SAAD,EAAY,KAAZ,CAH4B,CAI3BgmB,CAAAA,MAJ2B,CAIpBD,eAJoB,CAAtB,CAAP,CAAA;AAKA,GAAA;AAED;AACD;AACA;AACA;AACA;AACA;;;EACkB,OAAVE,UAAU,CAACC,MAAD,EAAS;IACzB,OAAO,IAAA,CAAKnF,SAAL,CAAe,CAAC,CAAC,QAAD,EAAWmF,MAAX,CAAD,CAAf,CAAP,CAAA;AACA,GAAA;AAED;AACD;AACA;;;EACkB,OAAV3jB,UAAU,CAACT,SAAD,EAAY;AAC5B,IAAA,MAAMyT,IAAI,GAAG,KAAA,CAAMhT,UAAN,CAAiBT,SAAjB,CAAb,CAAA;IACAyT,IAAI,CAAC9L,IAAL,GAAY8L,IAAZ,CAAA;AAEA,IAAA,OAAOA,IAAP,CAAA;AACA,GAAA;;AAlH+D,CAAA;AAsHjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACAE,iCAAiC,CAAC2P,iBAAiB,CAACpnB,SAAnB,EAA8B;AAC9DF,EAAAA,IAAI,EAAE,WADwD;AAE9D+X,EAAAA,aAAa,EAAE,QAAA;AAF+C,CAA9B,CAAjC,CAAA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEAJ,iCAAiC,CAAC2P,iBAAiB,CAACpnB,SAAnB,EAA8B;AAC9DF,EAAAA,IAAI,EAAE,SAAA;AADwD,CAA9B,CAAjC,CAAA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA2X,iCAAiC,CAAC2P,iBAAiB,CAACpnB,SAAnB,EAA8B;AAC9DF,EAAAA,IAAI,EAAE,eADwD;AAE9D+X,EAAAA,aAAa,EAAE,UAF+C;AAG9D9X,EAAAA,YAAY,EAAE,WAAA;AAHgD,CAA9B,CAAjC,CAAA;AAMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA0X,iCAAiC,CAAC2P,iBAAiB,CAACpnB,SAAnB,EAA8B;AAC9DF,EAAAA,IAAI,EAAE,QAAA;AADwD,CAA9B,CAAjC;;AC/MA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACe,MAAMqoB,kBAAN,CAAyB;AAEvC;AACD;AACA;AACCzqB,EAAAA,WAAW,GAAG;AACb,IAAA,IAAIE,GAAG,CAACC,MAAJ,KAAesqB,kBAAnB,EAAuC;AACtC,MAAA,MAAM,IAAIrqB,SAAJ,CAAc,sDAAd,CAAN,CAAA;AACA,KAAA;AACD,GAAA;AAED;AACD;AACA;;;EACCsqB,MAAM,CAACC,KAAD,EAAQ;AACb,IAAA,MAAM,IAAIvqB,SAAJ,CAAc,6CAAd,CAAN,CAAA;AACA,GAAA;AAED;AACD;AACA;;;AACgB,EAAA,OAARwqB,QAAQ,GAAG;AACjB,IAAA,OAAO,CAAP,CAAA;AACA,GAAA;;AAvBsC;;AC1BxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAIA;AACA;AACA;;AACe,MAAMC,gCAAN,SAA+CJ,kBAA/C,CAAkE;AAEhF;AACD;AACA;AACA;AACA;EACCC,MAAM,CAAC/I,GAAD,EAAM;AACX,IAAA,OAAOA,GAAG,CACRmJ,OADK,CACG,yHADH,EAC8H,CAACC,KAAD,EAAQC,WAAR,EAAqBC,YAArB,KAAsC;AACzK,MAAA,OAAO,WAAWD,WAAX,GAAyB,MAAzB,GACJ,MADI,GACK7F,EAAI,EADT,GAEJ8F,YAFI,GAGJ,MAHI,GAGKD,WAHL,GAGmB,MAH1B,CAAA;AAIA,KANK,CAAP,CAAA;AAOA,GAAA;;AAf+E;;AC3BjF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;;AACe,MAAME,iDAAN,SAAgET,kBAAhE,CAAmF;AAEjG;AACD;AACA;AACA;AACA;EACCC,MAAM,CAAC/I,GAAD,EAAM;AACX,IAAA,OAAOA,GAAG,CACRmJ,OADK,CACG,yCADH,EAC8C,CAACC,KAAD,EAAQrT,QAAR,EAAkB5J,UAAlB,EAA8Bqd,IAA9B,KAAuC;AAC1F,MAAA,OAAOzT,QAAQ,GAAG,cAAX,GAA4ByT,IAAnC,CAAA;AACA,KAHK,CAAP,CAAA;AAIA,GAAA;;AAZgG;;AC1BlG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;;AACe,MAAMC,sCAAN,SAAqDX,kBAArD,CAAwE;AAEtF;AACD;AACA;AACA;AACA;EACCC,MAAM,CAAC/I,GAAD,EAAM;AACX,IAAA,OAAOA,GAAG,CACRmJ,OADK,CACG,oDADH,EACyD,CAACC,KAAD,EAAQrT,QAAR,EAAkB5J,UAAlB,EAA8Bud,CAA9B,EAAiCF,IAAjC,KAA0C;AACxG,MAAA,OAAOzT,QAAQ,GAAG5J,UAAX,GAAwB,cAAxB,GAAyCqd,IAAhD,CAAA;AACA,KAHK,CAAP,CAAA;AAIA,GAAA;;AAZqF;;AC1BvF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;;AACe,MAAMG,+BAAN,SAA8Cb,kBAA9C,CAAiE;AAE/E;AACD;AACA;AACA;AACA;EACCC,MAAM,CAAC/I,GAAD,EAAM;AACX,IAAA,OAAOA,GAAG,CACRmJ,OADK,CACG,eADH,EACoB,aADpB,CAAA,CAELA,OAFK,CAEG,gBAFH,EAEqB,aAFrB,CAAP,CAAA;AAGA,GAAA;;AAX8E;;AC3BhF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGe,MAAMS,iCAAN,SAAgDd,kBAAhD,CAAmE;AAEjF;AACD;AACA;AACA;AACA;EACCC,MAAM,CAAC/I,GAAD,EAAM;AACX,IAAA,OAAOA,GAAG,CACRmJ,OADK,CACG,8BADH,EACmC,0BADnC,CAAP,CAAA;AAEA,GAAA;;AAVgF;;ACvBlF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAIA;AACA;AACA;AACA;;AACe,MAAMU,0CAAN,SAAyDf,kBAAzD,CAA4E;AAE1F;AACD;AACA;AACA;AACA;EACCC,MAAM,CAAC/I,GAAD,EAAM;IACX,IAAI8J,cAAc,GAAG,KAArB,CAAA;IACA,IAAIC,eAAe,GAAG,KAAtB,CAAA;IACA,IAAIC,gBAAgB,GAAG,KAAvB,CAAA;AACA,IAAA,MAAMC,iBAAiB,GAAG,IAAIC,GAAJ,EAA1B,CAAA;AAEA,IAAA,OAAOlK,GAAG,CACRmJ,OADK,CACG,4DADH,EACiE,EADjE,CAAA,CAELA,OAFK,CAEG,mBAFH,EAEyBC,KAAD,IAAW;AACxC,MAAA,IAAIU,cAAJ,EAAoB;AACnB,QAAA,OAAO,EAAP,CAAA;AACA,OAAA;;AAEDA,MAAAA,cAAc,GAAG,IAAjB,CAAA;AACA,MAAA,OAAOV,KAAP,CAAA;AACA,KATK,EAULD,OAVK,CAUG,oBAVH,EAU0BC,KAAD,IAAW;AACzC,MAAA,IAAIW,eAAJ,EAAqB;AACpB,QAAA,OAAO,EAAP,CAAA;AACA,OAAA;;AAEDA,MAAAA,eAAe,GAAG,IAAlB,CAAA;AACA,MAAA,OAAOX,KAAP,CAAA;AACA,KAjBK,EAkBLD,OAlBK,CAkBG,qBAlBH,EAkB2BC,KAAD,IAAW;AAC1C,MAAA,IAAIY,gBAAJ,EAAsB;AACrB,QAAA,OAAO,EAAP,CAAA;AACA,OAAA;;AAEDA,MAAAA,gBAAgB,GAAG,IAAnB,CAAA;AACA,MAAA,OAAOZ,KAAP,CAAA;AACA,KAzBK,EA0BLD,OA1BK,CA0BG,oEA1BH,EA0B0EC,KAAD,IAAW;MACzF,MAAMe,WAAW,GAAGf,KAAK,CAACA,KAAN,CAAY,eAAZ,CAApB,CADyF;AAIzF;;MACA,IAAIe,WAAW,KAAK,IAApB,EAA0B;AACzB,QAAA,OAAO,EAAP,CAAA;AACA,OAAA;;AAED,MAAA,MAAMljB,IAAI,GAAGnF,EAAE,CAACqoB,WAAW,CAAC,CAAD,CAAX,CAAe7pB,KAAf,CAAqB,CAArB,CAAD,CAAf,CAAA;;AACA,MAAA,IAAI2pB,iBAAiB,CAAC7c,GAAlB,CAAsBnG,IAAtB,CAAJ,EAAiC;AAChC;AACA,QAAA,OAAO,EAAP,CAAA;AACA,OAAA;;MAEDgjB,iBAAiB,CAACG,GAAlB,CAAsBnjB,IAAtB,CAAA,CAAA;AACA,MAAA,OAAOmiB,KAAP,CAAA;AACA,KA3CK,CAAP,CAAA;AA4CA,GAAA;;AAzDyF;;AC5B3F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;;AACe,MAAMiB,mCAAN,SAAkDvB,kBAAlD,CAAqE;AAEnF;AACD;AACA;AACA;AACA;EACCC,MAAM,CAAC/I,GAAD,EAAM;AACX,IAAA,OAAOA,GAAG,CACRmJ,OADK,CACG,mCADH,EACwC,MADxC,CAAP,CAAA;AAEA,GAAA;;AAVkF;;AC3BpF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AASA;AACA;AACA;;AACO,UAAWmB,cAAX,GAA4B;AAClC,EAAA,MAAMpB,gCAAN,CAAA;AACA,EAAA,MAAMK,iDAAN,CAAA;AACA,EAAA,MAAME,sCAAN,CAAA;AACA,EAAA,MAAME,+BAAN,CAAA;AACA,EAAA,MAAMC,iCAAN,CAAA;AACA,EAAA,MAAMC,0CAAN,CAAA;AACA,EAAA,MAAMQ,mCAAN,CAAA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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"}